
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module Double_rounding</title>
<meta name="description" content="Documentation of Coq module Double_rounding" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module Double_rounding</h1>
<div class="coq">
<br/>
<h1> Conditions for innocuous double rounding. </h1>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.micromega.Psatz.html">Psatz</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.flocq.Core.Raux.html">Raux</a></span> <span class="id"><a href="compcert.flocq.Core.Defs.html">Defs</a></span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html">Generic_fmt</a></span> <span class="id"><a href="compcert.flocq.Calc.Operations.html">Operations</a></span> <span class="id"><a href="compcert.flocq.Core.Ulp.html">Ulp</a></span> <span class="id"><a href="compcert.flocq.Core.FLX.html">FLX</a></span> <span class="id"><a href="compcert.flocq.Core.FLT.html">FLT</a></span> <span class="id"><a href="compcert.flocq.Core.FTZ.html">FTZ</a></span>.<br/>
<br/>
<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">R_scope</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Double_round">Double_round</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Double_round.beta">beta</a></span> : <span class="id"><a href="compcert.flocq.Core.Zaux.html#radix">radix</a></span>.<br/>
<span class="kwd">Notation</span> <span class="id"><a name="bpow">bpow</a></span> <span class="id">e</span> := (<span class="id"><a href="compcert.flocq.Core.Raux.html#bpow">bpow</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">e</span>).<br/>
<span class="kwd">Notation</span> <span class="id"><a name="mag">mag</a></span> <span class="id">x</span> := (<span class="id"><a href="compcert.flocq.Core.Raux.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">x</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_round_eq">round_round_eq</a></span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">x</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Znearest">Znearest</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span>) (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Znearest">Znearest</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>)<br/>
&nbsp;&nbsp;= <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Znearest">Znearest</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>.<br/>
<br/>
<div class="doc">A little tactic to simplify terms of the form <span class="bracket"><span class="id">bpow</span> <span class="id">a</span> * <span class="id">bpow</span> <span class="id">b</span></span>. </div>
<span class="kwd">Ltac</span> <span class="id">bpow_simplify</span> :=<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id">context</span> [(<span class="id"><a href="compcert.flocq.Core.Raux.html#bpow">Raux.bpow</a></span> <span class="id">_</span> <span class="id">_</span> * <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow">Raux.bpow</a></span> <span class="id">_</span> <span class="id">_</span>)] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_plus">bpow_plus</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id">context</span> [(?<span class="id">X1</span> * <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow">Raux.bpow</a></span> <span class="id">_</span> <span class="id">_</span> * <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow">Raux.bpow</a></span> <span class="id">_</span> <span class="id">_</span>)] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span> <span class="id">X1</span>); <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_plus">bpow_plus</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id">context</span> [(?<span class="id">X1</span> * (?<span class="id">X2</span> * <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow">Raux.bpow</a></span> <span class="id">_</span> <span class="id">_</span>) * <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow">Raux.bpow</a></span> <span class="id">_</span> <span class="id">_</span>)] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span> <span class="id">X1</span> <span class="id">X2</span>); <span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span> (<span class="id">X1</span> * <span class="id">X2</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_plus">bpow_plus</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>;<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id">context</span> [(<span class="id"><a href="compcert.flocq.Core.Raux.html#bpow">Raux.bpow</a></span> <span class="id">_</span> ?<span class="id">X</span>)] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">progress</span> <span class="id">ring_simplify</span> <span class="id">X</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>;<br/>
&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#bpow">Raux.bpow</a></span> <span class="id">_</span> 0) <span class="kwd">with</span> 1;<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id">context</span> [(<span class="id">_</span> * 1)] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_1_r">Rmult_1_r</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="midp">midp</a></span> (<span class="id">fexp</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) (<span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#R">R</a></span>) :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> + / 2 * <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">midp</span>' (<span class="id">fexp</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) (<span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#R">R</a></span>) :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zceil">Zceil</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> - / 2 * <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">round_round_lt_mid_further_place</span>' :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">choice1</span> <span class="id">choice2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>),<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) - 1)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) - / 2 * <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#midp">midp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> - / 2 * <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6244')">Proof.</div>
<div class="proofscript" id="proof6244">
<span class="tactic">intros</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Vfexp1</span> <span class="id">Vfexp2</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">x</span> <span class="id">Px</span> <span class="id">Hf2f1</span> <span class="id">Hx1</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span>.<br/>
<span class="tactic">set</span> (<span class="id">x</span>' := <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> <span class="id">x</span>).<br/>
<span class="tactic">intro</span> <span class="id">Hx2</span>'.<br/>
<span class="tactic">assert</span> (<span class="id">Hx2</span> : <span class="id">x</span> - <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt; / 2 * (<span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id">x</span> - <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span> <span class="id">x</span>)).<br/>
{ <span class="id">now</span> <span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_reg_r">Rplus_lt_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> <span class="id">x</span>)); <span class="id">ring_simplify</span>. }<br/>
<span class="tactic">set</span> (<span class="id">x</span>'' := <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Znearest">Znearest</a></span> <span class="id">choice2</span>) <span class="id">x</span>).<br/>
<span class="tactic">assert</span> (<span class="id">Hr1</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id">x</span>'' - <span class="id">x</span>) &lt;= / 2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp2</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (/ 2 * <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span> <span class="id">x</span>).<br/>
<span class="id">now</span> <span class="tactic">unfold</span> <span class="id">x</span>''; <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Ulp.html#error_le_half_ulp">error_le_half_ulp</a></span>...<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp_neq_0">ulp_neq_0</a></span>;[<span class="id">now</span> <span class="id">right</span>|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>].<br/>
<span class="tactic">assert</span> (<span class="id">Pxx</span>' : 0 &lt;= <span class="id">x</span> - <span class="id">x</span>').<br/>
{ <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rle_0_minus">Rle_0_minus</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_DN_pt">round_DN_pt</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">exact</span> <span class="id">Vfexp1</span>. }<br/>
<span class="tactic">rewrite</span> 2!<span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp_neq_0">ulp_neq_0</a></span> <span class="kwd">in</span> <span class="id">Hx2</span>; <span class="tactic">try</span> (<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>; <span class="tactic">assumption</span>).<br/>
<span class="tactic">assert</span> (<span class="id">Hr2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id">x</span>'' - <span class="id">x</span>') &lt; / 2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))).<br/>
{ <span class="tactic">replace</span> (<span class="id">x</span>'' - <span class="id">x</span>') <span class="kwd">with</span> (<span class="id">x</span>'' - <span class="id">x</span> + (<span class="id">x</span> - <span class="id">x</span>')) <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_triang">Rabs_triang</a></span> <span class="id">_</span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (/ 2 * <span class="id">_</span>) <span class="kwd">with</span> (/ 2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp2</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ (/ 2 * (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp2</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))))) <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_lt_compat">Rplus_le_lt_compat</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">exact</span> <span class="id">Hr1</span>.<br/>
&nbsp;&nbsp;- <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span>; [|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_ge">Rle_ge</a></span>]; <span class="tactic">apply</span> <span class="id">Hx2</span>. }<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_dec">Req_dec</a></span> <span class="id">x</span>'' 0) <span class="kwd">as</span> [<span class="id">Zx</span>''|<span class="id">Nzx</span>''].<br/>
- <span class="comment">(*&nbsp;x''&nbsp;=&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Zx</span>'' <span class="kwd">in</span> <span class="id">Hr1</span> |- *.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_0">round_0</a></span>; [|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_rnd_N">valid_rnd_N</a></span>].<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span>, <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Znearest_imp">Znearest_imp</a></span> <span class="id">_</span> <span class="id">_</span> 0); [<span class="id">now</span> <span class="tactic">simpl</span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_l">Rmult_0_l</a></span>|].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_r">Rmult_lt_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)))); [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> <span class="id">_</span>))) <span class="tactic">at</span> 1;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_ge">Rle_ge</a></span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_ge_0">bpow_ge_0</a></span>].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_mult">Rabs_mult</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rmult_minus_distr_r">Rmult_minus_distr_r</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_l">Rmult_0_l</a></span>.<br/>
&nbsp;&nbsp;<span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_minus_sym">Rabs_minus_sym</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hr1</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_lt_compat_l">Rmult_lt_compat_l</a></span>; [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_lt">bpow_lt</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
- <span class="comment">(*&nbsp;x''&nbsp;&lt;&gt;&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Lx</span>'' : <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>'' = <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> :&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zle_antisym">Zle_antisym</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#mag_le_bpow">mag_le_bpow</a></span>; [<span class="tactic">exact</span> <span class="id">Nzx</span>''|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> <span class="id">x</span>'' <span class="kwd">with</span> (<span class="id">x</span>'' - <span class="id">x</span> + <span class="id">x</span>) <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_triang">Rabs_triang</a></span> <span class="id">_</span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> <span class="id">_</span>) <span class="kwd">with</span> (/ 2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp2</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- / 2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp2</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)))) <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_lt_compat">Rplus_le_lt_compat</a></span>; [<span class="tactic">exact</span> <span class="id">Hr1</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp_neq_0">ulp_neq_0</a></span> <span class="kwd">in</span> <span class="id">Hx1</span>;[<span class="id">idtac</span>| <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span>; [|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_ge">Rle_ge</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id">x</span>'' <span class="kwd">in</span> <span class="id">Nzx</span>'' |- *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#mag_round_ge">mag_round_ge</a></span>; [|<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_rnd_N">valid_rnd_N</a></span>|]. }<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span>, <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Lx</span>''.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Znearest_imp">Znearest_imp</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id">x</span>))).<br/>
&nbsp;&nbsp;+ <span class="tactic">rewrite</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Znearest_imp">Znearest_imp</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id">x</span>)));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="tactic">reflexivity</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_r">Rmult_lt_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)))); [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> <span class="id">_</span>))) <span class="tactic">at</span> 1;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_ge">Rle_ge</a></span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_ge_0">bpow_ge_0</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_mult">Rabs_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rmult_minus_distr_r">Rmult_minus_distr_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fold</span> <span class="id">x</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span>; [|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_ge">Rle_ge</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hx2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_l">Rmult_le_compat_l</a></span>; [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_ge_0">bpow_ge_0</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> (<span class="id">fexp2</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_r">Rmult_lt_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)))); [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> <span class="id">_</span>))) <span class="tactic">at</span> 1;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_ge">Rle_ge</a></span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_ge_0">bpow_ge_0</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_mult">Rabs_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rmult_minus_distr_r">Rmult_minus_distr_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fold</span> <span class="id">x</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">bpow_simplify</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_lt_mid_further_place">round_round_lt_mid_further_place</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">choice1</span> <span class="id">choice2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>),<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) - 1)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#midp">midp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> - / 2 * <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6245')">Proof.</div>
<div class="proofscript" id="proof6245">
<span class="tactic">intros</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Vfexp1</span> <span class="id">Vfexp2</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">x</span> <span class="id">Px</span> <span class="id">Hf2f1</span> <span class="id">Hf1</span>.<br/>
<span class="tactic">intro</span> <span class="id">Hx2</span>'.<br/>
<span class="tactic">assert</span> (<span class="id">Hx2</span> : <span class="id">x</span> - <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt; / 2 * (<span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id">x</span> - <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span> <span class="id">x</span>)).<br/>
{ <span class="id">now</span> <span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_reg_r">Rplus_lt_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> <span class="id">x</span>)); <span class="id">ring_simplify</span>. }<br/>
<span class="id">revert</span> <span class="id">Hx2</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span>.<br/>
<span class="tactic">set</span> (<span class="id">x</span>' := <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> <span class="id">x</span>).<br/>
<span class="tactic">intro</span> <span class="id">Hx2</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Pxx</span>' : 0 &lt;= <span class="id">x</span> - <span class="id">x</span>').<br/>
{ <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rle_0_minus">Rle_0_minus</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_DN_pt">round_DN_pt</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">exact</span> <span class="id">Vfexp1</span>. }<br/>
<span class="tactic">assert</span> (<span class="id">x</span> &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) - / 2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp2</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)));<br/>
&nbsp;&nbsp;[|<span class="tactic">apply</span> <span class="id">round_round_lt_mid_further_place</span>'; <span class="tactic">try</span> <span class="tactic">assumption</span>]...<br/>
2: <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp_neq_0">ulp_neq_0</a></span>;[<span class="tactic">assumption</span>|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>].<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_dec">Req_dec</a></span> <span class="id">x</span>' 0) <span class="kwd">as</span> [<span class="id">Zx</span>'|<span class="id">Nzx</span>'].<br/>
- <span class="comment">(*&nbsp;x'&nbsp;=&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Zx</span>' <span class="kwd">in</span> <span class="id">Hx2</span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rminus_0_r">Rminus_0_r</a></span> <span class="kwd">in</span> <span class="id">Hx2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hx2</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_minus_distr_l">Rmult_minus_distr_l</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> 2!<span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp_neq_0">ulp_neq_0</a></span>;[<span class="id">idtac</span>|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat_r">Rplus_le_compat_r</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_reg_r">Rmult_le_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))); [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_reg_l">Rmult_le_reg_l</a></span> <span class="kwd">with</span> (1 := <span class="id"><a href="http://coq.inria.fr/library/Coq.setoid_ring.RealField.html#Rlt_0_2">Rlt_0_2</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (2 * (/ 2 * <span class="id">_</span>)) <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)) <span class="tactic">by</span> <span class="id">field</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> 1; [|<span class="id">lra</span>].<br/>
&nbsp;&nbsp;<span class="id">change</span> 1 <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> 0); <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_le">bpow_le</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
- <span class="comment">(*&nbsp;x'&nbsp;&lt;&gt;&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Px</span>' : 0 &lt; <span class="id">x</span>').<br/>
&nbsp;&nbsp;{ <span class="tactic">assert</span> (0 &lt;= <span class="id">x</span>'); [|<span class="id">lra</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">x</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_reg_r">Rmult_le_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_l">Rmult_0_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span>, <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="tactic">simpl</span>; <span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#IZR_le">IZR_le</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor_lub">Zfloor_lub</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span> <span class="id">x</span>); [|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_ge">Rle_ge</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa_abs">scaled_mantissa_abs</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos">Rabs_pos</a></span>. }<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hx</span>' : <span class="id">x</span>' &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) - <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_reg_r">Rplus_le_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id">x</span>)); <span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp_DN">ulp_DN</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">change</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) <span class="kwd">with</span> <span class="id">x</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Ulp.html#id_p_ulp_le_bpow">id_p_ulp_le_bpow</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">exact</span> <span class="id">Px</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">change</span> <span class="id">x</span>' <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format_round">generic_format_round</a></span>; [|<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_rnd_DN">valid_rnd_DN</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_DN_pt">round_DN_pt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span> <span class="id">x</span>) <span class="tactic">at</span> 1; [|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_ge">Rle_ge</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_mag_gt">bpow_mag_gt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">exact</span> <span class="id">Vfexp1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>. }<br/>
&nbsp;&nbsp;<span class="id">fold</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span> <span class="id">x</span>); <span class="id">fold</span> (<span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (/ 2 * <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id">x</span> &lt;= <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span> (<span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>)) <span class="tactic">at</span> 2.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_r">Rmult_le_compat_r</a></span>; [|<span class="id">lra</span>].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp_ge_0">ulp_ge_0</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> 2!<span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp_neq_0">ulp_neq_0</a></span> <span class="kwd">in</span> <span class="id">Hx2</span>;[|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp_neq_0">ulp_neq_0</a></span> <span class="kwd">in</span> <span class="id">Hx</span>';[|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp_neq_0">ulp_neq_0</a></span> <span class="kwd">in</span> <span class="id">H</span>;[|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>].<br/>
&nbsp;&nbsp;<span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_lt_mid_same_place">round_round_lt_mid_same_place</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">choice1</span> <span class="id">choice2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>),<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) = <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>))%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#midp">midp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6246')">Proof.</div>
<div class="proofscript" id="proof6246">
<span class="tactic">intros</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Vfexp1</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">x</span> <span class="id">Px</span> <span class="id">Hf2f1</span>.<br/>
<span class="tactic">intro</span> <span class="id">Hx</span>'.<br/>
<span class="tactic">assert</span> (<span class="id">Hx</span> : <span class="id">x</span> - <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> <span class="id">x</span> &lt; / 2 * <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id">x</span>).<br/>
{ <span class="id">now</span> <span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_reg_r">Rplus_lt_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> <span class="id">x</span>)); <span class="id">ring_simplify</span>. }<br/>
<span class="id">revert</span> <span class="id">Hx</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span>.<br/>
<span class="tactic">set</span> (<span class="id">x</span>' := <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> <span class="id">x</span>).<br/>
<span class="tactic">intro</span> <span class="id">Hx</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Pxx</span>' : 0 &lt;= <span class="id">x</span> - <span class="id">x</span>').<br/>
{ <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rle_0_minus">Rle_0_minus</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_DN_pt">round_DN_pt</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">exact</span> <span class="id">Vfexp1</span>. }<br/>
<span class="tactic">assert</span> (<span class="id">H</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id">x</span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)) -<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> (<span class="id">x</span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))))) &lt; / 2).<br/>
{ <span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_r">Rmult_lt_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)))); [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="kwd">in</span> <span class="id">Hx</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> <span class="id">_</span>))) <span class="tactic">at</span> 1;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_ge">Rle_ge</a></span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_ge_0">bpow_ge_0</a></span>].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_mult">Rabs_mult</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rmult_minus_distr_r">Rmult_minus_distr_r</a></span>.<br/>
&nbsp;&nbsp;<span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rabs_lt">Rabs_lt</a></span>.<br/>
&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id">_</span> * <span class="id">_</span>) <span class="kwd">with</span> <span class="id">x</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> 0; [|<span class="tactic">exact</span> <span class="id">Pxx</span>'].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_0">Ropp_0</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_lt_contravar">Ropp_lt_contravar</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_r">Rmult_0_r</a></span> (/ 2)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_lt_compat_l">Rmult_lt_compat_l</a></span>; [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp_neq_0">ulp_neq_0</a></span> <span class="kwd">in</span> <span class="id">Hx</span>;<span class="tactic">try</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>; <span class="tactic">assumption</span>. }<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="tactic">at</span> 2.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="tactic">simpl</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">Hf2f1</span>.<br/>
<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Znearest_imp">Znearest_imp</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id">x</span>)) <span class="id">H</span>).<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_generic">round_generic</a></span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span>, <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Znearest_imp">Znearest_imp</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> (<span class="id">x</span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))))).<br/>
&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_rnd_N">valid_rnd_N</a></span>.<br/>
&nbsp;&nbsp;+ <span class="id">fold</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id">_</span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> <span class="id">_</span>) <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format_round">generic_format_round</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exact</span> <span class="id">Vfexp1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_rnd_DN">valid_rnd_DN</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_lt_mid">round_round_lt_mid</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">choice1</span> <span class="id">choice2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>),<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>))%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#midp">midp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;((<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) - 1)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#midp">midp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> - / 2 * <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6247')">Proof.</div>
<div class="proofscript" id="proof6247">
<span class="tactic">intros</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Vfexp1</span> <span class="id">Vfexp2</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">x</span> <span class="id">Px</span> <span class="id">Hf2f1</span> <span class="id">Hf1</span> <span class="id">Hx</span> <span class="id">Hx</span>'.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zle_or_lt">Zle_or_lt</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)) (<span class="id">fexp2</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))) <span class="kwd">as</span> [<span class="id">Hf2</span>'|<span class="id">Hf2</span>'].<br/>
- <span class="comment">(*&nbsp;fexp1&nbsp;(mag&nbsp;x)&nbsp;&lt;=&nbsp;fexp2&nbsp;(mag&nbsp;x)&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hf2</span>'' : (<span class="id">fexp2</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) = <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) :&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>)%<span class="id">Z</span>); [<span class="tactic">omega</span>|].<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_lt_mid_same_place">round_round_lt_mid_same_place</a></span>.<br/>
- <span class="comment">(*&nbsp;fexp2&nbsp;(mag&nbsp;x)&nbsp;&lt;&nbsp;fexp1&nbsp;(mag&nbsp;x)&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hf2</span>'' : (<span class="id">fexp2</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) &lt;= <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) - 1)%<span class="id">Z</span>); [<span class="tactic">omega</span>|].<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">Hx</span>' <span class="id">Hf2</span>''); <span class="tactic">intro</span> <span class="id">Hx</span>''.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_lt_mid_further_place">round_round_lt_mid_further_place</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">round_round_gt_mid_further_place</span>' :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">choice1</span> <span class="id">choice2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>),<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) - 1)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Znearest">Znearest</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">midp</span>' <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> + / 2 * <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6248')">Proof.</div>
<div class="proofscript" id="proof6248">
<span class="tactic">intros</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Vfexp1</span> <span class="id">Vfexp2</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">x</span> <span class="id">Px</span> <span class="id">Hf2f1</span>.<br/>
<span class="tactic">intros</span> <span class="id">Hx1</span> <span class="id">Hx2</span>'.<br/>
<span class="tactic">assert</span> (<span class="id">Hx2</span> : <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zceil">Zceil</a></span> <span class="id">x</span> - <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt; / 2 * (<span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id">x</span> - <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span> <span class="id">x</span>)).<br/>
{ <span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_reg_r">Rplus_lt_reg_r</a></span> (- / 2 * <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id">x</span> + <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ / 2 * <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span> <span class="id">x</span>)); <span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">unfold</span> <span class="id">midp</span>' <span class="kwd">in</span> <span class="id">Hx2</span>'. }<br/>
<span class="id">revert</span> <span class="id">Hx1</span> <span class="id">Hx2</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span>.<br/>
<span class="tactic">set</span> (<span class="id">x</span>' := <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zceil">Zceil</a></span> <span class="id">x</span>).<br/>
<span class="tactic">set</span> (<span class="id">x</span>'' := <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Znearest">Znearest</a></span> <span class="id">choice2</span>) <span class="id">x</span>).<br/>
<span class="tactic">intros</span> <span class="id">Hx1</span> <span class="id">Hx2</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Hr1</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id">x</span>'' - <span class="id">x</span>) &lt;= / 2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp2</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (/2* <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">unfold</span> <span class="id">x</span>''; <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Ulp.html#error_le_half_ulp">error_le_half_ulp</a></span>...<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp_neq_0">ulp_neq_0</a></span>;[<span class="id">now</span> <span class="id">right</span>|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>].<br/>
<span class="tactic">assert</span> (<span class="id">Px</span>'<span class="id">x</span> : 0 &lt;= <span class="id">x</span>' - <span class="id">x</span>).<br/>
{ <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rle_0_minus">Rle_0_minus</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_UP_pt">round_UP_pt</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">exact</span> <span class="id">Vfexp1</span>. }<br/>
<span class="tactic">assert</span> (<span class="id">Hr2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id">x</span>'' - <span class="id">x</span>') &lt; / 2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))).<br/>
{ <span class="tactic">replace</span> (<span class="id">x</span>'' - <span class="id">x</span>') <span class="kwd">with</span> (<span class="id">x</span>'' - <span class="id">x</span> + (<span class="id">x</span> - <span class="id">x</span>')) <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_triang">Rabs_triang</a></span> <span class="id">_</span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (/ 2 * <span class="id">_</span>) <span class="kwd">with</span> (/ 2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp2</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ (/ 2 * (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp2</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))))) <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_lt_compat">Rplus_le_lt_compat</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">exact</span> <span class="id">Hr1</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_minus_sym">Rabs_minus_sym</a></span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> 2!<span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp_neq_0">ulp_neq_0</a></span> <span class="kwd">in</span> <span class="id">Hx2</span>; <span class="tactic">try</span> (<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>; <span class="tactic">assumption</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span>; [|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_ge">Rle_ge</a></span>]; <span class="tactic">apply</span> <span class="id">Hx2</span>. }<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_dec">Req_dec</a></span> <span class="id">x</span>'' 0) <span class="kwd">as</span> [<span class="id">Zx</span>''|<span class="id">Nzx</span>''].<br/>
- <span class="comment">(*&nbsp;x''&nbsp;=&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Zx</span>'' <span class="kwd">in</span> <span class="id">Hr1</span> |- *.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_0">round_0</a></span>; [|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_rnd_N">valid_rnd_N</a></span>].<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span>, <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Znearest_imp">Znearest_imp</a></span> <span class="id">_</span> <span class="id">_</span> 0); [<span class="id">now</span> <span class="tactic">simpl</span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_l">Rmult_0_l</a></span>|].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_r">Rmult_lt_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)))); [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> <span class="id">_</span>))) <span class="tactic">at</span> 1;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_ge">Rle_ge</a></span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_ge_0">bpow_ge_0</a></span>].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_mult">Rabs_mult</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rmult_minus_distr_r">Rmult_minus_distr_r</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_l">Rmult_0_l</a></span>.<br/>
&nbsp;&nbsp;<span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_minus_sym">Rabs_minus_sym</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hr1</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_lt_compat_l">Rmult_lt_compat_l</a></span>; [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_lt">bpow_lt</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
- <span class="comment">(*&nbsp;x''&nbsp;&lt;&gt;&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Lx</span>'' : <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>'' = <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> :&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zle_antisym">Zle_antisym</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#mag_le_bpow">mag_le_bpow</a></span>; [<span class="tactic">exact</span> <span class="id">Nzx</span>''|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span>; [<span class="tactic">exact</span> <span class="id">Hx1</span>|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_ge">Rle_ge</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_ge_generic">round_ge_generic</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">exact</span> <span class="id">Vfexp2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_rnd_N">valid_rnd_N</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format_0">generic_format_0</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id">x</span>'' <span class="kwd">in</span> <span class="id">Nzx</span>'' |- *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#mag_round_ge">mag_round_ge</a></span>; [|<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_rnd_N">valid_rnd_N</a></span>|]. }<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span>, <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Lx</span>''.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Znearest_imp">Znearest_imp</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Zceil">Zceil</a></span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id">x</span>))).<br/>
&nbsp;&nbsp;+ <span class="tactic">rewrite</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Znearest_imp">Znearest_imp</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Zceil">Zceil</a></span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id">x</span>)));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="tactic">reflexivity</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_r">Rmult_lt_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)))); [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> <span class="id">_</span>))) <span class="tactic">at</span> 1;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_ge">Rle_ge</a></span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_ge_0">bpow_ge_0</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_mult">Rabs_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rmult_minus_distr_r">Rmult_minus_distr_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fold</span> <span class="id">x</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_minus_sym">Rabs_minus_sym</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span>; [|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_ge">Rle_ge</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hx2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_l">Rmult_le_compat_l</a></span>; [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_ge_0">bpow_ge_0</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> (<span class="id">fexp2</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> 2!<span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp_neq_0">ulp_neq_0</a></span>; <span class="tactic">try</span> (<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>; <span class="tactic">assumption</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_r">Rmult_lt_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)))); [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> <span class="id">_</span>))) <span class="tactic">at</span> 1;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_ge">Rle_ge</a></span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_ge_0">bpow_ge_0</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_mult">Rabs_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rmult_minus_distr_r">Rmult_minus_distr_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fold</span> <span class="id">x</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">bpow_simplify</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_gt_mid_further_place">round_round_gt_mid_further_place</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">choice1</span> <span class="id">choice2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>),<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) - 1)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">midp</span>' <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> + / 2 * <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6249')">Proof.</div>
<div class="proofscript" id="proof6249">
<span class="tactic">intros</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Vfexp1</span> <span class="id">Vfexp2</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">x</span> <span class="id">Px</span> <span class="id">Hf2f1</span> <span class="id">Hf1</span> <span class="id">Hx2</span>'.<br/>
<span class="tactic">assert</span> (<span class="id">Hx2</span> : <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zceil">Zceil</a></span> <span class="id">x</span> - <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt; / 2 * (<span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id">x</span> - <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span> <span class="id">x</span>)).<br/>
{ <span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_reg_r">Rplus_lt_reg_r</a></span> (- / 2 * <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id">x</span> + <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ / 2 * <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span> <span class="id">x</span>)); <span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">unfold</span> <span class="id">midp</span>' <span class="kwd">in</span> <span class="id">Hx2</span>'. }<br/>
<span class="id">revert</span> <span class="id">Hx2</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span>.<br/>
<span class="tactic">set</span> (<span class="id">x</span>' := <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> <span class="id">x</span>).<br/>
<span class="tactic">intro</span> <span class="id">Hx2</span>.<br/>
<span class="tactic">set</span> (<span class="id">x</span>'' := <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Znearest">Znearest</a></span> <span class="id">choice2</span>) <span class="id">x</span>).<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_or_le">Rlt_or_le</a></span> <span class="id">x</span>'' (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))) <span class="kwd">as</span> [<span class="id">Hx</span>''|<span class="id">Hx</span>''];<br/>
&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id">round_round_gt_mid_further_place</span>'|].<br/>
<span class="comment">(*&nbsp;bpow&nbsp;(mag&nbsp;x)&nbsp;&lt;=&nbsp;x''&nbsp;*)</span><br/>
<span class="tactic">assert</span> (<span class="id">Hx</span>''<span class="id">pow</span> : <span class="id">x</span>'' = <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)).<br/>
{ <span class="tactic">assert</span> (<span class="id">H</span>'<span class="id">x</span>'' : <span class="id">x</span>'' &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) + / 2 * <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (<span class="id">x</span> + / 2 * <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_reg_r">Rplus_le_reg_r</a></span> (- <span class="id">x</span>)); <span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rabs_le_inv">Rabs_le_inv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Ulp.html#error_le_half_ulp">error_le_half_ulp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exact</span> <span class="id">Vfexp2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_compat_r">Rplus_lt_compat_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span> <span class="tactic">at</span> 1; [|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_ge">Rle_ge</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_mag_gt">bpow_mag_gt</a></span>. }<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_antisym">Rle_antisym</a></span>; [|<span class="tactic">exact</span> <span class="id">Hx</span>''].<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">x</span>'', <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span>, <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_reg_r">Rmult_le_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id">fexp2</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)))); [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;<span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="compcert.flocq.Core.Raux.html#IZR_Zpower">IZR_Zpower</a></span> <span class="id">_</span> (<span class="id">_</span> - <span class="id">_</span>)); [|<span class="tactic">omega</span>].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#IZR_le">IZR_le</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zlt_succ_le">Zlt_succ_le</a></span>; <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.succ">Z.succ</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#lt_IZR">lt_IZR</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#plus_IZR">plus_IZR</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#IZR_Zpower">IZR_Zpower</a></span>; [|<span class="tactic">omega</span>].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_r">Rmult_lt_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp2</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)))); [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_plus_distr_r">Rmult_plus_distr_r</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span>.<br/>
&nbsp;&nbsp;<span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>'<span class="id">x</span>'').<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat_l">Rplus_le_compat_l</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#bpow">Raux.bpow</a></span> <span class="id">_</span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp_neq_0">ulp_neq_0</a></span>;[<span class="id">idtac</span>|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_r">Rmult_le_compat_r</a></span>; [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_ge_0">bpow_ge_0</a></span>|].<br/>
&nbsp;&nbsp;<span class="id">lra</span>. }<br/>
<span class="tactic">assert</span> (<span class="id">Hr</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id">x</span> - <span class="id">x</span>'') &lt; / 2 * <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id">x</span>).<br/>
{ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (/ 2 * <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_minus_sym">Rabs_minus_sym</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Ulp.html#error_le_half_ulp">error_le_half_ulp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exact</span> <span class="id">Vfexp2</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_lt_compat_l">Rmult_lt_compat_l</a></span>; [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> 2!<span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp_neq_0">ulp_neq_0</a></span>; <span class="tactic">try</span> <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_lt">bpow_lt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>. }<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span>, <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="tactic">simpl</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Hf</span> : (0 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> - <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>''))%<span class="id">Z</span>).<br/>
{ <span class="tactic">rewrite</span> <span class="id">Hx</span>''<span class="id">pow</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#mag_bpow">mag_bpow</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> + 1) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)%<span class="id">Z</span>; [|<span class="tactic">omega</span>].<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zle_or_lt">Zle_or_lt</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))) <span class="kwd">as</span> [<span class="id">Hle</span>|<span class="id">Hlt</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="id">now</span> <span class="tactic">apply</span> <span class="id">Vfexp1</span>].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">H</span> : (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> = <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) :&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>)%<span class="id">Z</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zle_antisym">Zle_antisym</a></span>|].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">Vfexp1</span>. }<br/>
<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Znearest_imp">Znearest_imp</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> ^ (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> - <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>'')))%<span class="id">Z</span>).<br/>
- <span class="tactic">rewrite</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Znearest_imp">Znearest_imp</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> ^ (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> - <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)))%<span class="id">Z</span>).<br/>
&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#IZR_Zpower">IZR_Zpower</a></span>; [|<span class="tactic">exact</span> <span class="id">Hf</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#IZR_Zpower">IZR_Zpower</a></span>; [|<span class="tactic">omega</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#IZR_Zpower">IZR_Zpower</a></span>; [|<span class="tactic">omega</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_r">Rmult_lt_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)))); [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> <span class="id">_</span>))) <span class="tactic">at</span> 1;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_ge">Rle_ge</a></span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_ge_0">bpow_ge_0</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_mult">Rabs_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rmult_minus_distr_r">Rmult_minus_distr_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp_neq_0">ulp_neq_0</a></span> <span class="kwd">in</span> <span class="id">Hr</span>;[<span class="id">idtac</span>|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Hx</span>''<span class="id">pow</span>; <span class="tactic">exact</span> <span class="id">Hr</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#IZR_Zpower">IZR_Zpower</a></span>; [|<span class="tactic">exact</span> <span class="id">Hf</span>].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_r">Rmult_lt_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>'')))); [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> <span class="id">_</span>))) <span class="tactic">at</span> 1;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_ge">Rle_ge</a></span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_ge_0">bpow_ge_0</a></span>].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_mult">Rabs_mult</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rmult_minus_distr_r">Rmult_minus_distr_r</a></span>.<br/>
&nbsp;&nbsp;<span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rminus_diag_eq">Rminus_diag_eq</a></span>; [|<span class="tactic">exact</span> <span class="id">Hx</span>''<span class="id">pow</span>].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_R0">Rabs_R0</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_r">Rmult_0_r</a></span> (/ 2)).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_lt_compat_l">Rmult_lt_compat_l</a></span>; [<span class="id">lra</span>|<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>].<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_gt_mid_same_place">round_round_gt_mid_same_place</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">choice1</span> <span class="id">choice2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>),<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) = <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>))%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">midp</span>' <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6250')">Proof.</div>
<div class="proofscript" id="proof6250">
<span class="tactic">intros</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Vfexp1</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">x</span> <span class="id">Px</span> <span class="id">Hf2f1</span> <span class="id">Hx</span>'.<br/>
<span class="tactic">assert</span> (<span class="id">Hx</span> : <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zceil">Zceil</a></span> <span class="id">x</span> - <span class="id">x</span> &lt; / 2 * <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id">x</span>).<br/>
{ <span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_reg_r">Rplus_lt_reg_r</a></span> (- / 2 * <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id">x</span> + <span class="id">x</span>)); <span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">unfold</span> <span class="id">midp</span>' <span class="kwd">in</span> <span class="id">Hx</span>'. }<br/>
<span class="tactic">assert</span> (<span class="id">H</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Zceil">Zceil</a></span> (<span class="id">x</span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">x</span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))) &lt; / 2).<br/>
{ <span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_r">Rmult_lt_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)))); [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="kwd">in</span> <span class="id">Hx</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> <span class="id">_</span>))) <span class="tactic">at</span> 1;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_ge">Rle_ge</a></span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_ge_0">bpow_ge_0</a></span>].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_mult">Rabs_mult</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rmult_minus_distr_r">Rmult_minus_distr_r</a></span>.<br/>
&nbsp;&nbsp;<span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rabs_lt">Rabs_lt</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> 0.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_0">Ropp_0</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_lt_contravar">Ropp_lt_contravar</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_r">Rmult_0_r</a></span> (/ 2)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_lt_compat_l">Rmult_lt_compat_l</a></span>; [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rle_0_minus">Rle_0_minus</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_UP_pt">round_UP_pt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exact</span> <span class="id">Vfexp1</span>.<br/>
&nbsp;&nbsp;-  <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp_neq_0">ulp_neq_0</a></span> <span class="kwd">in</span> <span class="id">Hx</span>;[<span class="tactic">exact</span> <span class="id">Hx</span>|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>]. }<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="tactic">at</span> 2.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="tactic">simpl</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">Hf2f1</span>.<br/>
<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Znearest_imp">Znearest_imp</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Zceil">Zceil</a></span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id">x</span>))).<br/>
- <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_generic">round_generic</a></span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span>, <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Znearest_imp">Znearest_imp</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Zceil">Zceil</a></span> (<span class="id">x</span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)))));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_minus_sym">Rabs_minus_sym</a></span>].<br/>
&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_rnd_N">valid_rnd_N</a></span>.<br/>
&nbsp;&nbsp;+ <span class="id">fold</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id">_</span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> <span class="id">_</span>) <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zceil">Zceil</a></span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format_round">generic_format_round</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exact</span> <span class="id">Vfexp1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_rnd_UP">valid_rnd_UP</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_minus_sym">Rabs_minus_sym</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_gt_mid">round_round_gt_mid</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">choice1</span> <span class="id">choice2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>),<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>))%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">midp</span>' <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;((<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) - 1)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id">midp</span>' <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> + / 2 * <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6251')">Proof.</div>
<div class="proofscript" id="proof6251">
<span class="tactic">intros</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Vfexp1</span> <span class="id">Vfexp2</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">x</span> <span class="id">Px</span> <span class="id">Hf2f1</span> <span class="id">Hf1</span> <span class="id">Hx</span> <span class="id">Hx</span>'.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zle_or_lt">Zle_or_lt</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)) (<span class="id">fexp2</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))) <span class="kwd">as</span> [<span class="id">Hf2</span>'|<span class="id">Hf2</span>'].<br/>
- <span class="comment">(*&nbsp;fexp1&nbsp;(mag&nbsp;x)&nbsp;&lt;=&nbsp;fexp2&nbsp;(mag&nbsp;x)&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hf2</span>'' : (<span class="id">fexp2</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) = <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) :&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>)%<span class="id">Z</span>); [<span class="tactic">omega</span>|].<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_gt_mid_same_place">round_round_gt_mid_same_place</a></span>.<br/>
- <span class="comment">(*&nbsp;fexp2&nbsp;(mag&nbsp;x)&nbsp;&lt;&nbsp;fexp1&nbsp;(mag&nbsp;x)&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hf2</span>'' : (<span class="id">fexp2</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) &lt;= <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) - 1)%<span class="id">Z</span>); [<span class="tactic">omega</span>|].<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">Hx</span>' <span class="id">Hf2</span>''); <span class="tactic">intro</span> <span class="id">Hx</span>''.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_gt_mid_further_place">round_round_gt_mid_further_place</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Double_round.Double_round_mult">Double_round_mult</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="mag_mult_disj">mag_mult_disj</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> &lt;&gt; 0 -&gt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> &lt;&gt; 0 -&gt;<br/>
&nbsp;&nbsp;((<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>) = (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> + <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> - 1)%<span class="id">Z</span> :&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>)<br/>
&nbsp;&nbsp;&nbsp;\/ (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>) = (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> + <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>)%<span class="id">Z</span> :&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6252')">Proof.</div>
<div class="proofscript" id="proof6252">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Zx</span> <span class="id">Zy</span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#mag_mult">mag_mult</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">x</span> <span class="id">y</span> <span class="id">Zx</span> <span class="id">Zy</span>).<br/>
<span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_round_mult_hyp">round_round_mult_hyp</a></span> <span class="id">fexp1</span> <span class="id">fexp2</span> :=<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">ex</span> <span class="id">ey</span>, (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> + <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span>) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> + <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span>)%<span class="id">Z</span>)<br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">ex</span> <span class="id">ey</span>, (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> + <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span> - 1) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> + <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span>)%<span class="id">Z</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_mult_aux">round_round_mult_aux</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_mult_hyp">round_round_mult_hyp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6253')">Proof.</div>
<div class="proofscript" id="proof6253">
<span class="tactic">intros</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Hfexp</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_dec">Req_dec</a></span> <span class="id">x</span> 0) <span class="kwd">as</span> [<span class="id">Zx</span>|<span class="id">Zx</span>].<br/>
- <span class="comment">(*&nbsp;x&nbsp;=&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Zx</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_l">Rmult_0_l</a></span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format_0">generic_format_0</a></span>.<br/>
- <span class="comment">(*&nbsp;x&nbsp;&lt;&gt;&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_dec">Req_dec</a></span> <span class="id">y</span> 0) <span class="kwd">as</span> [<span class="id">Zy</span>|<span class="id">Zy</span>].<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;y&nbsp;=&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Zy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_r">Rmult_0_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format_0">generic_format_0</a></span>.<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;y&nbsp;&lt;&gt;&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">mx</span> := <span class="id"><a href="compcert.flocq.Core.Raux.html#Ztrunc">Ztrunc</a></span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id">x</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">my</span> := <span class="id"><a href="compcert.flocq.Core.Raux.html#Ztrunc">Ztrunc</a></span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id">y</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">fxy</span> := <span class="id"><a href="compcert.flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> (<span class="id">mx</span> * <span class="id">my</span>) (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) + <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hxy</span> : <span class="id">x</span> * <span class="id">y</span> = <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span> <span class="id">fxy</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id">fxy</span>, <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_plus">bpow_plus</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mult_IZR">mult_IZR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Fx</span>, <span class="id">Fy</span> <span class="tactic">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">ring</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">generic_format_F2R</span>' <span class="kwd">with</span> (<span class="id">f</span> := <span class="id">fxy</span>); [<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">Hxy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>, <span class="id">fxy</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hfexp</span> <span class="kwd">as</span> (<span class="id">Hfexp1</span>, <span class="id">Hfexp2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag_mult_disj">mag_mult_disj</a></span> <span class="id">x</span> <span class="id">y</span> <span class="id">Zx</span> <span class="id">Zy</span>) <span class="kwd">as</span> [<span class="id">Lxy</span>|<span class="id">Lxy</span>]; <span class="tactic">rewrite</span> <span class="id">Lxy</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Double_round.Double_round_mult.rnd">rnd</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<span class="kwd">Context</span> { <span class="id">valid_rnd</span> : <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_rnd">Valid_rnd</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.rnd">rnd</a></span> }.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="round_round_mult">round_round_mult</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_mult_hyp">round_round_mult_hyp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.rnd">rnd</a></span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.rnd">rnd</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>))<br/>
&nbsp;&nbsp;= <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.rnd">rnd</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6254')">Proof.</div>
<div class="proofscript" id="proof6254">
<span class="tactic">intros</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Hfexp</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Hxy</span> : <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.rnd">rnd</a></span> (<span class="id">x</span> * <span class="id">y</span>) = <span class="id">x</span> * <span class="id">y</span>).<br/>
{ <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_generic">round_generic</a></span>; [<span class="tactic">assumption</span>|].<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_mult_aux">round_round_mult_aux</a></span> <span class="id">fexp1</span> <span class="id">fexp2</span>). }<br/>
<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">Hxy</span> <span class="tactic">at</span> 1.<br/>
Qed.</div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Double_round.Double_round_mult.Double_round_mult_FLX">Double_round_mult_FLX</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Double_round.Double_round_mult.Double_round_mult_FLX.prec">prec</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id">prec</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<br/>
<span class="kwd">Context</span> { <span class="id">prec_gt_0_</span> : <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.Double_round_mult_FLX.prec">prec</a></span> }.<br/>
<span class="kwd">Context</span> { <span class="id">prec_gt_0_</span>' : <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="id">prec</span>' }.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="round_round_mult_FLX">round_round_mult_FLX</a></span> :<br/>
&nbsp;&nbsp;(2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.Double_round_mult_FLX.prec">prec</a></span> &lt;= <span class="id">prec</span>')%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_format">FLX_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.Double_round_mult_FLX.prec">prec</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_format">FLX_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.Double_round_mult_FLX.prec">prec</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> (<span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp">FLX_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.Double_round_mult_FLX.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.rnd">rnd</a></span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> (<span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp">FLX_exp</a></span> <span class="id">prec</span>') <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.rnd">rnd</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>))<br/>
&nbsp;&nbsp;= <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> (<span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp">FLX_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.Double_round_mult_FLX.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.rnd">rnd</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6255')">Proof.</div>
<div class="proofscript" id="proof6255">
<span class="tactic">intros</span> <span class="id">Hprec</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_mult">round_round_mult</a></span>;<br/>
&nbsp;&nbsp;[|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#generic_format_FLX">generic_format_FLX</a></span>|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#generic_format_FLX">generic_format_FLX</a></span>].<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_mult_hyp">round_round_mult_hyp</a></span>; <span class="tactic">split</span>; <span class="tactic">intros</span> <span class="id">ex</span> <span class="id">ey</span>; <span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp">FLX_exp</a></span>;<br/>
<span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.Double_round_mult_FLX">Double_round_mult_FLX</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Double_round.Double_round_mult.Double_round_mult_FLT">Double_round_mult_FLT</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Double_round.Double_round_mult.Double_round_mult_FLT.emin">emin</a></span> <span class="id"><a name="Double_round.Double_round_mult.Double_round_mult_FLT.prec">prec</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id">emin</span>' <span class="id">prec</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<br/>
<span class="kwd">Context</span> { <span class="id">prec_gt_0_</span> : <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.Double_round_mult_FLT.prec">prec</a></span> }.<br/>
<span class="kwd">Context</span> { <span class="id">prec_gt_0_</span>' : <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="id">prec</span>' }.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="round_round_mult_FLT">round_round_mult_FLT</a></span> :<br/>
&nbsp;&nbsp;(<span class="id">emin</span>' &lt;= 2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.Double_round_mult_FLT.emin">emin</a></span>)%<span class="id">Z</span> -&gt; (2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.Double_round_mult_FLT.prec">prec</a></span> &lt;= <span class="id">prec</span>')%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_format">FLT_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.Double_round_mult_FLT.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.Double_round_mult_FLT.prec">prec</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_format">FLT_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.Double_round_mult_FLT.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.Double_round_mult_FLT.prec">prec</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> (<span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp">FLT_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.Double_round_mult_FLT.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.Double_round_mult_FLT.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.rnd">rnd</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> (<span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp">FLT_exp</a></span> <span class="id">emin</span>' <span class="id">prec</span>') <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.rnd">rnd</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>))<br/>
&nbsp;&nbsp;= <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> (<span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp">FLT_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.Double_round_mult_FLT.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.Double_round_mult_FLT.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.rnd">rnd</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6256')">Proof.</div>
<div class="proofscript" id="proof6256">
<span class="tactic">intros</span> <span class="id">Hemin</span> <span class="id">Hprec</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_mult">round_round_mult</a></span>;<br/>
&nbsp;&nbsp;[|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLT.html#generic_format_FLT">generic_format_FLT</a></span>|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLT.html#generic_format_FLT">generic_format_FLT</a></span>].<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_mult_hyp">round_round_mult_hyp</a></span>; <span class="tactic">split</span>; <span class="tactic">intros</span> <span class="id">ex</span> <span class="id">ey</span>;<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp">FLT_exp</a></span>;<br/>
<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ex</span> + <span class="id">ey</span> - <span class="id">prec</span>') <span class="id">emin</span>');<br/>
<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ex</span> + <span class="id">ey</span> - 1 - <span class="id">prec</span>') <span class="id">emin</span>');<br/>
<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ex</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.Double_round_mult_FLT.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.Double_round_mult_FLT.emin">emin</a></span>);<br/>
<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ey</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.Double_round_mult_FLT.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.Double_round_mult_FLT.emin">emin</a></span>);<br/>
<span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.Double_round_mult_FLT">Double_round_mult_FLT</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Double_round.Double_round_mult.Double_round_mult_FTZ">Double_round_mult_FTZ</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Double_round.Double_round_mult.Double_round_mult_FTZ.emin">emin</a></span> <span class="id"><a name="Double_round.Double_round_mult.Double_round_mult_FTZ.prec">prec</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id">emin</span>' <span class="id">prec</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<br/>
<span class="kwd">Context</span> { <span class="id">prec_gt_0_</span> : <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.Double_round_mult_FTZ.prec">prec</a></span> }.<br/>
<span class="kwd">Context</span> { <span class="id">prec_gt_0_</span>' : <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="id">prec</span>' }.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="round_round_mult_FTZ">round_round_mult_FTZ</a></span> :<br/>
&nbsp;&nbsp;(<span class="id">emin</span>' + <span class="id">prec</span>' &lt;= 2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.Double_round_mult_FTZ.emin">emin</a></span> + <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.Double_round_mult_FTZ.prec">prec</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;(2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.Double_round_mult_FTZ.prec">prec</a></span> &lt;= <span class="id">prec</span>')%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_format">FTZ_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.Double_round_mult_FTZ.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.Double_round_mult_FTZ.prec">prec</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_format">FTZ_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.Double_round_mult_FTZ.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.Double_round_mult_FTZ.prec">prec</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> (<span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp">FTZ_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.Double_round_mult_FTZ.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.Double_round_mult_FTZ.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.rnd">rnd</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> (<span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp">FTZ_exp</a></span> <span class="id">emin</span>' <span class="id">prec</span>') <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.rnd">rnd</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>))<br/>
&nbsp;&nbsp;= <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> (<span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp">FTZ_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.Double_round_mult_FTZ.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.Double_round_mult_FTZ.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.rnd">rnd</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6257')">Proof.</div>
<div class="proofscript" id="proof6257">
<span class="tactic">intros</span> <span class="id">Hemin</span> <span class="id">Hprec</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_mult">round_round_mult</a></span>;<br/>
&nbsp;&nbsp;[|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FTZ.html#generic_format_FTZ">generic_format_FTZ</a></span>|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FTZ.html#generic_format_FTZ">generic_format_FTZ</a></span>].<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_mult_hyp">round_round_mult_hyp</a></span>; <span class="tactic">split</span>; <span class="tactic">intros</span> <span class="id">ex</span> <span class="id">ey</span>;<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp">FTZ_exp</a></span>;<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="kwd">in</span> *;<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ex</span> + <span class="id">ey</span> - <span class="id">prec</span>') <span class="id">emin</span>');<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ex</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.Double_round_mult_FTZ.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.Double_round_mult_FTZ.emin">emin</a></span>);<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ey</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.Double_round_mult_FTZ.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.Double_round_mult_FTZ.emin">emin</a></span>);<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ex</span> + <span class="id">ey</span> - 1 - <span class="id">prec</span>') <span class="id">emin</span>');<br/>
<span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult.Double_round_mult_FTZ">Double_round_mult_FTZ</a></span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_mult">Double_round_mult</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Double_round.Double_round_plus">Double_round_plus</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="mag_plus_disj">mag_plus_disj</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;((<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> + <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>) = <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> :&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>)<br/>
&nbsp;&nbsp;&nbsp;\/ (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> + <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>) = (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> + 1)%<span class="id">Z</span> :&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6258')">Proof.</div>
<div class="proofscript" id="proof6258">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Py</span> <span class="id">Hxy</span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#mag_plus">mag_plus</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">x</span> <span class="id">y</span> <span class="id">Py</span> <span class="id">Hxy</span>).<br/>
<span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="mag_plus_separated">mag_plus_separated</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fexp</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>,<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt; 0 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>))%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> + <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>) = <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> :&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6259')">Proof.</div>
<div class="proofscript" id="proof6259">
<span class="tactic">intros</span> <span class="id">fexp</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Px</span> <span class="id">Nny</span> <span class="id">Fx</span> <span class="id">Hsep</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Ulp.html#mag_plus_eps">mag_plus_eps</a></span> <span class="kwd">with</span> (1 := <span class="id">Px</span>) (2 := <span class="id">Fx</span>).<br/>
<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#conj">conj</a></span> <span class="id">Nny</span>).<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos_eq">Rabs_pos_eq</a></span> <span class="kwd">with</span> (1 := <span class="id">Nny</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (1 := <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_mag_gt">bpow_mag_gt</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">_</span>).<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp_neq_0">ulp_neq_0</a></span> <span class="tactic">by</span> <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_le">bpow_le</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="mag_minus_disj">mag_minus_disj</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt; 0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> - 2)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;((<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>) = <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> :&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>)<br/>
&nbsp;&nbsp;&nbsp;\/ (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>) = (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> - 1)%<span class="id">Z</span> :&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6260')">Proof.</div>
<div class="proofscript" id="proof6260">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Px</span> <span class="id">Py</span> <span class="id">Hln</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Hxy</span> : <span class="id">y</span> &lt; <span class="id">x</span>); [<span class="id">now</span> <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#lt_mag">lt_mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span>); [ |<span class="tactic">omega</span>]|].<br/>
<span class="tactic">generalize</span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#mag_minus">mag_minus</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">x</span> <span class="id">y</span> <span class="id">Py</span> <span class="id">Hxy</span>); <span class="tactic">intro</span> <span class="id">Hln2</span>.<br/>
<span class="tactic">generalize</span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#mag_minus_lb">mag_minus_lb</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">x</span> <span class="id">y</span> <span class="id">Px</span> <span class="id">Py</span> <span class="id">Hln</span>); <span class="tactic">intro</span> <span class="id">Hln3</span>.<br/>
<span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="mag_minus_separated">mag_minus_separated</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fexp</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp">fexp</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt; 0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> - 1) &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt; (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>))%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>) = <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> :&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6261')">Proof.</div>
<div class="proofscript" id="proof6261">
<span class="tactic">intros</span> <span class="id">fexp</span> <span class="id">Vfexp</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Px</span> <span class="id">Py</span> <span class="id">Yltx</span> <span class="id">Xgtpow</span> <span class="id">Fx</span> <span class="id">Ly</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#mag_unique">mag_unique</a></span>.<br/>
<span class="tactic">split</span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rabs_ge">Rabs_ge</a></span>; <span class="id">right</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hy</span> : <span class="id">y</span> &lt; <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> - 1))).<br/>
&nbsp;&nbsp;{ <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp_bpow">ulp_bpow</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">_</span> + <span class="id">_</span>)%<span class="id">Z</span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span> <span class="id">y</span>); [|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_ge">Rle_ge</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_mag_gt">bpow_mag_gt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_le">bpow_le</a></span>. }<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_reg_r">Rplus_le_reg_r</a></span> <span class="id">y</span>); <span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> - 1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> - 1))).<br/>
&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat_l">Rplus_le_compat_l</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Ulp.html#succ_eq_pos">succ_eq_pos</a></span>;[<span class="id">idtac</span>|<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_ge_0">bpow_ge_0</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Ulp.html#succ_le_lt">succ_le_lt</a></span>; [<span class="tactic">apply</span> <span class="id">Vfexp</span>|<span class="id">idtac</span>|<span class="tactic">exact</span> <span class="id">Fx</span>|<span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format_bpow">generic_format_bpow</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> - 1)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">_</span> + <span class="id">_</span>)%<span class="id">Z</span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">fexp</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)%<span class="id">Z</span>; [|<span class="tactic">omega</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#mag_generic_gt">mag_generic_gt</a></span>; [|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>|].<br/>
- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rlt_trans">Rlt_trans</a></span> <span class="kwd">with</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_0_r">Rplus_0_r</a></span> <span class="id">x</span>) <span class="tactic">at</span> 2.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_lt_compat_l">Rplus_lt_compat_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_0">Ropp_0</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_lt_contravar">Ropp_lt_contravar</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rabs_lt_inv">Rabs_lt_inv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_mag_gt">bpow_mag_gt</a></span>.<br/>
&nbsp;&nbsp;+ <span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_round_plus_hyp">round_round_plus_hyp</a></span> <span class="id">fexp1</span> <span class="id">fexp2</span> :=<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">ex</span> <span class="id">ey</span>, (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> + 1) - 1 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span>)%<span class="id">Z</span> -&gt; (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span>)%<span class="id">Z</span>)<br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">ex</span> <span class="id">ey</span>, (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> - 1) + 1 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span>)%<span class="id">Z</span> -&gt; (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span>)%<span class="id">Z</span>)<br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">ex</span> <span class="id">ey</span>, (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> - 1 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span>)%<span class="id">Z</span> -&gt; (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span>)%<span class="id">Z</span>)<br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">ex</span> <span class="id">ey</span>, (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> - 1 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span>)%<span class="id">Z</span> -&gt; (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span>)%<span class="id">Z</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_plus_aux0_aux_aux">round_round_plus_aux0_aux_aux</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>),<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>))%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> + <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>))%<span class="id">Z</span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>))%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> + <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>))%<span class="id">Z</span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>))%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> + <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6262')">Proof.</div>
<div class="proofscript" id="proof6262">
<span class="tactic">intros</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Oxy</span> <span class="id">Hlnx</span> <span class="id">Hlny</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_dec">Req_dec</a></span> <span class="id">x</span> 0) <span class="kwd">as</span> [<span class="id">Zx</span>|<span class="id">Nzx</span>].<br/>
- <span class="comment">(*&nbsp;x&nbsp;=&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Zx</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_0_l">Rplus_0_l</a></span> <span class="kwd">in</span> <span class="id">Hlny</span> |- *.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_inclusion_mag">generic_inclusion_mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span>).<br/>
- <span class="comment">(*&nbsp;x&nbsp;&lt;&gt;&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_dec">Req_dec</a></span> <span class="id">y</span> 0) <span class="kwd">as</span> [<span class="id">Zy</span>|<span class="id">Nzy</span>].<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;y&nbsp;=&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Zy</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_0_r">Rplus_0_r</a></span> <span class="kwd">in</span> <span class="id">Hlnx</span> |- *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_inclusion_mag">generic_inclusion_mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span>).<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;y&nbsp;&lt;&gt;&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="tactic">at</span> -3, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>, <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">mx</span> := <span class="id"><a href="compcert.flocq.Core.Raux.html#Ztrunc">Ztrunc</a></span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id">x</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">my</span> := <span class="id"><a href="compcert.flocq.Core.Raux.html#Ztrunc">Ztrunc</a></span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id">y</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">fxy</span> := <span class="id"><a href="compcert.flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> (<span class="id">mx</span> + <span class="id">my</span> * (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> ^ (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hxy</span> : <span class="id">x</span> + <span class="id">y</span> = <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span> <span class="id">fxy</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id">fxy</span>, <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#plus_IZR">plus_IZR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_plus_distr_r">Rmult_plus_distr_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Fx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mult_IZR">mult_IZR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#IZR_Zpower">IZR_Zpower</a></span>; [|<span class="tactic">omega</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> &lt;- <span class="id">Fy</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">generic_format_F2R</span>' <span class="kwd">with</span> (<span class="id">f</span> := <span class="id">fxy</span>); [<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">Hxy</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>, <span class="id">fxy</span>; <span class="tactic">simpl</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_plus_aux0_aux">round_round_plus_aux0_aux</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>),<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> + <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>))%<span class="id">Z</span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>))%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> + <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>))%<span class="id">Z</span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>))%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> + <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6263')">Proof.</div>
<div class="proofscript" id="proof6263">
<span class="tactic">intros</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Hlnx</span> <span class="id">Hlny</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_gt_cases">Z.le_gt_cases</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)) (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>))) <span class="kwd">as</span> [<span class="id">Hle</span>|<span class="id">Hgt</span>].<br/>
- <span class="id">now</span> <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_aux0_aux_aux">round_round_plus_aux0_aux_aux</a></span> <span class="id">fexp1</span>).<br/>
- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_comm">Rplus_comm</a></span> <span class="kwd">in</span> <span class="id">Hlnx</span>, <span class="id">Hlny</span> |- *.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_aux0_aux_aux">round_round_plus_aux0_aux_aux</a></span> <span class="id">fexp1</span>); [<span class="tactic">omega</span>| | | |].<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_plus_aux0">round_round_plus_aux0</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>), <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_hyp">round_round_plus_hyp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;(0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>)%<span class="id">R</span> -&gt; (0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>)%<span class="id">R</span> -&gt; (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>)%<span class="id">R</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) - 1 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> + <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6264')">Proof.</div>
<div class="proofscript" id="proof6264">
<span class="tactic">intros</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Vfexp1</span> <span class="id">Hexp</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Px</span> <span class="id">Py</span> <span class="id">Hyx</span> <span class="id">Hln</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Nny</span> : (0 &lt;= <span class="id">y</span>)%<span class="id">R</span>); [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>|].<br/>
<span class="tactic">destruct</span> <span class="id">Hexp</span> <span class="kwd">as</span> (<span class="id">_</span>,(<span class="id">Hexp2</span>,(<span class="id">Hexp3</span>,<span class="id">Hexp4</span>))).<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_gt_cases">Z.le_gt_cases</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>) (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))) <span class="kwd">as</span> [<span class="id">Hle</span>|<span class="id">Hgt</span>].<br/>
- <span class="comment">(*&nbsp;mag&nbsp;y&nbsp;&lt;=&nbsp;fexp1&nbsp;(mag&nbsp;x)&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Lxy</span> : <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> + <span class="id">y</span>) = <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> :&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>);<br/>
&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag_plus_separated">mag_plus_separated</a></span> <span class="id">fexp1</span>)|].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_aux0_aux">round_round_plus_aux0_aux</a></span> <span class="id">fexp1</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[| |<span class="tactic">assumption</span>|<span class="tactic">assumption</span>]; <span class="tactic">rewrite</span> <span class="id">Lxy</span>.<br/>
&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">apply</span> <span class="id">Hexp4</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">apply</span> <span class="id">Hexp3</span>; <span class="tactic">omega</span>.<br/>
- <span class="comment">(*&nbsp;fexp1&nbsp;(mag&nbsp;x)&nbsp;&lt;&nbsp;mag&nbsp;y&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_aux0_aux">round_round_plus_aux0_aux</a></span> <span class="id">fexp1</span>); [| |<span class="tactic">assumption</span>|<span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag_plus_disj">mag_plus_disj</a></span> <span class="id">x</span> <span class="id">y</span> <span class="id">Py</span> <span class="id">Hyx</span>) <span class="kwd">as</span> [<span class="id">Lxy</span>|<span class="id">Lxy</span>]; <span class="tactic">rewrite</span> <span class="id">Lxy</span>.<br/>
&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">apply</span> <span class="id">Hexp4</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">Hexp2</span>; <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#mag_le">mag_le</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">y</span> <span class="id">x</span> <span class="id">Py</span>) <span class="kwd">in</span> <span class="id">Hyx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">_</span> - <span class="id">_</span>)%<span class="id">Z</span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag_plus_disj">mag_plus_disj</a></span> <span class="id">x</span> <span class="id">y</span> <span class="id">Py</span> <span class="id">Hyx</span>) <span class="kwd">as</span> [<span class="id">Lxy</span>|<span class="id">Lxy</span>]; <span class="tactic">rewrite</span> <span class="id">Lxy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">now</span> <span class="tactic">apply</span> <span class="id">Hexp3</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id">Hexp2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">_</span> - <span class="id">_</span>)%<span class="id">Z</span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_plus_aux1_aux">round_round_plus_aux1_aux</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">k</span>, (0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#k">k</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">fexp</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>),<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt; 0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#k">k</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> + <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>) = <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> :&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;0 &lt; (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> + <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>) - <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> + <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>) &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#k">k</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6265')">Proof.</div>
<div class="proofscript" id="proof6265">
<span class="tactic">assert</span> (<span class="id">Hbeta</span> : (2 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span>)%<span class="id">Z</span>).<br/>
{ <span class="tactic">destruct</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="kwd">as</span> (<span class="id">beta_val</span>,<span class="id">beta_prop</span>).<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zle_bool_imp_le">Zle_bool_imp_le</a></span>. }<br/>
<span class="tactic">intros</span> <span class="id">k</span> <span class="id">Hk</span> <span class="id">fexp</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Px</span> <span class="id">Py</span> <span class="id">Hln</span> <span class="id">Hlxy</span> <span class="id">Fx</span>.<br/>
<span class="id">revert</span> <span class="id">Fx</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span>, <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="tactic">simpl</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">Hlxy</span>.<br/>
<span class="tactic">set</span> (<span class="id">mx</span> := <span class="id"><a href="compcert.flocq.Core.Raux.html#Ztrunc">Ztrunc</a></span> (<span class="id">x</span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id">fexp</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)))).<br/>
<span class="tactic">intros</span> <span class="id">Fx</span>.<br/>
<span class="tactic">assert</span> (<span class="id">R</span> : (<span class="id">x</span> + <span class="id">y</span>) * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id">fexp</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id">mx</span> + <span class="id">y</span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id">fexp</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))).<br/>
{ <span class="tactic">rewrite</span> <span class="id">Fx</span> <span class="tactic">at</span> 1.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_plus_distr_r">Rmult_plus_distr_r</a></span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">bpow_simplify</span>. }<br/>
<span class="tactic">rewrite</span> <span class="id">R</span>.<br/>
<span class="tactic">assert</span> (<span class="id">LB</span> : 0 &lt; <span class="id">y</span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id">fexp</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))).<br/>
{ <span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_r">Rmult_0_r</a></span> <span class="id">y</span>).<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_lt_compat_l">Rmult_lt_compat_l</a></span>; [|<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>]. }<br/>
<span class="tactic">assert</span> (<span class="id">UB</span> : <span class="id">y</span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id">fexp</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)) &lt; / <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> ^ <span class="id">k</span>)).<br/>
{ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>) * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id">fexp</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))).<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_compat_r">Rmult_lt_compat_r</a></span>; [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span> <span class="id">y</span>) <span class="tactic">at</span> 1; [|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_ge">Rle_ge</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_mag_gt">bpow_mag_gt</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) - <span class="id">k</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id">fexp</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)))%<span class="id">R</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_r">Rmult_le_compat_r</a></span>; [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_ge_0">bpow_ge_0</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_le">bpow_le</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_opp">bpow_opp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">k</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">simpl</span>; <span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow">Raux.bpow</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pow_pos">Z.pow_pos</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_refl">Rle_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">casetype</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>; <span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.lt_irrefl">Z.lt_irrefl</a></span> 0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.lt_trans">Z.lt_trans</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hk</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zlt_neg_0">Zlt_neg_0</a></span>. }<br/>
<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor_imp">Zfloor_imp</a></span> <span class="id">mx</span>).<br/>
{ <span class="tactic">split</span>; <span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_r">Rmult_lt_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id">fexp</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)))); [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rmult_minus_distr_r">Rmult_minus_distr_r</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_l">Rmult_0_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">R</span>; <span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>; [|<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>].<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_r">Rmult_lt_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id">fexp</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)))); [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rmult_minus_distr_r">Rmult_minus_distr_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">R</span>; <span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">UB</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_opp">bpow_opp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rinv_le">Rinv_le</a></span>; [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#IZR_Zpower">IZR_Zpower</a></span>; [<span class="id">right</span>|<span class="tactic">omega</span>]. }<br/>
<span class="tactic">split</span>.<br/>
- <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_0_r">Rplus_0_r</a></span> <span class="tactic">at</span> 1; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat_l">Rplus_le_compat_l</a></span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>.<br/>
- <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#plus_IZR">plus_IZR</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_lt_compat_l">Rplus_lt_compat_l</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_r">Rmult_lt_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)))); [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span>.<br/>
&nbsp;&nbsp;<span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rlt_trans">Rlt_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>)).<br/>
&nbsp;&nbsp;+ <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span> <span class="tactic">at</span> 1; [|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_ge">Rle_ge</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_mag_gt">bpow_mag_gt</a></span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_lt">bpow_lt</a></span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_plus_aux1">round_round_plus_aux1</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">choice1</span> <span class="id">choice2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_hyp">round_round_plus_hyp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt; 0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) - 2)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> + <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6266')">Proof.</div>
<div class="proofscript" id="proof6266">
<span class="tactic">assert</span> (<span class="id">Hbeta</span> : (2 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span>)%<span class="id">Z</span>).<br/>
{ <span class="tactic">destruct</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="kwd">as</span> (<span class="id">beta_val</span>,<span class="id">beta_prop</span>).<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zle_bool_imp_le">Zle_bool_imp_le</a></span>. }<br/>
<span class="tactic">intros</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Vfexp1</span> <span class="id">Vfexp2</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Hexp</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Px</span> <span class="id">Py</span> <span class="id">Hly</span> <span class="id">Fx</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Lxy</span> : <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> + <span class="id">y</span>) = <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> :&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>);<br/>
&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag_plus_separated">mag_plus_separated</a></span> <span class="id">fexp1</span>); [|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>| |<span class="tactic">omega</span>]|].<br/>
<span class="tactic">destruct</span> <span class="id">Hexp</span> <span class="kwd">as</span> (<span class="id">_</span>,(<span class="id">_</span>,(<span class="id">_</span>,<span class="id">Hexp4</span>))).<br/>
<span class="tactic">assert</span> (<span class="id">Hf2</span> : (<span class="id">fexp2</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) &lt;= <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))%<span class="id">Z</span>);<br/>
&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id">Hexp4</span>; <span class="tactic">omega</span>|].<br/>
<span class="tactic">assert</span> (<span class="id">Bpow2</span> : <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- 2) &lt;= / 2 * / 2).<br/>
{ <span class="tactic">replace</span> (/2 * /2) <span class="kwd">with</span> (/4) <span class="tactic">by</span> <span class="id">field</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_opp">bpow_opp</a></span> <span class="id">_</span> 2).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rinv_le">Rinv_le</a></span>; [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#IZR_le">IZR_le</a></span> (2 * 2) (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> * (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> * 1))).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zmult_1_r">Zmult_1_r</a></span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zmult_le_compat">Zmult_le_compat</a></span>; <span class="tactic">omega</span>. }<br/>
<span class="tactic">assert</span> (<span class="id">P2</span> : (0 &lt; 2)%<span class="id">Z</span>) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_lt_mid">round_round_lt_mid</a></span>.<br/>
- <span class="tactic">exact</span> <span class="id">Vfexp1</span>.<br/>
- <span class="tactic">exact</span> <span class="id">Vfexp2</span>.<br/>
- <span class="id">lra</span>.<br/>
- <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">Lxy</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id">Lxy</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)%<span class="id">Z</span>; [|<span class="tactic">omega</span>].<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#mag_generic_gt">mag_generic_gt</a></span>; [|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>|].<br/>
- <span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#midp">midp</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_reg_r">Rplus_lt_reg_r</a></span> (- <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> (<span class="id">x</span> + <span class="id">y</span>))).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj2">proj2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_aux1_aux">round_round_plus_aux1_aux</a></span> 2 <span class="id">P2</span> <span class="id">fexp1</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Px</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Py</span> <span class="id">Hly</span> <span class="id">Lxy</span> <span class="id">Fx</span>))).<br/>
&nbsp;&nbsp;<span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp_neq_0">ulp_neq_0</a></span>;[<span class="id">idtac</span>|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_0_compat">Rplus_lt_0_compat</a></span>].<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="tactic">rewrite</span> <span class="id">Lxy</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_reg_r">Rmult_le_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)))); [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;<span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Bpow2</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_1_r">Rmult_1_r</a></span> (/ 2)) <span class="tactic">at</span> 3.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_l">Rmult_le_compat_l</a></span>; <span class="id">lra</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp_neq_0">ulp_neq_0</a></span>;[<span class="id">idtac</span>|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_0_compat">Rplus_lt_0_compat</a></span>].<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span>, <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="tactic">simpl</span>; <span class="tactic">rewrite</span> <span class="id">Lxy</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">Hf2</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_r">Rmult_lt_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_r">Rmult_lt_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)))); [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;<span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_reg_r">Rplus_lt_reg_r</a></span> (- <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> (<span class="id">x</span> + <span class="id">y</span>))).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#midp">midp</a></span>; <span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj2">proj2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_aux1_aux">round_round_plus_aux1_aux</a></span> 2 <span class="id">P2</span> <span class="id">fexp1</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Px</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Py</span> <span class="id">Hly</span> <span class="id">Lxy</span> <span class="id">Fx</span>))).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_reg_r">Rmult_le_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)))); [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp_neq_0">ulp_neq_0</a></span>;[<span class="id">idtac</span>|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_0_compat">Rplus_lt_0_compat</a></span>].<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="tactic">rewrite</span> <span class="id">Lxy</span>, <span class="id"><a href="compcert.flocq.Core.Raux.html#Rmult_minus_distr_r">Rmult_minus_distr_r</a></span>; <span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Bpow2</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_1_r">Rmult_1_r</a></span> (/ 2)) <span class="tactic">at</span> 3; <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_minus_distr_l">Rmult_minus_distr_l</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_l">Rmult_le_compat_l</a></span>; [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_reg_r">Rplus_le_reg_r</a></span> (- 1)); <span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">_</span> - <span class="id">_</span>) <span class="kwd">with</span> (- (/ 2)) <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_le_contravar">Ropp_le_contravar</a></span>.<br/>
&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- 1)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_le">bpow_le</a></span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow">Raux.bpow</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pow_pos">Z.pow_pos</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rinv_le">Rinv_le</a></span>; [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#IZR_le">IZR_le</a></span>; <span class="tactic">omega</span>. }<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_plus_aux2">round_round_plus_aux2</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">choice1</span> <span class="id">choice2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_hyp">round_round_plus_hyp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt; 0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> + <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6267')">Proof.</div>
<div class="proofscript" id="proof6267">
<span class="tactic">intros</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Vfexp1</span> <span class="id">Vfexp2</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Hexp</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Px</span> <span class="id">Py</span> <span class="id">Hyx</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zle_or_lt">Zle_or_lt</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>) (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) - 2)) <span class="kwd">as</span> [<span class="id">Hly</span>|<span class="id">Hly</span>].<br/>
- <span class="comment">(*&nbsp;mag&nbsp;y&nbsp;&lt;=&nbsp;fexp1&nbsp;(mag&nbsp;x)&nbsp;-&nbsp;2&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_aux1">round_round_plus_aux1</a></span>.<br/>
- <span class="comment">(*&nbsp;fexp1&nbsp;(mag&nbsp;x)&nbsp;-&nbsp;2&nbsp;&lt;&nbsp;mag&nbsp;y&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_generic">round_generic</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span>).<br/>
&nbsp;&nbsp;+ <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_rnd_N">valid_rnd_N</a></span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">assert</span> (<span class="id">Hf1</span> : (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) - 1 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>)%<span class="id">Z</span>); [<span class="tactic">omega</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_aux0">round_round_plus_aux0</a></span> <span class="id">fexp1</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_plus_aux">round_round_plus_aux</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">choice1</span> <span class="id">choice2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_hyp">round_round_plus_hyp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;0 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt; 0 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> + <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6268')">Proof.</div>
<div class="proofscript" id="proof6268">
<span class="tactic">intros</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Vfexp1</span> <span class="id">Vfexp2</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Hexp</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Nnx</span> <span class="id">Nny</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_dec">Req_dec</a></span> <span class="id">x</span> 0) <span class="kwd">as</span> [<span class="id">Zx</span>|<span class="id">Nzx</span>].<br/>
- <span class="comment">(*&nbsp;x&nbsp;=&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hexp</span> <span class="kwd">as</span> (<span class="id">_</span>,(<span class="id">_</span>,(<span class="id">_</span>,<span class="id">Hexp4</span>))).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Zx</span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_0_l">Rplus_0_l</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_generic">round_generic</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span>).<br/>
&nbsp;&nbsp;+ <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_rnd_N">valid_rnd_N</a></span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_inclusion_mag">generic_inclusion_mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">intros</span> <span class="id">_</span>; <span class="tactic">apply</span> <span class="id">Hexp4</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exact</span> <span class="id">Fy</span>.<br/>
- <span class="comment">(*&nbsp;x&nbsp;&lt;&gt;&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_dec">Req_dec</a></span> <span class="id">y</span> 0) <span class="kwd">as</span> [<span class="id">Zy</span>|<span class="id">Nzy</span>].<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;y&nbsp;=&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hexp</span> <span class="kwd">as</span> (<span class="id">_</span>,(<span class="id">_</span>,(<span class="id">_</span>,<span class="id">Hexp4</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Zy</span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_0_r">Rplus_0_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_generic">round_generic</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_rnd_N">valid_rnd_N</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_inclusion_mag">generic_inclusion_mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">intros</span> <span class="id">_</span>; <span class="tactic">apply</span> <span class="id">Hexp4</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exact</span> <span class="id">Fx</span>.<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;y&nbsp;&lt;&gt;&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Px</span> : 0 &lt; <span class="id">x</span>); [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Py</span> : 0 &lt; <span class="id">y</span>); [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_or_le">Rlt_or_le</a></span> <span class="id">x</span> <span class="id">y</span>) <span class="kwd">as</span> [<span class="id">H</span>|<span class="id">H</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="comment">(*&nbsp;x&nbsp;&lt;&nbsp;y&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_comm">Rplus_comm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_aux2">round_round_plus_aux2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_aux2">round_round_plus_aux2</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_minus_aux0_aux">round_round_minus_aux0_aux</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>),<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>))%<span class="id">Z</span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>))%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>))%<span class="id">Z</span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>))%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6269')">Proof.</div>
<div class="proofscript" id="proof6269">
<span class="tactic">intros</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">x</span> <span class="id">y</span>.<br/>
<span class="tactic">replace</span> (<span class="id">x</span> - <span class="id">y</span>)%<span class="id">R</span> <span class="kwd">with</span> (<span class="id">x</span> + (- <span class="id">y</span>))%<span class="id">R</span>; [|<span class="tactic">ring</span>].<br/>
<span class="tactic">intros</span> <span class="id">Hlnx</span> <span class="id">Hlny</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="compcert.flocq.Core.Raux.html#mag_opp">mag_opp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">y</span>) <span class="kwd">in</span> <span class="id">Hlny</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format_opp">generic_format_opp</a></span> <span class="kwd">in</span> <span class="id">Fy</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_aux0_aux">round_round_plus_aux0_aux</a></span> <span class="id">fexp1</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_minus_aux0">round_round_minus_aux0</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_hyp">round_round_plus_hyp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) - 1 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6270')">Proof.</div>
<div class="proofscript" id="proof6270">
<span class="tactic">intros</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Hexp</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Py</span> <span class="id">Hyx</span> <span class="id">Hln</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Px</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rlt_trans">Rlt_trans</a></span> 0 <span class="id">y</span> <span class="id">x</span> <span class="id">Py</span> <span class="id">Hyx</span>).<br/>
<span class="tactic">destruct</span> <span class="id">Hexp</span> <span class="kwd">as</span> (<span class="id">Hexp1</span>,(<span class="id">_</span>,(<span class="id">Hexp3</span>,<span class="id">Hexp4</span>))).<br/>
<span class="tactic">assert</span> (<span class="id">Lyx</span> : (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)%<span class="id">Z</span>);<br/>
&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#mag_le">mag_le</a></span>; [|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>]|].<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.lt_ge_cases">Z.lt_ge_cases</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> - 2) (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>)) <span class="kwd">as</span> [<span class="id">Hlt</span>|<span class="id">Hge</span>].<br/>
- <span class="comment">(*&nbsp;mag&nbsp;x&nbsp;-&nbsp;2&nbsp;&lt;&nbsp;mag&nbsp;y&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hor</span> : (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span> = <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> :&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/ (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span> = <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> - 1 :&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>)%<span class="id">Z</span>); [<span class="tactic">omega</span>|].<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hor</span> <span class="kwd">as</span> [<span class="id">Heq</span>|<span class="id">Heqm1</span>].<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;mag&nbsp;y&nbsp;=&nbsp;mag&nbsp;x&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_minus_aux0_aux">round_round_minus_aux0_aux</a></span> <span class="id">fexp1</span>); [| |<span class="tactic">exact</span> <span class="id">Fx</span>|<span class="tactic">exact</span> <span class="id">Fy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id">Hexp4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_trans">Z.le_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> - <span class="id">y</span>)); [<span class="tactic">omega</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#mag_minus">mag_minus</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hexp4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_trans">Z.le_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> - <span class="id">y</span>)); [<span class="tactic">omega</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#mag_minus">mag_minus</a></span>.<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;mag&nbsp;y&nbsp;=&nbsp;mag&nbsp;x&nbsp;-&nbsp;1&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_minus_aux0_aux">round_round_minus_aux0_aux</a></span> <span class="id">fexp1</span>); [| |<span class="tactic">exact</span> <span class="id">Fx</span>|<span class="tactic">exact</span> <span class="id">Fy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id">Hexp4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_trans">Z.le_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> - <span class="id">y</span>)); [<span class="tactic">omega</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#mag_minus">mag_minus</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id">Heqm1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hexp4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zplus_le_compat_r">Zplus_le_compat_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#mag_minus">mag_minus</a></span>.<br/>
- <span class="comment">(*&nbsp;mag&nbsp;y&nbsp;&lt;=&nbsp;mag&nbsp;x&nbsp;-&nbsp;2&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag_minus_disj">mag_minus_disj</a></span> <span class="id">x</span> <span class="id">y</span> <span class="id">Px</span> <span class="id">Py</span> <span class="id">Hge</span>) <span class="kwd">as</span> [<span class="id">Lxmy</span>|<span class="id">Lxmy</span>].<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;mag&nbsp;(x&nbsp;-&nbsp;y)&nbsp;=&nbsp;mag&nbsp;x&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_minus_aux0_aux">round_round_minus_aux0_aux</a></span> <span class="id">fexp1</span>); [| |<span class="tactic">exact</span> <span class="id">Fx</span>|<span class="tactic">exact</span> <span class="id">Fy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id">Hexp4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">Lxmy</span>; <span class="tactic">apply</span> <span class="id">Hexp3</span>.<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;mag&nbsp;(x&nbsp;-&nbsp;y)&nbsp;=&nbsp;mag&nbsp;x&nbsp;-&nbsp;1&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_minus_aux0_aux">round_round_minus_aux0_aux</a></span> <span class="id">fexp1</span>); [| |<span class="tactic">exact</span> <span class="id">Fx</span>|<span class="tactic">exact</span> <span class="id">Fy</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Lxmy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id">Hexp1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">_</span> + <span class="id">_</span>)%<span class="id">Z</span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>); [|<span class="tactic">ring</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_trans">Z.le_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id">Hexp1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">replace</span> (<span class="id">_</span> + <span class="id">_</span>)%<span class="id">Z</span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>); [|<span class="tactic">ring</span>].<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_minus_aux1">round_round_minus_aux1</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_hyp">round_round_plus_hyp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) - 2)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>)) - 1 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6271')">Proof.</div>
<div class="proofscript" id="proof6271">
<span class="tactic">intros</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Vfexp1</span> <span class="id">Vfexp2</span>  <span class="id">Hexp</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Py</span> <span class="id">Hyx</span> <span class="id">Hln</span> <span class="id">Hln</span>' <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Px</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rlt_trans">Rlt_trans</a></span> 0 <span class="id">y</span> <span class="id">x</span> <span class="id">Py</span> <span class="id">Hyx</span>).<br/>
<span class="tactic">destruct</span> <span class="id">Hexp</span> <span class="kwd">as</span> (<span class="id">Hexp1</span>,(<span class="id">Hexp2</span>,(<span class="id">Hexp3</span>,<span class="id">Hexp4</span>))).<br/>
<span class="tactic">assert</span> (<span class="id">Lyx</span> : (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)%<span class="id">Z</span>);<br/>
&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#mag_le">mag_le</a></span>; [|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>]|].<br/>
<span class="tactic">assert</span> (<span class="id">Hfx</span> : (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)%<span class="id">Z</span>);<br/>
&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#mag_generic_gt">mag_generic_gt</a></span>; [|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>|]|].<br/>
<span class="tactic">assert</span> (<span class="id">Hfy</span> : (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>) &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>)%<span class="id">Z</span>);<br/>
&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#mag_generic_gt">mag_generic_gt</a></span>; [|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>|]|].<br/>
<span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_minus_aux0_aux">round_round_minus_aux0_aux</a></span> <span class="id">fexp1</span>); [| |<span class="tactic">exact</span> <span class="id">Fx</span>|<span class="tactic">exact</span> <span class="id">Fy</span>].<br/>
- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_trans">Z.le_trans</a></span> <span class="kwd">with</span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> - <span class="id">y</span>))).<br/>
&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">Hexp4</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">omega</span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id">Hexp3</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_minus_aux2_aux">round_round_minus_aux2_aux</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">fexp</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp">fexp</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) - 1)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zceil">Zceil</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>) - (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6272')">Proof.</div>
<div class="proofscript" id="proof6272">
<span class="tactic">intros</span> <span class="id">fexp</span> <span class="id">Vfexp</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Py</span> <span class="id">Hxy</span> <span class="id">Hly</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Px</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rlt_trans">Rlt_trans</a></span> 0 <span class="id">y</span> <span class="id">x</span> <span class="id">Py</span> <span class="id">Hxy</span>).<br/>
<span class="id">revert</span> <span class="id">Fx</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span>, <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="tactic">simpl</span>.<br/>
<span class="tactic">set</span> (<span class="id">mx</span> := <span class="id"><a href="compcert.flocq.Core.Raux.html#Ztrunc">Ztrunc</a></span> (<span class="id">x</span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id">fexp</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)))).<br/>
<span class="tactic">intro</span> <span class="id">Fx</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Hfx</span> : (<span class="id">fexp</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)%<span class="id">Z</span>);<br/>
&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#mag_generic_gt">mag_generic_gt</a></span>; [|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>|]|].<br/>
<span class="tactic">assert</span> (<span class="id">Hfy</span> : (<span class="id">fexp</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>) &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>)%<span class="id">Z</span>);<br/>
&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#mag_generic_gt">mag_generic_gt</a></span>; [|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>|]|].<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_or_le">Rlt_or_le</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> - 1)) <span class="id">x</span>) <span class="kwd">as</span> [<span class="id">Hx</span>|<span class="id">Hx</span>].<br/>
- <span class="comment">(*&nbsp;bpow&nbsp;(mag&nbsp;x&nbsp;-&nbsp;1)&nbsp;&lt;&nbsp;x&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Lxy</span> : <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> - <span class="id">y</span>) = <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> :&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag_minus_separated">mag_minus_separated</a></span> <span class="id">fexp</span>); [| | | | | |<span class="tactic">omega</span>]|].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Rxy</span> : <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zceil">Zceil</a></span> (<span class="id">x</span> - <span class="id">y</span>) = <span class="id">x</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span>, <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Lxy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_sym">eq_sym</a></span>; <span class="tactic">rewrite</span> <span class="id">Fx</span> <span class="tactic">at</span> 1; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_sym">eq_sym</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_eq_compat_r">Rmult_eq_compat_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Fx</span> <span class="tactic">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rmult_minus_distr_r">Rmult_minus_distr_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zceil_imp">Zceil_imp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.sub">Zminus</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#plus_IZR">plus_IZR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_lt_compat_l">Rplus_lt_compat_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_lt_contravar">Ropp_lt_contravar</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_r">Rmult_lt_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span>; <span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span> <span class="tactic">at</span> 1; [|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_ge">Rle_ge</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_mag_gt">bpow_mag_gt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_le">bpow_le</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_0_r">Rplus_0_r</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id">_</span>)) <span class="tactic">at</span> 2.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat_l">Rplus_le_compat_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_0">Ropp_0</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_le_contravar">Ropp_le_contravar</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_r">Rmult_0_r</a></span> <span class="id">y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_l">Rmult_le_compat_l</a></span>; [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_ge_0">bpow_ge_0</a></span>. }<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Rxy</span>; <span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_refl">Rle_refl</a></span>.<br/>
- <span class="comment">(*&nbsp;x&nbsp;&lt;=&nbsp;bpow&nbsp;(mag&nbsp;x&nbsp;-&nbsp;1)&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Xpow</span> : <span class="id">x</span> = <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> - 1)).<br/>
&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_antisym">Rle_antisym</a></span>; [<span class="tactic">exact</span> <span class="id">Hx</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) <span class="kwd">as</span> (<span class="id">ex</span>, <span class="id">Hex</span>); <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span> <span class="id">x</span>); [|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_ge">Rle_ge</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hex</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>. }<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Lxy</span> : (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> - <span class="id">y</span>) = <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> - 1 :&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>)%<span class="id">Z</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zle_antisym">Zle_antisym</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#mag_le_bpow">mag_le_bpow</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rminus_eq_contra">Rminus_eq_contra</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">intro</span> <span class="id">Hx</span>'; <span class="tactic">rewrite</span> <span class="id">Hx</span>' <span class="kwd">in</span> <span class="id">Hxy</span>; <span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_irrefl">Rlt_irrefl</a></span> <span class="id">y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#mag_minus_lb">mag_minus_lb</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">x</span> <span class="id">y</span> <span class="id">Px</span> <span class="id">Py</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hfx1</span> : (<span class="id">fexp</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> - 1) &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> - 1)%<span class="id">Z</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_exp_large">valid_exp_large</a></span> <span class="id">fexp</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>)); [|<span class="tactic">omega</span>]|].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Rxy</span> : <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zceil">Zceil</a></span> (<span class="id">x</span> - <span class="id">y</span>) &lt;= <span class="id">x</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">rewrite</span> <span class="id">Xpow</span> <span class="tactic">at</span> 2.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span>, <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Lxy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_reg_r">Rmult_le_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id">fexp</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> - 1)%<span class="id">Z</span>)));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="compcert.flocq.Core.Raux.html#IZR_Zpower">IZR_Zpower</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> (<span class="id">_</span> - <span class="id">_</span> - <span class="id">_</span>)); [|<span class="tactic">omega</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#IZR_le">IZR_le</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zceil_glb">Zceil_glb</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#IZR_Zpower">IZR_Zpower</a></span>; [|<span class="tactic">omega</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Xpow</span> <span class="tactic">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rmult_minus_distr_r">Rmult_minus_distr_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_0_r">Rplus_0_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> <span class="id">_</span>)) <span class="tactic">at</span> 2.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat_l">Rplus_le_compat_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_0">Ropp_0</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_le_contravar">Ropp_le_contravar</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_r">Rmult_0_r</a></span> <span class="id">y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_l">Rmult_le_compat_l</a></span>; [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_ge_0">bpow_ge_0</a></span>. }<br/>
&nbsp;&nbsp;<span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_minus_aux2">round_round_minus_aux2</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">choice1</span> <span class="id">choice2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_hyp">round_round_plus_hyp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) - 2)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>)) - 2)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6273')">Proof.</div>
<div class="proofscript" id="proof6273">
<span class="tactic">assert</span> (<span class="id">Hbeta</span> : (2 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span>)%<span class="id">Z</span>).<br/>
{ <span class="tactic">destruct</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="kwd">as</span> (<span class="id">beta_val</span>,<span class="id">beta_prop</span>).<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zle_bool_imp_le">Zle_bool_imp_le</a></span>. }<br/>
<span class="tactic">intros</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Vfexp1</span> <span class="id">Vfexp2</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Hexp</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Py</span> <span class="id">Hxy</span> <span class="id">Hly</span> <span class="id">Hly</span>' <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Px</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rlt_trans">Rlt_trans</a></span> 0 <span class="id">y</span> <span class="id">x</span> <span class="id">Py</span> <span class="id">Hxy</span>).<br/>
<span class="tactic">destruct</span> <span class="id">Hexp</span> <span class="kwd">as</span> (<span class="id">_</span>,(<span class="id">_</span>,(<span class="id">_</span>,<span class="id">Hexp4</span>))).<br/>
<span class="tactic">assert</span> (<span class="id">Hf2</span> : (<span class="id">fexp2</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) &lt;= <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))%<span class="id">Z</span>);<br/>
&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id">Hexp4</span>; <span class="tactic">omega</span>|].<br/>
<span class="tactic">assert</span> (<span class="id">Hfx</span> : (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)%<span class="id">Z</span>);<br/>
&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#mag_generic_gt">mag_generic_gt</a></span>; [|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>|]|].<br/>
<span class="tactic">assert</span> (<span class="id">Bpow2</span> : <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- 2) &lt;= / 2 * / 2).<br/>
{ <span class="tactic">replace</span> (/2 * /2) <span class="kwd">with</span> (/4) <span class="tactic">by</span> <span class="id">field</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_opp">bpow_opp</a></span> <span class="id">_</span> 2).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rinv_le">Rinv_le</a></span>; [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#IZR_le">IZR_le</a></span> (2 * 2) (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> * (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> * 1))).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zmult_1_r">Zmult_1_r</a></span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zmult_le_compat">Zmult_le_compat</a></span>; <span class="tactic">omega</span>. }<br/>
<span class="tactic">assert</span> (<span class="id">Ly</span> : <span class="id">y</span> &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>)).<br/>
{ <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rabs_lt_inv">Rabs_lt_inv</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_mag_gt">bpow_mag_gt</a></span>. }<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_gt_mid">round_round_gt_mid</a></span>.<br/>
- <span class="tactic">exact</span> <span class="id">Vfexp1</span>.<br/>
- <span class="tactic">exact</span> <span class="id">Vfexp2</span>.<br/>
- <span class="id">lra</span>.<br/>
- <span class="tactic">apply</span> <span class="id">Hexp4</span>; <span class="tactic">omega</span>.<br/>
- <span class="tactic">assert</span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> - <span class="id">y</span>)) &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> - <span class="id">y</span>))%<span class="id">Z</span>; [|<span class="tactic">omega</span>].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_exp_large">valid_exp_large</a></span> <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> - 1)).<br/>
&nbsp;&nbsp;+ <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_exp_large">valid_exp_large</a></span> <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>)); [|<span class="tactic">omega</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#mag_generic_gt">mag_generic_gt</a></span>; [|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>|].<br/>
&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#mag_minus_lb">mag_minus_lb</a></span>; [| |<span class="tactic">omega</span>].<br/>
- <span class="tactic">unfold</span> <span class="id">midp</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_reg_r">Rplus_lt_reg_r</a></span> (/ 2 * <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> (<span class="id">x</span> - <span class="id">y</span>) - (<span class="id">x</span> - <span class="id">y</span>))).<br/>
&nbsp;&nbsp;<span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">_</span> + <span class="id">_</span>) <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zceil">Zceil</a></span> (<span class="id">x</span> - <span class="id">y</span>) - (<span class="id">x</span> - <span class="id">y</span>)) <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> - <span class="id">y</span>)) - 2)).<br/>
&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> <span class="id">y</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_minus_aux2_aux">round_round_minus_aux2_aux</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>; <span class="tactic">omega</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Ly</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_le">bpow_le</a></span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp_neq_0">ulp_neq_0</a></span>;[<span class="id">idtac</span>|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#sym_not_eq">sym_not_eq</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_not_eq">Rlt_not_eq</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_minus">Rgt_minus</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">_</span> - 2)%<span class="id">Z</span> <span class="kwd">with</span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> - <span class="id">y</span>)) - 1 - 1)%<span class="id">Z</span> <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.sub">Zminus</a></span> <span class="tactic">at</span> 1; <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_plus">bpow_plus</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat">Rmult_le_compat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_ge_0">bpow_ge_0</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_ge_0">bpow_ge_0</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow">Raux.bpow</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pow_pos">Z.pow_pos</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zmult_1_r">Zmult_1_r</a></span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rinv_le">Rinv_le</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#IZR_le">IZR_le</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_le">bpow_le</a></span>; <span class="tactic">omega</span>.<br/>
- <span class="tactic">intro</span> <span class="id">Hf2</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">midp</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_reg_r">Rplus_lt_reg_r</a></span> (/ 2 * <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> (<span class="id">x</span> - <span class="id">y</span>) - (<span class="id">x</span> - <span class="id">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- / 2 * <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span> (<span class="id">x</span> - <span class="id">y</span>))).<br/>
&nbsp;&nbsp;<span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">_</span> + <span class="id">_</span>) <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zceil">Zceil</a></span> (<span class="id">x</span> - <span class="id">y</span>) - (<span class="id">x</span> - <span class="id">y</span>)) <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> <span class="id">y</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_minus_aux2_aux">round_round_minus_aux2_aux</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>; <span class="tactic">omega</span>|].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Ly</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> - <span class="id">y</span>)) - 2));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_le">bpow_le</a></span>|].<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">_</span> - 2)%<span class="id">Z</span> <span class="kwd">with</span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> - <span class="id">y</span>)) - 1 - 1)%<span class="id">Z</span> <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.sub">Zminus</a></span> <span class="tactic">at</span> 1; <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_plus">bpow_plus</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_minus_distr_l">Rmult_minus_distr_l</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat">Rmult_le_compat</a></span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_ge_0">bpow_ge_0</a></span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_ge_0">bpow_ge_0</a></span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow">Raux.bpow</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pow_pos">Z.pow_pos</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zmult_1_r">Zmult_1_r</a></span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rinv_le">Rinv_le</a></span>; [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#IZR_le">IZR_le</a></span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">rewrite</span> 2!<span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp_neq_0">ulp_neq_0</a></span>; <span class="tactic">try</span> <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_minus">Rgt_minus</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_reg_r">Rplus_le_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp2</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> - <span class="id">y</span>))))); <span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> - <span class="id">y</span>)) - 1)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#double">double</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat_l">Rplus_le_compat_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_le">bpow_le</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.sub">Zminus</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_plus">bpow_plus</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_1_r">Rmult_1_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_l">Rmult_le_compat_l</a></span>; [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_ge_0">bpow_ge_0</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow">Raux.bpow</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pow_pos">Z.pow_pos</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zmult_1_r">Zmult_1_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#IZR_le">IZR_le</a></span>, <span class="id"><a href="compcert.flocq.Core.Raux.html#Rinv_le">Rinv_le</a></span> <span class="kwd">in</span> <span class="id">Hbeta</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Hbeta</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.setoid_ring.RealField.html#Rlt_0_2">Rlt_0_2</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_minus_aux3">round_round_minus_aux3</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">choice1</span> <span class="id">choice2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_hyp">round_round_plus_hyp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6274')">Proof.</div>
<div class="proofscript" id="proof6274">
<span class="tactic">intros</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Vfexp1</span> <span class="id">Vfexp2</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Hexp</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Py</span> <span class="id">Hyx</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Px</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> 0 <span class="id">y</span> <span class="id">x</span> <span class="id">Py</span> <span class="id">Hyx</span>).<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_dec">Req_dec</a></span> <span class="id">y</span> <span class="id">x</span>) <span class="kwd">as</span> [<span class="id">Hy</span>|<span class="id">Hy</span>].<br/>
- <span class="comment">(*&nbsp;y&nbsp;=&nbsp;x&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hy</span>; <span class="tactic">replace</span> (<span class="id">x</span> - <span class="id">x</span>) <span class="kwd">with</span> 0 <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_0">round_0</a></span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_rnd_N">valid_rnd_N</a></span>.<br/>
- <span class="comment">(*&nbsp;y&nbsp;&lt;&nbsp;x&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hyx</span>' : <span class="id">y</span> &lt; <span class="id">x</span>); [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zle_or_lt">Zle_or_lt</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>) (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) - 2)) <span class="kwd">as</span> [<span class="id">Hly</span>|<span class="id">Hly</span>].<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;mag&nbsp;y&nbsp;&lt;=&nbsp;fexp1&nbsp;(mag&nbsp;x)&nbsp;-&nbsp;2&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zle_or_lt">Zle_or_lt</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>) (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> - <span class="id">y</span>)) - 2))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> [<span class="id">Hly</span>'|<span class="id">Hly</span>'].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="comment">(*&nbsp;mag&nbsp;y&nbsp;&lt;=&nbsp;fexp1&nbsp;(mag&nbsp;(x&nbsp;-&nbsp;y))&nbsp;-&nbsp;2&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_minus_aux2">round_round_minus_aux2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="comment">(*&nbsp;fexp1&nbsp;(mag&nbsp;(x&nbsp;-&nbsp;y))&nbsp;-&nbsp;2&nbsp;&lt;&nbsp;mag&nbsp;y&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">rewrite</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_generic">round_generic</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_rnd_N">valid_rnd_N</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">assert</span> (<span class="id">Hf1</span> : (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> - <span class="id">y</span>)) - 1 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>)%<span class="id">Z</span>); [<span class="tactic">omega</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_minus_aux1">round_round_minus_aux1</a></span> <span class="id">fexp1</span>). }<br/>
&nbsp;&nbsp;+ <span class="tactic">rewrite</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_generic">round_generic</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_rnd_N">valid_rnd_N</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">assert</span> (<span class="id">Hf1</span> : (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) - 1 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>)%<span class="id">Z</span>); [<span class="tactic">omega</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_minus_aux0">round_round_minus_aux0</a></span> <span class="id">fexp1</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_minus_aux">round_round_minus_aux</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">choice1</span> <span class="id">choice2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_hyp">round_round_plus_hyp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;0 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt; 0 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6275')">Proof.</div>
<div class="proofscript" id="proof6275">
<span class="tactic">intros</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Vfexp1</span> <span class="id">Vfexp2</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Hexp</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Nnx</span> <span class="id">Nny</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_dec">Req_dec</a></span> <span class="id">x</span> 0) <span class="kwd">as</span> [<span class="id">Zx</span>|<span class="id">Nzx</span>].<br/>
- <span class="comment">(*&nbsp;x&nbsp;=&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Zx</span>; <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rminus">Rminus</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_0_l">Rplus_0_l</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">do</span> 3 <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_N_opp">round_N_opp</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_generic">round_generic</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span>).<br/>
&nbsp;&nbsp;* <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;* <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_rnd_N">valid_rnd_N</a></span>.<br/>
&nbsp;&nbsp;* <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_inclusion_mag">generic_inclusion_mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hexp</span> <span class="kwd">as</span> (<span class="id">_</span>,(<span class="id">_</span>,(<span class="id">_</span>,<span class="id">Hexp4</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">intros</span> <span class="id">_</span>; <span class="tactic">apply</span> <span class="id">Hexp4</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exact</span> <span class="id">Fy</span>.<br/>
- <span class="comment">(*&nbsp;x&nbsp;&lt;&gt;&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_dec">Req_dec</a></span> <span class="id">y</span> 0) <span class="kwd">as</span> [<span class="id">Zy</span>|<span class="id">Nzy</span>].<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;y&nbsp;=&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Zy</span>; <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rminus">Rminus</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_0">Ropp_0</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_0_r">Rplus_0_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_generic">round_generic</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_rnd_N">valid_rnd_N</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_inclusion_mag">generic_inclusion_mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hexp</span> <span class="kwd">as</span> (<span class="id">_</span>,(<span class="id">_</span>,(<span class="id">_</span>,<span class="id">Hexp4</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">intros</span> <span class="id">_</span>; <span class="tactic">apply</span> <span class="id">Hexp4</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exact</span> <span class="id">Fx</span>.<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;y&nbsp;&lt;&gt;&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Px</span> : 0 &lt; <span class="id">x</span>); [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Py</span> : 0 &lt; <span class="id">y</span>); [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_or_le">Rlt_or_le</a></span> <span class="id">x</span> <span class="id">y</span>) <span class="kwd">as</span> [<span class="id">H</span>|<span class="id">H</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="comment">(*&nbsp;x&nbsp;&lt;&nbsp;y&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">x</span> - <span class="id">y</span>) <span class="kwd">with</span> (- (<span class="id">y</span> - <span class="id">x</span>)) <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 3 <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_N_opp">round_N_opp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_eq_compat">Ropp_eq_compat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_minus_aux3">round_round_minus_aux3</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="comment">(*&nbsp;y&nbsp;&lt;=&nbsp;x&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_minus_aux3">round_round_minus_aux3</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_plus">round_round_plus</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">choice1</span> <span class="id">choice2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_hyp">round_round_plus_hyp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> + <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6276')">Proof.</div>
<div class="proofscript" id="proof6276">
<span class="tactic">intros</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Vfexp1</span> <span class="id">Vfexp2</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Hexp</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_or_le">Rlt_or_le</a></span> <span class="id">x</span> 0) <span class="kwd">as</span> [<span class="id">Sx</span>|<span class="id">Sx</span>]; <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_or_le">Rlt_or_le</a></span> <span class="id">y</span> 0) <span class="kwd">as</span> [<span class="id">Sy</span>|<span class="id">Sy</span>].<br/>
- <span class="comment">(*&nbsp;x&nbsp;&lt;&nbsp;0,&nbsp;y&nbsp;&lt;&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">x</span> + <span class="id">y</span>) <span class="kwd">with</span> (- (- <span class="id">x</span> - <span class="id">y</span>)); [|<span class="tactic">ring</span>].<br/>
&nbsp;&nbsp;<span class="tactic">do</span> 3 <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_N_opp">round_N_opp</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_eq_compat">Ropp_eq_compat</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Px</span> : 0 &lt;= - <span class="id">x</span>); [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Py</span> : 0 &lt;= - <span class="id">y</span>); [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format_opp">generic_format_opp</a></span> <span class="kwd">in</span> <span class="id">Fx</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format_opp">generic_format_opp</a></span> <span class="kwd">in</span> <span class="id">Fy</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_aux">round_round_plus_aux</a></span>.<br/>
- <span class="comment">(*&nbsp;x&nbsp;&lt;&nbsp;0,&nbsp;0&nbsp;&lt;=&nbsp;y&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">x</span> + <span class="id">y</span>) <span class="kwd">with</span> (<span class="id">y</span> - (- <span class="id">x</span>)); [|<span class="tactic">ring</span>].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Px</span> : 0 &lt;= - <span class="id">x</span>); [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format_opp">generic_format_opp</a></span> <span class="kwd">in</span> <span class="id">Fx</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_minus_aux">round_round_minus_aux</a></span>.<br/>
- <span class="comment">(*&nbsp;0&nbsp;&lt;=&nbsp;x,&nbsp;y&nbsp;&lt;&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">x</span> + <span class="id">y</span>) <span class="kwd">with</span> (<span class="id">x</span> - (- <span class="id">y</span>)); [|<span class="tactic">ring</span>].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Py</span> : 0 &lt;= - <span class="id">y</span>); [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format_opp">generic_format_opp</a></span> <span class="kwd">in</span> <span class="id">Fy</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_minus_aux">round_round_minus_aux</a></span>.<br/>
- <span class="comment">(*&nbsp;0&nbsp;&lt;=&nbsp;x,&nbsp;0&nbsp;&lt;=&nbsp;y&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_aux">round_round_plus_aux</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_minus">round_round_minus</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">choice1</span> <span class="id">choice2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_hyp">round_round_plus_hyp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6277')">Proof.</div>
<div class="proofscript" id="proof6277">
<span class="tactic">intros</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Vfexp1</span> <span class="id">Vfexp2</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Hexp</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rminus">Rminus</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format_opp">generic_format_opp</a></span> <span class="kwd">in</span> <span class="id">Fy</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus">round_round_plus</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Double_round.Double_round_plus.Double_round_plus_FLX">Double_round_plus_FLX</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Double_round.Double_round_plus.Double_round_plus_FLX.prec">prec</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id">prec</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<br/>
<span class="kwd">Context</span> { <span class="id">prec_gt_0_</span> : <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLX.prec">prec</a></span> }.<br/>
<span class="kwd">Context</span> { <span class="id">prec_gt_0_</span>' : <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="id">prec</span>' }.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="FLX_round_round_plus_hyp">FLX_round_round_plus_hyp</a></span> :<br/>
&nbsp;&nbsp;(2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLX.prec">prec</a></span> + 1 &lt;= <span class="id">prec</span>')%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_hyp">round_round_plus_hyp</a></span> (<span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp">FLX_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLX.prec">prec</a></span>) (<span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp">FLX_exp</a></span> <span class="id">prec</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6278')">Proof.</div>
<div class="proofscript" id="proof6278">
<span class="tactic">intros</span> <span class="id">Hprec</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp">FLX_exp</a></span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_hyp">round_round_plus_hyp</a></span>; <span class="tactic">split</span>; [|<span class="tactic">split</span>; [|<span class="tactic">split</span>]];<br/>
<span class="tactic">intros</span> <span class="id">ex</span> <span class="id">ey</span>; <span class="tactic">try</span> <span class="tactic">omega</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="kwd">in</span> <span class="id">prec_gt_0_</span>.<br/>
<span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="round_round_plus_FLX">round_round_plus_FLX</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">choice1</span> <span class="id">choice2</span>,<br/>
&nbsp;&nbsp;(2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLX.prec">prec</a></span> + 1 &lt;= <span class="id">prec</span>')%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_format">FLX_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLX.prec">prec</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_format">FLX_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLX.prec">prec</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> (<span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp">FLX_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLX.prec">prec</a></span>) (<span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp">FLX_exp</a></span> <span class="id">prec</span>') <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> + <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6279')">Proof.</div>
<div class="proofscript" id="proof6279">
<span class="tactic">intros</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Hprec</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus">round_round_plus</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp_valid">FLX_exp_valid</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp_valid">FLX_exp_valid</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#FLX_round_round_plus_hyp">FLX_round_round_plus_hyp</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#generic_format_FLX">generic_format_FLX</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#generic_format_FLX">generic_format_FLX</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="round_round_minus_FLX">round_round_minus_FLX</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">choice1</span> <span class="id">choice2</span>,<br/>
&nbsp;&nbsp;(2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLX.prec">prec</a></span> + 1 &lt;= <span class="id">prec</span>')%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_format">FLX_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLX.prec">prec</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_format">FLX_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLX.prec">prec</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> (<span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp">FLX_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLX.prec">prec</a></span>) (<span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp">FLX_exp</a></span> <span class="id">prec</span>') <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6280')">Proof.</div>
<div class="proofscript" id="proof6280">
<span class="tactic">intros</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Hprec</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_minus">round_round_minus</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp_valid">FLX_exp_valid</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp_valid">FLX_exp_valid</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#FLX_round_round_plus_hyp">FLX_round_round_plus_hyp</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#generic_format_FLX">generic_format_FLX</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#generic_format_FLX">generic_format_FLX</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLX">Double_round_plus_FLX</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Double_round.Double_round_plus.Double_round_plus_FLT">Double_round_plus_FLT</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Double_round.Double_round_plus.Double_round_plus_FLT.emin">emin</a></span> <span class="id"><a name="Double_round.Double_round_plus.Double_round_plus_FLT.prec">prec</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id">emin</span>' <span class="id">prec</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<br/>
<span class="kwd">Context</span> { <span class="id">prec_gt_0_</span> : <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLT.prec">prec</a></span> }.<br/>
<span class="kwd">Context</span> { <span class="id">prec_gt_0_</span>' : <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="id">prec</span>' }.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="FLT_round_round_plus_hyp">FLT_round_round_plus_hyp</a></span> :<br/>
&nbsp;&nbsp;(<span class="id">emin</span>' &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLT.emin">emin</a></span>)%<span class="id">Z</span> -&gt; (2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLT.prec">prec</a></span> + 1 &lt;= <span class="id">prec</span>')%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_hyp">round_round_plus_hyp</a></span> (<span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp">FLT_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLT.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLT.prec">prec</a></span>) (<span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp">FLT_exp</a></span> <span class="id">emin</span>' <span class="id">prec</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6281')">Proof.</div>
<div class="proofscript" id="proof6281">
<span class="tactic">intros</span> <span class="id">Hemin</span> <span class="id">Hprec</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp">FLT_exp</a></span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_hyp">round_round_plus_hyp</a></span>; <span class="tactic">split</span>; [|<span class="tactic">split</span>; [|<span class="tactic">split</span>]]; <span class="tactic">intros</span> <span class="id">ex</span> <span class="id">ey</span>.<br/>
- <span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ex</span> + 1 - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLT.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLT.emin">emin</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ex</span> - <span class="id">prec</span>') <span class="id">emin</span>').<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ey</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLT.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLT.emin">emin</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
- <span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ex</span> - 1 - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLT.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLT.emin">emin</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ex</span> - <span class="id">prec</span>') <span class="id">emin</span>').<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ey</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLT.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLT.emin">emin</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
- <span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ex</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLT.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLT.emin">emin</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ex</span> - <span class="id">prec</span>') <span class="id">emin</span>').<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ey</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLT.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLT.emin">emin</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
- <span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="kwd">in</span> <span class="id">prec_gt_0_</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ex</span> - <span class="id">prec</span>') <span class="id">emin</span>').<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ey</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLT.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLT.emin">emin</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="round_round_plus_FLT">round_round_plus_FLT</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">choice1</span> <span class="id">choice2</span>,<br/>
&nbsp;&nbsp;(<span class="id">emin</span>' &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLT.emin">emin</a></span>)%<span class="id">Z</span> -&gt; (2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLT.prec">prec</a></span> + 1 &lt;= <span class="id">prec</span>')%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_format">FLT_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLT.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLT.prec">prec</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_format">FLT_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLT.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLT.prec">prec</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> (<span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp">FLT_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLT.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLT.prec">prec</a></span>) (<span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp">FLT_exp</a></span> <span class="id">emin</span>' <span class="id">prec</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> + <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6282')">Proof.</div>
<div class="proofscript" id="proof6282">
<span class="tactic">intros</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Hemin</span> <span class="id">Hprec</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus">round_round_plus</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp_valid">FLT_exp_valid</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp_valid">FLT_exp_valid</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#FLT_round_round_plus_hyp">FLT_round_round_plus_hyp</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLT.html#generic_format_FLT">generic_format_FLT</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLT.html#generic_format_FLT">generic_format_FLT</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="round_round_minus_FLT">round_round_minus_FLT</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">choice1</span> <span class="id">choice2</span>,<br/>
&nbsp;&nbsp;(<span class="id">emin</span>' &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLT.emin">emin</a></span>)%<span class="id">Z</span> -&gt; (2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLT.prec">prec</a></span> + 1 &lt;= <span class="id">prec</span>')%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_format">FLT_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLT.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLT.prec">prec</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_format">FLT_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLT.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLT.prec">prec</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> (<span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp">FLT_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLT.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLT.prec">prec</a></span>) (<span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp">FLT_exp</a></span> <span class="id">emin</span>' <span class="id">prec</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6283')">Proof.</div>
<div class="proofscript" id="proof6283">
<span class="tactic">intros</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Hemin</span> <span class="id">Hprec</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_minus">round_round_minus</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp_valid">FLT_exp_valid</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp_valid">FLT_exp_valid</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#FLT_round_round_plus_hyp">FLT_round_round_plus_hyp</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLT.html#generic_format_FLT">generic_format_FLT</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLT.html#generic_format_FLT">generic_format_FLT</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FLT">Double_round_plus_FLT</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Double_round.Double_round_plus.Double_round_plus_FTZ">Double_round_plus_FTZ</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Double_round.Double_round_plus.Double_round_plus_FTZ.emin">emin</a></span> <span class="id"><a name="Double_round.Double_round_plus.Double_round_plus_FTZ.prec">prec</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id">emin</span>' <span class="id">prec</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<br/>
<span class="kwd">Context</span> { <span class="id">prec_gt_0_</span> : <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FTZ.prec">prec</a></span> }.<br/>
<span class="kwd">Context</span> { <span class="id">prec_gt_0_</span>' : <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="id">prec</span>' }.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="FTZ_round_round_plus_hyp">FTZ_round_round_plus_hyp</a></span> :<br/>
&nbsp;&nbsp;(<span class="id">emin</span>' + <span class="id">prec</span>' &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FTZ.emin">emin</a></span> + 1)%<span class="id">Z</span> -&gt; (2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FTZ.prec">prec</a></span> + 1 &lt;= <span class="id">prec</span>')%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_hyp">round_round_plus_hyp</a></span> (<span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp">FTZ_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FTZ.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FTZ.prec">prec</a></span>) (<span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp">FTZ_exp</a></span> <span class="id">emin</span>' <span class="id">prec</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6284')">Proof.</div>
<div class="proofscript" id="proof6284">
<span class="tactic">intros</span> <span class="id">Hemin</span> <span class="id">Hprec</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp">FTZ_exp</a></span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="kwd">in</span> *.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_hyp">round_round_plus_hyp</a></span>; <span class="tactic">split</span>; [|<span class="tactic">split</span>; [|<span class="tactic">split</span>]]; <span class="tactic">intros</span> <span class="id">ex</span> <span class="id">ey</span>.<br/>
- <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ex</span> + 1 - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FTZ.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FTZ.emin">emin</a></span>);<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ex</span> - <span class="id">prec</span>') <span class="id">emin</span>');<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ey</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FTZ.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FTZ.emin">emin</a></span>);<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
- <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ex</span> - 1 - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FTZ.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FTZ.emin">emin</a></span>);<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ex</span> - <span class="id">prec</span>') <span class="id">emin</span>');<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ey</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FTZ.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FTZ.emin">emin</a></span>);<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
- <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ex</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FTZ.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FTZ.emin">emin</a></span>);<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ex</span> - <span class="id">prec</span>') <span class="id">emin</span>');<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ey</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FTZ.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FTZ.emin">emin</a></span>);<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
- <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ex</span> - <span class="id">prec</span>') <span class="id">emin</span>');<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ey</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FTZ.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FTZ.emin">emin</a></span>);<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="round_round_plus_FTZ">round_round_plus_FTZ</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">choice1</span> <span class="id">choice2</span>,<br/>
&nbsp;&nbsp;(<span class="id">emin</span>' + <span class="id">prec</span>' &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FTZ.emin">emin</a></span> + 1)%<span class="id">Z</span> -&gt; (2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FTZ.prec">prec</a></span> + 1 &lt;= <span class="id">prec</span>')%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_format">FTZ_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FTZ.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FTZ.prec">prec</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_format">FTZ_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FTZ.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FTZ.prec">prec</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> (<span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp">FTZ_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FTZ.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FTZ.prec">prec</a></span>) (<span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp">FTZ_exp</a></span> <span class="id">emin</span>' <span class="id">prec</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> + <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6285')">Proof.</div>
<div class="proofscript" id="proof6285">
<span class="tactic">intros</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Hemin</span> <span class="id">Hprec</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus">round_round_plus</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp_valid">FTZ_exp_valid</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp_valid">FTZ_exp_valid</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#FTZ_round_round_plus_hyp">FTZ_round_round_plus_hyp</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FTZ.html#generic_format_FTZ">generic_format_FTZ</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FTZ.html#generic_format_FTZ">generic_format_FTZ</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="round_round_minus_FTZ">round_round_minus_FTZ</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">choice1</span> <span class="id">choice2</span>,<br/>
&nbsp;&nbsp;(<span class="id">emin</span>' + <span class="id">prec</span>' &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FTZ.emin">emin</a></span> + 1)%<span class="id">Z</span> -&gt; (2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FTZ.prec">prec</a></span> + 1 &lt;= <span class="id">prec</span>')%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_format">FTZ_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FTZ.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FTZ.prec">prec</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_format">FTZ_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FTZ.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FTZ.prec">prec</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> (<span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp">FTZ_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FTZ.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FTZ.prec">prec</a></span>) (<span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp">FTZ_exp</a></span> <span class="id">emin</span>' <span class="id">prec</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6286')">Proof.</div>
<div class="proofscript" id="proof6286">
<span class="tactic">intros</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Hemin</span> <span class="id">Hprec</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_minus">round_round_minus</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp_valid">FTZ_exp_valid</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp_valid">FTZ_exp_valid</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#FTZ_round_round_plus_hyp">FTZ_round_round_plus_hyp</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FTZ.html#generic_format_FTZ">generic_format_FTZ</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FTZ.html#generic_format_FTZ">generic_format_FTZ</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_FTZ">Double_round_plus_FTZ</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Double_round.Double_round_plus.Double_round_plus_radix_ge_3">Double_round_plus_radix_ge_3</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_round_plus_radix_ge_3_hyp">round_round_plus_radix_ge_3_hyp</a></span> <span class="id">fexp1</span> <span class="id">fexp2</span> :=<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">ex</span> <span class="id">ey</span>, (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> + 1) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span>)%<span class="id">Z</span> -&gt; (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span>)%<span class="id">Z</span>)<br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">ex</span> <span class="id">ey</span>, (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> - 1) + 1 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span>)%<span class="id">Z</span> -&gt; (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span>)%<span class="id">Z</span>)<br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">ex</span> <span class="id">ey</span>, (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span>)%<span class="id">Z</span> -&gt; (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span>)%<span class="id">Z</span>)<br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">ex</span> <span class="id">ey</span>, (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> - 1 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span>)%<span class="id">Z</span> -&gt; (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span>)%<span class="id">Z</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_plus_radix_ge_3_aux0">round_round_plus_radix_ge_3_aux0</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>), <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_radix_ge_3_hyp">round_round_plus_radix_ge_3_hyp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;(0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>)%<span class="id">R</span> -&gt; (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>)%<span class="id">R</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> + <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6287')">Proof.</div>
<div class="proofscript" id="proof6287">
<span class="tactic">intros</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Vfexp1</span> <span class="id">Hexp</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Py</span> <span class="id">Hyx</span> <span class="id">Hln</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Px</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> 0 <span class="id">y</span> <span class="id">x</span> <span class="id">Py</span> <span class="id">Hyx</span>).<br/>
<span class="tactic">assert</span> (<span class="id">Nny</span> : (0 &lt;= <span class="id">y</span>)%<span class="id">R</span>); [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>|].<br/>
<span class="tactic">destruct</span> <span class="id">Hexp</span> <span class="kwd">as</span> (<span class="id">_</span>,(<span class="id">Hexp2</span>,(<span class="id">Hexp3</span>,<span class="id">Hexp4</span>))).<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_gt_cases">Z.le_gt_cases</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>) (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))) <span class="kwd">as</span> [<span class="id">Hle</span>|<span class="id">Hgt</span>].<br/>
- <span class="comment">(*&nbsp;mag&nbsp;y&nbsp;&lt;=&nbsp;fexp1&nbsp;(mag&nbsp;x)&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Lxy</span> : <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> + <span class="id">y</span>) = <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> :&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>);<br/>
&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag_plus_separated">mag_plus_separated</a></span> <span class="id">fexp1</span>)|].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_aux0_aux">round_round_plus_aux0_aux</a></span> <span class="id">fexp1</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[| |<span class="tactic">assumption</span>|<span class="tactic">assumption</span>]; <span class="tactic">rewrite</span> <span class="id">Lxy</span>.<br/>
&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">apply</span> <span class="id">Hexp4</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">apply</span> <span class="id">Hexp3</span>; <span class="tactic">omega</span>.<br/>
- <span class="comment">(*&nbsp;fexp1&nbsp;(mag&nbsp;x)&nbsp;&lt;&nbsp;mag&nbsp;y&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_aux0_aux">round_round_plus_aux0_aux</a></span> <span class="id">fexp1</span>); [| |<span class="tactic">assumption</span>|<span class="tactic">assumption</span>].<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag_plus_disj">mag_plus_disj</a></span> <span class="id">x</span> <span class="id">y</span> <span class="id">Py</span> <span class="id">Hyx</span>) <span class="kwd">as</span> [<span class="id">Lxy</span>|<span class="id">Lxy</span>]; <span class="tactic">rewrite</span> <span class="id">Lxy</span>.<br/>
&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">apply</span> <span class="id">Hexp4</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">Hexp2</span>; <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#mag_le">mag_le</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">y</span> <span class="id">x</span> <span class="id">Py</span>) <span class="kwd">in</span> <span class="id">Hyx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">_</span> - <span class="id">_</span>)%<span class="id">Z</span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag_plus_disj">mag_plus_disj</a></span> <span class="id">x</span> <span class="id">y</span> <span class="id">Py</span> <span class="id">Hyx</span>) <span class="kwd">as</span> [<span class="id">Lxy</span>|<span class="id">Lxy</span>]; <span class="tactic">rewrite</span> <span class="id">Lxy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">now</span> <span class="tactic">apply</span> <span class="id">Hexp3</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id">Hexp2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">_</span> - <span class="id">_</span>)%<span class="id">Z</span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_plus_radix_ge_3_aux1">round_round_plus_radix_ge_3_aux1</a></span> :<br/>
&nbsp;&nbsp;(3 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">choice1</span> <span class="id">choice2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_radix_ge_3_hyp">round_round_plus_radix_ge_3_hyp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt; 0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) - 1)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> + <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6288')">Proof.</div>
<div class="proofscript" id="proof6288">
<span class="tactic">intros</span> <span class="id">Hbeta</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Vfexp1</span> <span class="id">Vfexp2</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Hexp</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Px</span> <span class="id">Py</span> <span class="id">Hly</span> <span class="id">Fx</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Lxy</span> : <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> + <span class="id">y</span>) = <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> :&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>);<br/>
&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag_plus_separated">mag_plus_separated</a></span> <span class="id">fexp1</span>); [|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>| |<span class="tactic">omega</span>]|].<br/>
<span class="tactic">destruct</span> <span class="id">Hexp</span> <span class="kwd">as</span> (<span class="id">_</span>,(<span class="id">_</span>,(<span class="id">_</span>,<span class="id">Hexp4</span>))).<br/>
<span class="tactic">assert</span> (<span class="id">Hf2</span> : (<span class="id">fexp2</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) &lt;= <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))%<span class="id">Z</span>);<br/>
&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id">Hexp4</span>; <span class="tactic">omega</span>|].<br/>
<span class="tactic">assert</span> (<span class="id">Bpow3</span> : <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- 1) &lt;= / 3).<br/>
{ <span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow">Raux.bpow</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pow_pos">Z.pow_pos</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zmult_1_r">Zmult_1_r</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rinv_le">Rinv_le</a></span>; [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#IZR_le">IZR_le</a></span>. }<br/>
<span class="tactic">assert</span> (<span class="id">P1</span> : (0 &lt; 1)%<span class="id">Z</span>) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_lt_mid">round_round_lt_mid</a></span>.<br/>
- <span class="tactic">exact</span> <span class="id">Vfexp1</span>.<br/>
- <span class="tactic">exact</span> <span class="id">Vfexp2</span>.<br/>
- <span class="id">lra</span>.<br/>
- <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">Lxy</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id">Lxy</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)%<span class="id">Z</span>; [|<span class="tactic">omega</span>].<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#mag_generic_gt">mag_generic_gt</a></span>; [|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>|].<br/>
- <span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#midp">midp</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_reg_r">Rplus_lt_reg_r</a></span> (- <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> (<span class="id">x</span> + <span class="id">y</span>))).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj2">proj2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_aux1_aux">round_round_plus_aux1_aux</a></span> 1 <span class="id">P1</span> <span class="id">fexp1</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Px</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Py</span> <span class="id">Hly</span> <span class="id">Lxy</span> <span class="id">Fx</span>))).<br/>
&nbsp;&nbsp;<span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp_neq_0">ulp_neq_0</a></span>;[<span class="id">idtac</span>|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_0_compat">Rplus_lt_0_compat</a></span>].<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="tactic">rewrite</span> <span class="id">Lxy</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_reg_r">Rmult_le_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;<span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Bpow3</span>); <span class="id">lra</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp_neq_0">ulp_neq_0</a></span>;[<span class="id">idtac</span>|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_0_compat">Rplus_lt_0_compat</a></span>].<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span>, <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="tactic">simpl</span>; <span class="tactic">rewrite</span> <span class="id">Lxy</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">Hf2</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#midp">midp</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_reg_r">Rplus_lt_reg_r</a></span> (- <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> (<span class="id">x</span> + <span class="id">y</span>))); <span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_minus_distr_l">Rmult_minus_distr_l</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj2">proj2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_aux1_aux">round_round_plus_aux1_aux</a></span> 1 <span class="id">P1</span> <span class="id">fexp1</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Px</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Py</span> <span class="id">Hly</span> <span class="id">Lxy</span> <span class="id">Fx</span>))).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp_neq_0">ulp_neq_0</a></span>;[<span class="id">idtac</span>|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_0_compat">Rplus_lt_0_compat</a></span>].<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="tactic">rewrite</span> <span class="id">Lxy</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_reg_r">Rmult_le_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span> (/ 2)).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rmult_minus_distr_r">Rmult_minus_distr_r</a></span>.<br/>
&nbsp;&nbsp;<span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Bpow3</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (/ 2 * (2 / 3)); [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_l">Rmult_le_compat_l</a></span>; [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_reg_r">Rplus_le_reg_r</a></span> (- 1)); <span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">_</span> - <span class="id">_</span>) <span class="kwd">with</span> (- (/ 3)) <span class="tactic">by</span> <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_le_contravar">Ropp_le_contravar</a></span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- 1)); [<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_le">bpow_le</a></span>; <span class="tactic">omega</span>|].<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_plus_radix_ge_3_aux2">round_round_plus_radix_ge_3_aux2</a></span> :<br/>
&nbsp;&nbsp;(3 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">choice1</span> <span class="id">choice2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_radix_ge_3_hyp">round_round_plus_radix_ge_3_hyp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> + <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6289')">Proof.</div>
<div class="proofscript" id="proof6289">
<span class="tactic">intros</span> <span class="id">Hbeta</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Vfexp1</span> <span class="id">Vfexp2</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Hexp</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Py</span> <span class="id">Hyx</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Px</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> 0 <span class="id">y</span> <span class="id">x</span> <span class="id">Py</span> <span class="id">Hyx</span>).<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zle_or_lt">Zle_or_lt</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>) (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) - 1)) <span class="kwd">as</span> [<span class="id">Hly</span>|<span class="id">Hly</span>].<br/>
- <span class="comment">(*&nbsp;mag&nbsp;y&nbsp;&lt;=&nbsp;fexp1&nbsp;(mag&nbsp;x)&nbsp;-&nbsp;1&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_radix_ge_3_aux1">round_round_plus_radix_ge_3_aux1</a></span>.<br/>
- <span class="comment">(*&nbsp;fexp1&nbsp;(mag&nbsp;x)&nbsp;-&nbsp;1&nbsp;&lt;&nbsp;mag&nbsp;y&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_generic">round_generic</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span>).<br/>
&nbsp;&nbsp;+ <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_rnd_N">valid_rnd_N</a></span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">assert</span> (<span class="id">Hf1</span> : (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>)%<span class="id">Z</span>); [<span class="tactic">omega</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_radix_ge_3_aux0">round_round_plus_radix_ge_3_aux0</a></span> <span class="id">fexp1</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_plus_radix_ge_3_aux">round_round_plus_radix_ge_3_aux</a></span> :<br/>
&nbsp;&nbsp;(3 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">choice1</span> <span class="id">choice2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_radix_ge_3_hyp">round_round_plus_radix_ge_3_hyp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;0 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt; 0 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> + <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6290')">Proof.</div>
<div class="proofscript" id="proof6290">
<span class="tactic">intros</span> <span class="id">Hbeta</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Vfexp1</span> <span class="id">Vfexp2</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Hexp</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Nnx</span> <span class="id">Nny</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_dec">Req_dec</a></span> <span class="id">x</span> 0) <span class="kwd">as</span> [<span class="id">Zx</span>|<span class="id">Nzx</span>].<br/>
- <span class="comment">(*&nbsp;x&nbsp;=&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hexp</span> <span class="kwd">as</span> (<span class="id">_</span>,(<span class="id">_</span>,(<span class="id">_</span>,<span class="id">Hexp4</span>))).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Zx</span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_0_l">Rplus_0_l</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_generic">round_generic</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span>).<br/>
&nbsp;&nbsp;+ <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_rnd_N">valid_rnd_N</a></span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_inclusion_mag">generic_inclusion_mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">intros</span> <span class="id">_</span>; <span class="tactic">apply</span> <span class="id">Hexp4</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exact</span> <span class="id">Fy</span>.<br/>
- <span class="comment">(*&nbsp;x&nbsp;&lt;&gt;&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_dec">Req_dec</a></span> <span class="id">y</span> 0) <span class="kwd">as</span> [<span class="id">Zy</span>|<span class="id">Nzy</span>].<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;y&nbsp;=&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hexp</span> <span class="kwd">as</span> (<span class="id">_</span>,(<span class="id">_</span>,(<span class="id">_</span>,<span class="id">Hexp4</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Zy</span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_0_r">Rplus_0_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_generic">round_generic</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_rnd_N">valid_rnd_N</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_inclusion_mag">generic_inclusion_mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">intros</span> <span class="id">_</span>; <span class="tactic">apply</span> <span class="id">Hexp4</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exact</span> <span class="id">Fx</span>.<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;y&nbsp;&lt;&gt;&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Px</span> : 0 &lt; <span class="id">x</span>); [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Py</span> : 0 &lt; <span class="id">y</span>); [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_or_le">Rlt_or_le</a></span> <span class="id">x</span> <span class="id">y</span>) <span class="kwd">as</span> [<span class="id">H</span>|<span class="id">H</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="comment">(*&nbsp;x&nbsp;&lt;&nbsp;y&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_comm">Rplus_comm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_radix_ge_3_aux2">round_round_plus_radix_ge_3_aux2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_radix_ge_3_aux2">round_round_plus_radix_ge_3_aux2</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_minus_radix_ge_3_aux0">round_round_minus_radix_ge_3_aux0</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_radix_ge_3_hyp">round_round_plus_radix_ge_3_hyp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6291')">Proof.</div>
<div class="proofscript" id="proof6291">
<span class="tactic">intros</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Hexp</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Py</span> <span class="id">Hyx</span> <span class="id">Hln</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Px</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rlt_trans">Rlt_trans</a></span> 0 <span class="id">y</span> <span class="id">x</span> <span class="id">Py</span> <span class="id">Hyx</span>).<br/>
<span class="tactic">destruct</span> <span class="id">Hexp</span> <span class="kwd">as</span> (<span class="id">Hexp1</span>,(<span class="id">_</span>,(<span class="id">Hexp3</span>,<span class="id">Hexp4</span>))).<br/>
<span class="tactic">assert</span> (<span class="id">Lyx</span> : (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)%<span class="id">Z</span>);<br/>
&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#mag_le">mag_le</a></span>; [|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>]|].<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.lt_ge_cases">Z.lt_ge_cases</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> - 2) (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>)) <span class="kwd">as</span> [<span class="id">Hlt</span>|<span class="id">Hge</span>].<br/>
- <span class="comment">(*&nbsp;mag&nbsp;x&nbsp;-&nbsp;2&nbsp;&lt;&nbsp;mag&nbsp;y&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hor</span> : (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span> = <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> :&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/ (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span> = <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> - 1 :&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>)%<span class="id">Z</span>); [<span class="tactic">omega</span>|].<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hor</span> <span class="kwd">as</span> [<span class="id">Heq</span>|<span class="id">Heqm1</span>].<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;mag&nbsp;y&nbsp;=&nbsp;mag&nbsp;x&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_minus_aux0_aux">round_round_minus_aux0_aux</a></span> <span class="id">fexp1</span>); [| |<span class="tactic">exact</span> <span class="id">Fx</span>|<span class="tactic">exact</span> <span class="id">Fy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id">Hexp4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_trans">Z.le_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> - <span class="id">y</span>)); [<span class="tactic">omega</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#mag_minus">mag_minus</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hexp4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_trans">Z.le_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> - <span class="id">y</span>)); [<span class="tactic">omega</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#mag_minus">mag_minus</a></span>.<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;mag&nbsp;y&nbsp;=&nbsp;mag&nbsp;x&nbsp;-&nbsp;1&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_minus_aux0_aux">round_round_minus_aux0_aux</a></span> <span class="id">fexp1</span>); [| |<span class="tactic">exact</span> <span class="id">Fx</span>|<span class="tactic">exact</span> <span class="id">Fy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id">Hexp4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_trans">Z.le_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> - <span class="id">y</span>)); [<span class="tactic">omega</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#mag_minus">mag_minus</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> <span class="id">Heqm1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hexp4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zplus_le_compat_r">Zplus_le_compat_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#mag_minus">mag_minus</a></span>.<br/>
- <span class="comment">(*&nbsp;mag&nbsp;y&nbsp;&lt;=&nbsp;mag&nbsp;x&nbsp;-&nbsp;2&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag_minus_disj">mag_minus_disj</a></span> <span class="id">x</span> <span class="id">y</span> <span class="id">Px</span> <span class="id">Py</span> <span class="id">Hge</span>) <span class="kwd">as</span> [<span class="id">Lxmy</span>|<span class="id">Lxmy</span>].<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;mag&nbsp;(x&nbsp;-&nbsp;y)&nbsp;=&nbsp;mag&nbsp;x&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_minus_aux0_aux">round_round_minus_aux0_aux</a></span> <span class="id">fexp1</span>); [| |<span class="tactic">exact</span> <span class="id">Fx</span>|<span class="tactic">exact</span> <span class="id">Fy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id">Hexp4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">Lxmy</span>; <span class="tactic">apply</span> <span class="id">Hexp3</span>.<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;mag&nbsp;(x&nbsp;-&nbsp;y)&nbsp;=&nbsp;mag&nbsp;x&nbsp;-&nbsp;1&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_minus_aux0_aux">round_round_minus_aux0_aux</a></span> <span class="id">fexp1</span>); [| |<span class="tactic">exact</span> <span class="id">Fx</span>|<span class="tactic">exact</span> <span class="id">Fy</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Lxmy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id">Hexp1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">_</span> + <span class="id">_</span>)%<span class="id">Z</span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>); [|<span class="tactic">ring</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_trans">Z.le_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id">Hexp1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">replace</span> (<span class="id">_</span> + <span class="id">_</span>)%<span class="id">Z</span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>); [|<span class="tactic">ring</span>].<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_minus_radix_ge_3_aux1">round_round_minus_radix_ge_3_aux1</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_radix_ge_3_hyp">round_round_plus_radix_ge_3_hyp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) - 1)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>)) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6292')">Proof.</div>
<div class="proofscript" id="proof6292">
<span class="tactic">intros</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Vfexp1</span> <span class="id">Vfexp2</span>  <span class="id">Hexp</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Py</span> <span class="id">Hyx</span> <span class="id">Hln</span> <span class="id">Hln</span>' <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Px</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rlt_trans">Rlt_trans</a></span> 0 <span class="id">y</span> <span class="id">x</span> <span class="id">Py</span> <span class="id">Hyx</span>).<br/>
<span class="tactic">destruct</span> <span class="id">Hexp</span> <span class="kwd">as</span> (<span class="id">Hexp1</span>,(<span class="id">Hexp2</span>,(<span class="id">Hexp3</span>,<span class="id">Hexp4</span>))).<br/>
<span class="tactic">assert</span> (<span class="id">Lyx</span> : (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)%<span class="id">Z</span>);<br/>
&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#mag_le">mag_le</a></span>; [|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>]|].<br/>
<span class="tactic">assert</span> (<span class="id">Hfx</span> : (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)%<span class="id">Z</span>);<br/>
&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#mag_generic_gt">mag_generic_gt</a></span>; [|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>|]|].<br/>
<span class="tactic">assert</span> (<span class="id">Hfy</span> : (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>) &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>)%<span class="id">Z</span>);<br/>
&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#mag_generic_gt">mag_generic_gt</a></span>; [|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>|]|].<br/>
<span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_minus_aux0_aux">round_round_minus_aux0_aux</a></span> <span class="id">fexp1</span>); [| |<span class="tactic">exact</span> <span class="id">Fx</span>|<span class="tactic">exact</span> <span class="id">Fy</span>].<br/>
- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_trans">Z.le_trans</a></span> <span class="kwd">with</span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> - <span class="id">y</span>))).<br/>
&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">Hexp4</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">omega</span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id">Hexp3</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_minus_radix_ge_3_aux2">round_round_minus_radix_ge_3_aux2</a></span> :<br/>
&nbsp;&nbsp;(3 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">choice1</span> <span class="id">choice2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_radix_ge_3_hyp">round_round_plus_radix_ge_3_hyp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) - 1)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>)) - 1)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6293')">Proof.</div>
<div class="proofscript" id="proof6293">
<span class="tactic">intros</span> <span class="id">Hbeta</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Vfexp1</span> <span class="id">Vfexp2</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Hexp</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Py</span> <span class="id">Hxy</span> <span class="id">Hly</span> <span class="id">Hly</span>' <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Px</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rlt_trans">Rlt_trans</a></span> 0 <span class="id">y</span> <span class="id">x</span> <span class="id">Py</span> <span class="id">Hxy</span>).<br/>
<span class="tactic">destruct</span> <span class="id">Hexp</span> <span class="kwd">as</span> (<span class="id">_</span>,(<span class="id">_</span>,(<span class="id">_</span>,<span class="id">Hexp4</span>))).<br/>
<span class="tactic">assert</span> (<span class="id">Hf2</span> : (<span class="id">fexp2</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) &lt;= <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))%<span class="id">Z</span>);<br/>
&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id">Hexp4</span>; <span class="tactic">omega</span>|].<br/>
<span class="tactic">assert</span> (<span class="id">Hfx</span> : (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)%<span class="id">Z</span>);<br/>
&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#mag_generic_gt">mag_generic_gt</a></span>; [|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>|]|].<br/>
<span class="tactic">assert</span> (<span class="id">Bpow3</span> : <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- 1) &lt;= / 3).<br/>
{ <span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow">Raux.bpow</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pow_pos">Z.pow_pos</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zmult_1_r">Zmult_1_r</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rinv_le">Rinv_le</a></span>; [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#IZR_le">IZR_le</a></span>. }<br/>
<span class="tactic">assert</span> (<span class="id">Ly</span> : <span class="id">y</span> &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>)).<br/>
{ <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rabs_lt_inv">Rabs_lt_inv</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_mag_gt">bpow_mag_gt</a></span>. }<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_gt_mid">round_round_gt_mid</a></span>.<br/>
- <span class="tactic">exact</span> <span class="id">Vfexp1</span>.<br/>
- <span class="tactic">exact</span> <span class="id">Vfexp2</span>.<br/>
- <span class="id">lra</span>.<br/>
- <span class="tactic">apply</span> <span class="id">Hexp4</span>; <span class="tactic">omega</span>.<br/>
- <span class="tactic">assert</span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> - <span class="id">y</span>)) &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> - <span class="id">y</span>))%<span class="id">Z</span>; [|<span class="tactic">omega</span>].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_exp_large">valid_exp_large</a></span> <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> - 1)).<br/>
&nbsp;&nbsp;+ <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_exp_large">valid_exp_large</a></span> <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>)); [|<span class="tactic">omega</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#mag_generic_gt">mag_generic_gt</a></span>; [|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>|].<br/>
&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#mag_minus_lb">mag_minus_lb</a></span>; [| |<span class="tactic">omega</span>].<br/>
- <span class="tactic">unfold</span> <span class="id">midp</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_reg_r">Rplus_lt_reg_r</a></span> (/ 2 * <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> (<span class="id">x</span> - <span class="id">y</span>) - (<span class="id">x</span> - <span class="id">y</span>))).<br/>
&nbsp;&nbsp;<span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">_</span> + <span class="id">_</span>) <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zceil">Zceil</a></span> (<span class="id">x</span> - <span class="id">y</span>) - (<span class="id">x</span> - <span class="id">y</span>)) <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> - <span class="id">y</span>)) - 1)).<br/>
&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> <span class="id">y</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_minus_aux2_aux">round_round_minus_aux2_aux</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Ly</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_le">bpow_le</a></span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp_neq_0">ulp_neq_0</a></span>;[<span class="id">idtac</span>|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_minus">Rgt_minus</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.sub">Zminus</a></span> <span class="tactic">at</span> 1; <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_plus">bpow_plus</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_r">Rmult_le_compat_r</a></span>; [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_ge_0">bpow_ge_0</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow">Raux.bpow</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pow_pos">Z.pow_pos</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zmult_1_r">Zmult_1_r</a></span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rinv_le">Rinv_le</a></span>; [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#IZR_le">IZR_le</a></span>; <span class="tactic">omega</span>.<br/>
- <span class="tactic">intro</span> <span class="id">Hf2</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">midp</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_reg_r">Rplus_lt_reg_r</a></span> (/ 2 * (<span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> (<span class="id">x</span> - <span class="id">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span> (<span class="id">x</span> - <span class="id">y</span>)) - (<span class="id">x</span> - <span class="id">y</span>))).<br/>
&nbsp;&nbsp;<span class="id">ring_simplify</span>; <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_minus_distr_l">Rmult_minus_distr_l</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">_</span> + <span class="id">_</span>) <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zceil">Zceil</a></span> (<span class="id">x</span> - <span class="id">y</span>) - (<span class="id">x</span> - <span class="id">y</span>)) <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> <span class="id">y</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_minus_aux2_aux">round_round_minus_aux2_aux</a></span>|].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Ly</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> - <span class="id">y</span>)) - 1));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_le">bpow_le</a></span>|].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> 2!<span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp_neq_0">ulp_neq_0</a></span>; <span class="tactic">try</span> <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_minus">Rgt_minus</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_reg_r">Rmult_le_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> - <span class="id">y</span>)))));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rmult_minus_distr_r">Rmult_minus_distr_r</a></span>.<br/>
&nbsp;&nbsp;<span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (/ 3).<br/>
&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow">Raux.bpow</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pow_pos">Z.pow_pos</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zmult_1_r">Zmult_1_r</a></span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rinv_le">Rinv_le</a></span>; [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#IZR_le">IZR_le</a></span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">replace</span> (/ 3) <span class="kwd">with</span> (/ 2 * (2 / 3)) <span class="tactic">by</span> <span class="id">field</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_l">Rmult_le_compat_l</a></span>; [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_reg_r">Rplus_le_reg_r</a></span> (- 1)); <span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">_</span> - <span class="id">_</span>) <span class="kwd">with</span> (- / 3) <span class="tactic">by</span> <span class="id">field</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_le_contravar">Ropp_le_contravar</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- 1)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_le">bpow_le</a></span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow">Raux.bpow</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pow_pos">Z.pow_pos</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zmult_1_r">Zmult_1_r</a></span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rinv_le">Rinv_le</a></span>; [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#IZR_le">IZR_le</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_minus_radix_ge_3_aux3">round_round_minus_radix_ge_3_aux3</a></span> :<br/>
&nbsp;&nbsp;(3 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">choice1</span> <span class="id">choice2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_radix_ge_3_hyp">round_round_plus_radix_ge_3_hyp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6294')">Proof.</div>
<div class="proofscript" id="proof6294">
<span class="tactic">intros</span> <span class="id">Hbeta</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Vfexp1</span> <span class="id">Vfexp2</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Hexp</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Py</span> <span class="id">Hyx</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Px</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> 0 <span class="id">y</span> <span class="id">x</span> <span class="id">Py</span> <span class="id">Hyx</span>).<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_dec">Req_dec</a></span> <span class="id">y</span> <span class="id">x</span>) <span class="kwd">as</span> [<span class="id">Hy</span>|<span class="id">Hy</span>].<br/>
- <span class="comment">(*&nbsp;y&nbsp;=&nbsp;x&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hy</span>; <span class="tactic">replace</span> (<span class="id">x</span> - <span class="id">x</span>) <span class="kwd">with</span> 0 <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_0">round_0</a></span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_rnd_N">valid_rnd_N</a></span>.<br/>
- <span class="comment">(*&nbsp;y&nbsp;&lt;&nbsp;x&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hyx</span>' : <span class="id">y</span> &lt; <span class="id">x</span>); [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zle_or_lt">Zle_or_lt</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>) (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) - 1)) <span class="kwd">as</span> [<span class="id">Hly</span>|<span class="id">Hly</span>].<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;mag&nbsp;y&nbsp;&lt;=&nbsp;fexp1&nbsp;(mag&nbsp;x)&nbsp;-&nbsp;1&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zle_or_lt">Zle_or_lt</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>) (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> - <span class="id">y</span>)) - 1))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">as</span> [<span class="id">Hly</span>'|<span class="id">Hly</span>'].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="comment">(*&nbsp;mag&nbsp;y&nbsp;&lt;=&nbsp;fexp1&nbsp;(mag&nbsp;(x&nbsp;-&nbsp;y))&nbsp;-&nbsp;1&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_minus_radix_ge_3_aux2">round_round_minus_radix_ge_3_aux2</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="comment">(*&nbsp;fexp1&nbsp;(mag&nbsp;(x&nbsp;-&nbsp;y))&nbsp;-&nbsp;1&nbsp;&lt;&nbsp;mag&nbsp;y&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">rewrite</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_generic">round_generic</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_rnd_N">valid_rnd_N</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">assert</span> (<span class="id">Hf1</span> : (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> - <span class="id">y</span>)) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>)%<span class="id">Z</span>); [<span class="tactic">omega</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_minus_radix_ge_3_aux1">round_round_minus_radix_ge_3_aux1</a></span> <span class="id">fexp1</span>). }<br/>
&nbsp;&nbsp;+ <span class="tactic">rewrite</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_generic">round_generic</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_rnd_N">valid_rnd_N</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">assert</span> (<span class="id">Hf1</span> : (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>)%<span class="id">Z</span>); [<span class="tactic">omega</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_minus_radix_ge_3_aux0">round_round_minus_radix_ge_3_aux0</a></span> <span class="id">fexp1</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_minus_radix_ge_3_aux">round_round_minus_radix_ge_3_aux</a></span> :<br/>
&nbsp;&nbsp;(3 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">choice1</span> <span class="id">choice2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_radix_ge_3_hyp">round_round_plus_radix_ge_3_hyp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;0 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt; 0 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6295')">Proof.</div>
<div class="proofscript" id="proof6295">
<span class="tactic">intros</span> <span class="id">Hbeta</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Vfexp1</span> <span class="id">Vfexp2</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Hexp</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Nnx</span> <span class="id">Nny</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_dec">Req_dec</a></span> <span class="id">x</span> 0) <span class="kwd">as</span> [<span class="id">Zx</span>|<span class="id">Nzx</span>].<br/>
- <span class="comment">(*&nbsp;x&nbsp;=&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Zx</span>; <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rminus">Rminus</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_0_l">Rplus_0_l</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">do</span> 3 <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_N_opp">round_N_opp</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_generic">round_generic</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span>).<br/>
&nbsp;&nbsp;* <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;* <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_rnd_N">valid_rnd_N</a></span>.<br/>
&nbsp;&nbsp;* <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_inclusion_mag">generic_inclusion_mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hexp</span> <span class="kwd">as</span> (<span class="id">_</span>,(<span class="id">_</span>,(<span class="id">_</span>,<span class="id">Hexp4</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">intros</span> <span class="id">_</span>; <span class="tactic">apply</span> <span class="id">Hexp4</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exact</span> <span class="id">Fy</span>.<br/>
- <span class="comment">(*&nbsp;x&nbsp;&lt;&gt;&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_dec">Req_dec</a></span> <span class="id">y</span> 0) <span class="kwd">as</span> [<span class="id">Zy</span>|<span class="id">Nzy</span>].<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;y&nbsp;=&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Zy</span>; <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rminus">Rminus</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_0">Ropp_0</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_0_r">Rplus_0_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_generic">round_generic</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_rnd_N">valid_rnd_N</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_inclusion_mag">generic_inclusion_mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hexp</span> <span class="kwd">as</span> (<span class="id">_</span>,(<span class="id">_</span>,(<span class="id">_</span>,<span class="id">Hexp4</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">intros</span> <span class="id">_</span>; <span class="tactic">apply</span> <span class="id">Hexp4</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exact</span> <span class="id">Fx</span>.<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;y&nbsp;&lt;&gt;&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Px</span> : 0 &lt; <span class="id">x</span>); [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Py</span> : 0 &lt; <span class="id">y</span>); [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_or_le">Rlt_or_le</a></span> <span class="id">x</span> <span class="id">y</span>) <span class="kwd">as</span> [<span class="id">H</span>|<span class="id">H</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="comment">(*&nbsp;x&nbsp;&lt;&nbsp;y&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">x</span> - <span class="id">y</span>) <span class="kwd">with</span> (- (<span class="id">y</span> - <span class="id">x</span>)) <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 3 <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_N_opp">round_N_opp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_eq_compat">Ropp_eq_compat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_minus_radix_ge_3_aux3">round_round_minus_radix_ge_3_aux3</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="comment">(*&nbsp;y&nbsp;&lt;=&nbsp;x&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_minus_radix_ge_3_aux3">round_round_minus_radix_ge_3_aux3</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_plus_radix_ge_3">round_round_plus_radix_ge_3</a></span> :<br/>
&nbsp;&nbsp;(3 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">choice1</span> <span class="id">choice2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_radix_ge_3_hyp">round_round_plus_radix_ge_3_hyp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> + <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6296')">Proof.</div>
<div class="proofscript" id="proof6296">
<span class="tactic">intros</span> <span class="id">Hbeta</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Vfexp1</span> <span class="id">Vfexp2</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Hexp</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_or_le">Rlt_or_le</a></span> <span class="id">x</span> 0) <span class="kwd">as</span> [<span class="id">Sx</span>|<span class="id">Sx</span>]; <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_or_le">Rlt_or_le</a></span> <span class="id">y</span> 0) <span class="kwd">as</span> [<span class="id">Sy</span>|<span class="id">Sy</span>].<br/>
- <span class="comment">(*&nbsp;x&nbsp;&lt;&nbsp;0,&nbsp;y&nbsp;&lt;&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">x</span> + <span class="id">y</span>) <span class="kwd">with</span> (- (- <span class="id">x</span> - <span class="id">y</span>)); [|<span class="tactic">ring</span>].<br/>
&nbsp;&nbsp;<span class="tactic">do</span> 3 <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_N_opp">round_N_opp</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_eq_compat">Ropp_eq_compat</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Px</span> : 0 &lt;= - <span class="id">x</span>); [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Py</span> : 0 &lt;= - <span class="id">y</span>); [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format_opp">generic_format_opp</a></span> <span class="kwd">in</span> <span class="id">Fx</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format_opp">generic_format_opp</a></span> <span class="kwd">in</span> <span class="id">Fy</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_radix_ge_3_aux">round_round_plus_radix_ge_3_aux</a></span>.<br/>
- <span class="comment">(*&nbsp;x&nbsp;&lt;&nbsp;0,&nbsp;0&nbsp;&lt;=&nbsp;y&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">x</span> + <span class="id">y</span>) <span class="kwd">with</span> (<span class="id">y</span> - (- <span class="id">x</span>)); [|<span class="tactic">ring</span>].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Px</span> : 0 &lt;= - <span class="id">x</span>); [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format_opp">generic_format_opp</a></span> <span class="kwd">in</span> <span class="id">Fx</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_minus_radix_ge_3_aux">round_round_minus_radix_ge_3_aux</a></span>.<br/>
- <span class="comment">(*&nbsp;0&nbsp;&lt;=&nbsp;x,&nbsp;y&nbsp;&lt;&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">x</span> + <span class="id">y</span>) <span class="kwd">with</span> (<span class="id">x</span> - (- <span class="id">y</span>)); [|<span class="tactic">ring</span>].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Py</span> : 0 &lt;= - <span class="id">y</span>); [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format_opp">generic_format_opp</a></span> <span class="kwd">in</span> <span class="id">Fy</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_minus_radix_ge_3_aux">round_round_minus_radix_ge_3_aux</a></span>.<br/>
- <span class="comment">(*&nbsp;0&nbsp;&lt;=&nbsp;x,&nbsp;0&nbsp;&lt;=&nbsp;y&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_radix_ge_3_aux">round_round_plus_radix_ge_3_aux</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_minus_radix_ge_3">round_round_minus_radix_ge_3</a></span> :<br/>
&nbsp;&nbsp;(3 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">choice1</span> <span class="id">choice2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_radix_ge_3_hyp">round_round_plus_radix_ge_3_hyp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6297')">Proof.</div>
<div class="proofscript" id="proof6297">
<span class="tactic">intros</span> <span class="id">Hbeta</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Vfexp1</span> <span class="id">Vfexp2</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Hexp</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rminus">Rminus</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format_opp">generic_format_opp</a></span> <span class="kwd">in</span> <span class="id">Fy</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_radix_ge_3">round_round_plus_radix_ge_3</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLX">Double_round_plus_radix_ge_3_FLX</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLX.prec">prec</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id">prec</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<br/>
<span class="kwd">Context</span> { <span class="id">prec_gt_0_</span> : <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLX.prec">prec</a></span> }.<br/>
<span class="kwd">Context</span> { <span class="id">prec_gt_0_</span>' : <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="id">prec</span>' }.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="FLX_round_round_plus_radix_ge_3_hyp">FLX_round_round_plus_radix_ge_3_hyp</a></span> :<br/>
&nbsp;&nbsp;(2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLX.prec">prec</a></span> &lt;= <span class="id">prec</span>')%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_radix_ge_3_hyp">round_round_plus_radix_ge_3_hyp</a></span> (<span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp">FLX_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLX.prec">prec</a></span>) (<span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp">FLX_exp</a></span> <span class="id">prec</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6298')">Proof.</div>
<div class="proofscript" id="proof6298">
<span class="tactic">intros</span> <span class="id">Hprec</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp">FLX_exp</a></span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_radix_ge_3_hyp">round_round_plus_radix_ge_3_hyp</a></span>; <span class="tactic">split</span>; [|<span class="tactic">split</span>; [|<span class="tactic">split</span>]];<br/>
<span class="tactic">intros</span> <span class="id">ex</span> <span class="id">ey</span>; <span class="tactic">try</span> <span class="tactic">omega</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="kwd">in</span> <span class="id">prec_gt_0_</span>.<br/>
<span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="round_round_plus_radix_ge_3_FLX">round_round_plus_radix_ge_3_FLX</a></span> :<br/>
&nbsp;&nbsp;(3 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">choice1</span> <span class="id">choice2</span>,<br/>
&nbsp;&nbsp;(2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLX.prec">prec</a></span> &lt;= <span class="id">prec</span>')%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_format">FLX_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLX.prec">prec</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_format">FLX_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLX.prec">prec</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> (<span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp">FLX_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLX.prec">prec</a></span>) (<span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp">FLX_exp</a></span> <span class="id">prec</span>') <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> + <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6299')">Proof.</div>
<div class="proofscript" id="proof6299">
<span class="tactic">intros</span> <span class="id">Hbeta</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Hprec</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_radix_ge_3">round_round_plus_radix_ge_3</a></span>.<br/>
- <span class="tactic">exact</span> <span class="id">Hbeta</span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp_valid">FLX_exp_valid</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp_valid">FLX_exp_valid</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#FLX_round_round_plus_radix_ge_3_hyp">FLX_round_round_plus_radix_ge_3_hyp</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#generic_format_FLX">generic_format_FLX</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#generic_format_FLX">generic_format_FLX</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="round_round_minus_radix_ge_3_FLX">round_round_minus_radix_ge_3_FLX</a></span> :<br/>
&nbsp;&nbsp;(3 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">choice1</span> <span class="id">choice2</span>,<br/>
&nbsp;&nbsp;(2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLX.prec">prec</a></span> &lt;= <span class="id">prec</span>')%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_format">FLX_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLX.prec">prec</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_format">FLX_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLX.prec">prec</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> (<span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp">FLX_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLX.prec">prec</a></span>) (<span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp">FLX_exp</a></span> <span class="id">prec</span>') <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6300')">Proof.</div>
<div class="proofscript" id="proof6300">
<span class="tactic">intros</span> <span class="id">Hbeta</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Hprec</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_minus_radix_ge_3">round_round_minus_radix_ge_3</a></span>.<br/>
- <span class="tactic">exact</span> <span class="id">Hbeta</span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp_valid">FLX_exp_valid</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp_valid">FLX_exp_valid</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#FLX_round_round_plus_radix_ge_3_hyp">FLX_round_round_plus_radix_ge_3_hyp</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#generic_format_FLX">generic_format_FLX</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#generic_format_FLX">generic_format_FLX</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLX">Double_round_plus_radix_ge_3_FLX</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLT">Double_round_plus_radix_ge_3_FLT</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLT.emin">emin</a></span> <span class="id"><a name="Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLT.prec">prec</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id">emin</span>' <span class="id">prec</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<br/>
<span class="kwd">Context</span> { <span class="id">prec_gt_0_</span> : <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLT.prec">prec</a></span> }.<br/>
<span class="kwd">Context</span> { <span class="id">prec_gt_0_</span>' : <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="id">prec</span>' }.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="FLT_round_round_plus_radix_ge_3_hyp">FLT_round_round_plus_radix_ge_3_hyp</a></span> :<br/>
&nbsp;&nbsp;(<span class="id">emin</span>' &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLT.emin">emin</a></span>)%<span class="id">Z</span> -&gt; (2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLT.prec">prec</a></span> &lt;= <span class="id">prec</span>')%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_radix_ge_3_hyp">round_round_plus_radix_ge_3_hyp</a></span> (<span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp">FLT_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLT.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLT.prec">prec</a></span>) (<span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp">FLT_exp</a></span> <span class="id">emin</span>' <span class="id">prec</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6301')">Proof.</div>
<div class="proofscript" id="proof6301">
<span class="tactic">intros</span> <span class="id">Hemin</span> <span class="id">Hprec</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp">FLT_exp</a></span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_radix_ge_3_hyp">round_round_plus_radix_ge_3_hyp</a></span>; <span class="tactic">split</span>; [|<span class="tactic">split</span>; [|<span class="tactic">split</span>]]; <span class="tactic">intros</span> <span class="id">ex</span> <span class="id">ey</span>.<br/>
- <span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ex</span> + 1 - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLT.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLT.emin">emin</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ex</span> - <span class="id">prec</span>') <span class="id">emin</span>').<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ey</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLT.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLT.emin">emin</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
- <span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ex</span> - 1 - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLT.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLT.emin">emin</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ex</span> - <span class="id">prec</span>') <span class="id">emin</span>').<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ey</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLT.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLT.emin">emin</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
- <span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ex</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLT.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLT.emin">emin</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ex</span> - <span class="id">prec</span>') <span class="id">emin</span>').<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ey</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLT.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLT.emin">emin</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
- <span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="kwd">in</span> <span class="id">prec_gt_0_</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ex</span> - <span class="id">prec</span>') <span class="id">emin</span>').<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ey</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLT.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLT.emin">emin</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="round_round_plus_radix_ge_3_FLT">round_round_plus_radix_ge_3_FLT</a></span> :<br/>
&nbsp;&nbsp;(3 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">choice1</span> <span class="id">choice2</span>,<br/>
&nbsp;&nbsp;(<span class="id">emin</span>' &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLT.emin">emin</a></span>)%<span class="id">Z</span> -&gt; (2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLT.prec">prec</a></span> &lt;= <span class="id">prec</span>')%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_format">FLT_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLT.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLT.prec">prec</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_format">FLT_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLT.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLT.prec">prec</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> (<span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp">FLT_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLT.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLT.prec">prec</a></span>) (<span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp">FLT_exp</a></span> <span class="id">emin</span>' <span class="id">prec</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> + <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6302')">Proof.</div>
<div class="proofscript" id="proof6302">
<span class="tactic">intros</span> <span class="id">Hbeta</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Hemin</span> <span class="id">Hprec</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_radix_ge_3">round_round_plus_radix_ge_3</a></span>.<br/>
- <span class="tactic">exact</span> <span class="id">Hbeta</span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp_valid">FLT_exp_valid</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp_valid">FLT_exp_valid</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#FLT_round_round_plus_radix_ge_3_hyp">FLT_round_round_plus_radix_ge_3_hyp</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLT.html#generic_format_FLT">generic_format_FLT</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLT.html#generic_format_FLT">generic_format_FLT</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="round_round_minus_radix_ge_3_FLT">round_round_minus_radix_ge_3_FLT</a></span> :<br/>
&nbsp;&nbsp;(3 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">choice1</span> <span class="id">choice2</span>,<br/>
&nbsp;&nbsp;(<span class="id">emin</span>' &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLT.emin">emin</a></span>)%<span class="id">Z</span> -&gt; (2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLT.prec">prec</a></span> &lt;= <span class="id">prec</span>')%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_format">FLT_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLT.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLT.prec">prec</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_format">FLT_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLT.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLT.prec">prec</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> (<span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp">FLT_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLT.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLT.prec">prec</a></span>) (<span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp">FLT_exp</a></span> <span class="id">emin</span>' <span class="id">prec</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6303')">Proof.</div>
<div class="proofscript" id="proof6303">
<span class="tactic">intros</span> <span class="id">Hbeta</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Hemin</span> <span class="id">Hprec</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_minus_radix_ge_3">round_round_minus_radix_ge_3</a></span>.<br/>
- <span class="tactic">exact</span> <span class="id">Hbeta</span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp_valid">FLT_exp_valid</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp_valid">FLT_exp_valid</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#FLT_round_round_plus_radix_ge_3_hyp">FLT_round_round_plus_radix_ge_3_hyp</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLT.html#generic_format_FLT">generic_format_FLT</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLT.html#generic_format_FLT">generic_format_FLT</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FLT">Double_round_plus_radix_ge_3_FLT</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FTZ">Double_round_plus_radix_ge_3_FTZ</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FTZ.emin">emin</a></span> <span class="id"><a name="Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FTZ.prec">prec</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id">emin</span>' <span class="id">prec</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<br/>
<span class="kwd">Context</span> { <span class="id">prec_gt_0_</span> : <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FTZ.prec">prec</a></span> }.<br/>
<span class="kwd">Context</span> { <span class="id">prec_gt_0_</span>' : <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="id">prec</span>' }.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="FTZ_round_round_plus_radix_ge_3_hyp">FTZ_round_round_plus_radix_ge_3_hyp</a></span> :<br/>
&nbsp;&nbsp;(<span class="id">emin</span>' + <span class="id">prec</span>' &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FTZ.emin">emin</a></span> + 1)%<span class="id">Z</span> -&gt; (2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FTZ.prec">prec</a></span> &lt;= <span class="id">prec</span>')%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_radix_ge_3_hyp">round_round_plus_radix_ge_3_hyp</a></span> (<span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp">FTZ_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FTZ.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FTZ.prec">prec</a></span>) (<span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp">FTZ_exp</a></span> <span class="id">emin</span>' <span class="id">prec</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6304')">Proof.</div>
<div class="proofscript" id="proof6304">
<span class="tactic">intros</span> <span class="id">Hemin</span> <span class="id">Hprec</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp">FTZ_exp</a></span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="kwd">in</span> *.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_radix_ge_3_hyp">round_round_plus_radix_ge_3_hyp</a></span>; <span class="tactic">split</span>; [|<span class="tactic">split</span>; [|<span class="tactic">split</span>]]; <span class="tactic">intros</span> <span class="id">ex</span> <span class="id">ey</span>.<br/>
- <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ex</span> + 1 - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FTZ.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FTZ.emin">emin</a></span>);<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ex</span> - <span class="id">prec</span>') <span class="id">emin</span>');<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ey</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FTZ.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FTZ.emin">emin</a></span>);<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
- <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ex</span> - 1 - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FTZ.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FTZ.emin">emin</a></span>);<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ex</span> - <span class="id">prec</span>') <span class="id">emin</span>');<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ey</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FTZ.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FTZ.emin">emin</a></span>);<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
- <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ex</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FTZ.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FTZ.emin">emin</a></span>);<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ex</span> - <span class="id">prec</span>') <span class="id">emin</span>');<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ey</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FTZ.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FTZ.emin">emin</a></span>);<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
- <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ex</span> - <span class="id">prec</span>') <span class="id">emin</span>');<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ey</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FTZ.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FTZ.emin">emin</a></span>);<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="round_round_plus_radix_ge_3_FTZ">round_round_plus_radix_ge_3_FTZ</a></span> :<br/>
&nbsp;&nbsp;(3 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">choice1</span> <span class="id">choice2</span>,<br/>
&nbsp;&nbsp;(<span class="id">emin</span>' + <span class="id">prec</span>' &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FTZ.emin">emin</a></span> + 1)%<span class="id">Z</span> -&gt; (2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FTZ.prec">prec</a></span> &lt;= <span class="id">prec</span>')%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_format">FTZ_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FTZ.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FTZ.prec">prec</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_format">FTZ_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FTZ.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FTZ.prec">prec</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> (<span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp">FTZ_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FTZ.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FTZ.prec">prec</a></span>) (<span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp">FTZ_exp</a></span> <span class="id">emin</span>' <span class="id">prec</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> + <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6305')">Proof.</div>
<div class="proofscript" id="proof6305">
<span class="tactic">intros</span> <span class="id">Hbeta</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Hemin</span> <span class="id">Hprec</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_plus_radix_ge_3">round_round_plus_radix_ge_3</a></span>.<br/>
- <span class="tactic">exact</span> <span class="id">Hbeta</span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp_valid">FTZ_exp_valid</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp_valid">FTZ_exp_valid</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#FTZ_round_round_plus_radix_ge_3_hyp">FTZ_round_round_plus_radix_ge_3_hyp</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FTZ.html#generic_format_FTZ">generic_format_FTZ</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FTZ.html#generic_format_FTZ">generic_format_FTZ</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="round_round_minus_radix_ge_3_FTZ">round_round_minus_radix_ge_3_FTZ</a></span> :<br/>
&nbsp;&nbsp;(3 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">choice1</span> <span class="id">choice2</span>,<br/>
&nbsp;&nbsp;(<span class="id">emin</span>' + <span class="id">prec</span>' &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FTZ.emin">emin</a></span> + 1)%<span class="id">Z</span> -&gt; (2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FTZ.prec">prec</a></span> &lt;= <span class="id">prec</span>')%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_format">FTZ_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FTZ.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FTZ.prec">prec</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_format">FTZ_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FTZ.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FTZ.prec">prec</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> (<span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp">FTZ_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FTZ.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FTZ.prec">prec</a></span>) (<span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp">FTZ_exp</a></span> <span class="id">emin</span>' <span class="id">prec</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6306')">Proof.</div>
<div class="proofscript" id="proof6306">
<span class="tactic">intros</span> <span class="id">Hbeta</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Hemin</span> <span class="id">Hprec</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_minus_radix_ge_3">round_round_minus_radix_ge_3</a></span>.<br/>
- <span class="tactic">exact</span> <span class="id">Hbeta</span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp_valid">FTZ_exp_valid</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp_valid">FTZ_exp_valid</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#FTZ_round_round_plus_radix_ge_3_hyp">FTZ_round_round_plus_radix_ge_3_hyp</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FTZ.html#generic_format_FTZ">generic_format_FTZ</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FTZ.html#generic_format_FTZ">generic_format_FTZ</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3.Double_round_plus_radix_ge_3_FTZ">Double_round_plus_radix_ge_3_FTZ</a></span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus.Double_round_plus_radix_ge_3">Double_round_plus_radix_ge_3</a></span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_plus">Double_round_plus</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_mid_cases">round_round_mid_cases</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">choice1</span> <span class="id">choice2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>),<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) - 1)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#midp">midp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) &lt;= / 2 * (<span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6307')">Proof.</div>
<div class="proofscript" id="proof6307">
<span class="tactic">intros</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Vfexp1</span> <span class="id">Vfexp2</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">x</span> <span class="id">Px</span> <span class="id">Hf2f1</span> <span class="id">Hf1</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span>, <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#midp">midp</a></span>.<br/>
<span class="tactic">set</span> (<span class="id">rd</span> := <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> <span class="id">x</span>).<br/>
<span class="tactic">set</span> (<span class="id">u1</span> := <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id">x</span>).<br/>
<span class="tactic">set</span> (<span class="id">u2</span> := <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span> <span class="id">x</span>).<br/>
<span class="tactic">intros</span> <span class="id">Cmid</span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format_EM">generic_format_EM</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id">x</span>) <span class="kwd">as</span> [<span class="id">Fx</span>|<span class="id">Nfx</span>].<br/>
- <span class="comment">(*&nbsp;generic_format&nbsp;beta&nbsp;fexp1&nbsp;x&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_generic">round_generic</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span>); [<span class="tactic">reflexivity</span>|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_rnd_N">valid_rnd_N</a></span>|].<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_inclusion_mag">generic_inclusion_mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span>); [<span class="tactic">omega</span>|].<br/>
- <span class="comment">(*&nbsp;~&nbsp;generic_format&nbsp;beta&nbsp;fexp1&nbsp;x&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hceil</span> : <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zceil">Zceil</a></span> <span class="id">x</span> = <span class="id">rd</span> + <span class="id">u1</span>);<br/>
&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Ulp.html#round_UP_DN_ulp">round_UP_DN_ulp</a></span>|].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hf2</span>' : (<span class="id">fexp2</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) &lt;= <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) - 1)%<span class="id">Z</span>); [<span class="tactic">omega</span>|].<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_or_le">Rlt_or_le</a></span> (<span class="id">x</span> - <span class="id">rd</span>) (/ 2 * (<span class="id">u1</span> - <span class="id">u2</span>))).<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;x&nbsp;-&nbsp;rd&nbsp;&lt;&nbsp;/&nbsp;2&nbsp;*&nbsp;(u1&nbsp;-&nbsp;u2)&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_lt_mid_further_place">round_round_lt_mid_further_place</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#midp">midp</a></span>. <span class="id">fold</span> <span class="id">rd</span>; <span class="id">fold</span> <span class="id">u1</span>; <span class="id">fold</span> <span class="id">u2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_reg_r">Rplus_lt_reg_r</a></span> (- <span class="id">rd</span>)); <span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_minus_distr_l">Rmult_minus_distr_l</a></span>.<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;/&nbsp;2&nbsp;*&nbsp;(u1&nbsp;-&nbsp;u2)&nbsp;&lt;=&nbsp;x&nbsp;-&nbsp;rd&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_or_le">Rlt_or_le</a></span> (/ 2 * (<span class="id">u1</span> + <span class="id">u2</span>)) (<span class="id">x</span> - <span class="id">rd</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;/&nbsp;2&nbsp;*&nbsp;(u1&nbsp;+&nbsp;u2)&nbsp;&lt;&nbsp;x&nbsp;-&nbsp;rd&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zceil">Zceil</a></span> <span class="id">x</span> - <span class="id">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt; / 2 * (<span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id">x</span> - <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span> <span class="id">x</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">rewrite</span> <span class="id">Hceil</span>; <span class="id">fold</span> <span class="id">u1</span>; <span class="id">fold</span> <span class="id">u2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_gt_mid_further_place">round_round_gt_mid_further_place</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">midp</span>'; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;x&nbsp;-&nbsp;rd&nbsp;&lt;=&nbsp;/&nbsp;2&nbsp;*&nbsp;(u1&nbsp;+&nbsp;u2)&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Cmid</span>, <span class="id"><a href="compcert.flocq.Core.Raux.html#Rabs_le">Rabs_le</a></span>; <span class="tactic">split</span>; <span class="id">lra</span>. }<br/>
Qed.</div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Double_round.Double_round_sqrt">Double_round_sqrt</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_round_sqrt_hyp">round_round_sqrt_hyp</a></span> <span class="id">fexp1</span> <span class="id">fexp2</span> :=<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">ex</span>, (2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span>))%<span class="id">Z</span>)<br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">ex</span>, (2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> - 1))%<span class="id">Z</span>)<br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">ex</span>, (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span>) &lt; 2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> + <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> &lt;= 2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> - 2)%<span class="id">Z</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="mag_sqrt_disj">mag_sqrt_disj</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> = 2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) - 1 :&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>)%<span class="id">Z</span><br/>
&nbsp;&nbsp;\/ (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> = 2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) :&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>)%<span class="id">Z</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6308')">Proof.</div>
<div class="proofscript" id="proof6308">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">Px</span>.<br/>
<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#mag_sqrt">mag_sqrt</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">x</span> <span class="id">Px</span>).<br/>
<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zeven.html#Zdiv2_odd_eqn">Zdiv2_odd_eqn</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> + 1)).<br/>
<span class="tactic">destruct</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.odd">Z.odd</a></span> ; <span class="tactic">intros</span> ; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_sqrt_aux">round_round_sqrt_aux</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_sqrt_hyp">round_round_sqrt_hyp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>)) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>)) - 1)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;/ 2 * <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#midp">midp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6309')">Proof.</div>
<div class="proofscript" id="proof6309">
<span class="tactic">intros</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Vfexp1</span> <span class="id">Vfexp2</span> <span class="id">Hexp</span> <span class="id">x</span> <span class="id">Px</span> <span class="id">Hf2</span> <span class="id">Fx</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Hbeta</span> : (2 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span>)%<span class="id">Z</span>).<br/>
{ <span class="tactic">destruct</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="kwd">as</span> (<span class="id">beta_val</span>,<span class="id">beta_prop</span>).<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zle_bool_imp_le">Zle_bool_imp_le</a></span>. }<br/>
<span class="tactic">set</span> (<span class="id">a</span> := <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>)).<br/>
<span class="tactic">set</span> (<span class="id">u1</span> := <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>)))).<br/>
<span class="tactic">set</span> (<span class="id">u2</span> := <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp2</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>)))).<br/>
<span class="tactic">set</span> (<span class="id">b</span> := / 2 * (<span class="id">u1</span> - <span class="id">u2</span>)).<br/>
<span class="tactic">set</span> (<span class="id">b</span>' := / 2 * (<span class="id">u1</span> + <span class="id">u2</span>)).<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#midp">midp</a></span>; <span class="tactic">rewrite</span> 2!<span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp_neq_0">ulp_neq_0</a></span>; <span class="tactic">try</span> <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_lt_R0">sqrt_lt_R0</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rnot_ge_lt">Rnot_ge_lt</a></span>; <span class="tactic">intro</span> <span class="id">H</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rge_le">Rge_le</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Fa</span> : <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id">a</span>).<br/>
{ <span class="tactic">unfold</span> <span class="id">a</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format_round">generic_format_round</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">exact</span> <span class="id">Vfexp1</span>.<br/>
&nbsp;&nbsp;- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_rnd_DN">valid_rnd_DN</a></span>. }<br/>
<span class="id">revert</span> <span class="id">Fa</span>; <span class="id">revert</span> <span class="id">Fx</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span>, <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="tactic">simpl</span>.<br/>
<span class="tactic">set</span> (<span class="id">mx</span> := <span class="id"><a href="compcert.flocq.Core.Raux.html#Ztrunc">Ztrunc</a></span> (<span class="id">x</span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)))).<br/>
<span class="tactic">set</span> (<span class="id">ma</span> := <span class="id"><a href="compcert.flocq.Core.Raux.html#Ztrunc">Ztrunc</a></span> (<span class="id">a</span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">a</span>)))).<br/>
<span class="tactic">intros</span> <span class="id">Fx</span> <span class="id">Fa</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Nna</span> : 0 &lt;= <span class="id">a</span>).<br/>
{ <span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_0">round_0</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">a</span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_le">round_le</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">exact</span> <span class="id">Vfexp1</span>.<br/>
&nbsp;&nbsp;- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_rnd_DN">valid_rnd_DN</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_pos">sqrt_pos</a></span>. }<br/>
<span class="tactic">assert</span> (<span class="id">Phu1</span> : 0 &lt; / 2 * <span class="id">u1</span>).<br/>
{ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>; [<span class="id">lra</span>|<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>]. }<br/>
<span class="tactic">assert</span> (<span class="id">Phu2</span> : 0 &lt; / 2 * <span class="id">u2</span>).<br/>
{ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>; [<span class="id">lra</span>|<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>]. }<br/>
<span class="tactic">assert</span> (<span class="id">Pb</span> : 0 &lt; <span class="id">b</span>).<br/>
{ <span class="tactic">unfold</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_r">Rmult_0_r</a></span> (/ 2)).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_lt_compat_l">Rmult_lt_compat_l</a></span>; [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_Rminus">Rlt_Rminus</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">u2</span>, <span class="id">u1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_lt">bpow_lt</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>. }<br/>
<span class="tactic">assert</span> (<span class="id">Pb</span>' : 0 &lt; <span class="id">b</span>').<br/>
{ <span class="id">now</span> <span class="tactic">unfold</span> <span class="id">b</span>'; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_plus_distr_l">Rmult_plus_distr_l</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_0_compat">Rplus_lt_0_compat</a></span>. }<br/>
<span class="tactic">assert</span> (<span class="id">Hr</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span> &lt;= <span class="id">a</span> + <span class="id">b</span>').<br/>
{ <span class="tactic">unfold</span> <span class="id">b</span>'; <span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_reg_r">Rplus_le_reg_r</a></span> (- / 2 * <span class="id">u1</span> - <span class="id">a</span>)); <span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">_</span> - <span class="id">_</span>) <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span> - (<span class="id">a</span> + / 2 * <span class="id">u1</span>)) <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rabs_le_inv">Rabs_le_inv</a></span>. }<br/>
<span class="tactic">assert</span> (<span class="id">Hl</span> : <span class="id">a</span> + <span class="id">b</span> &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>).<br/>
{ <span class="tactic">unfold</span> <span class="id">b</span>; <span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_reg_r">Rplus_le_reg_r</a></span> (- / 2 * <span class="id">u1</span> - <span class="id">a</span>)); <span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">_</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">_</span>) <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span> - (<span class="id">a</span> + / 2 * <span class="id">u1</span>)) <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_mult_distr_l_reverse">Ropp_mult_distr_l_reverse</a></span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rabs_le_inv">Rabs_le_inv</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">destruct</span> <span class="id">H</span>. }<br/>
<span class="tactic">assert</span> (<span class="id">Hf1</span> : (2 * <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>)) &lt;= <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span>)))%<span class="id">Z</span>);<br/>
&nbsp;&nbsp;[<span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag_sqrt_disj">mag_sqrt_disj</a></span> <span class="id">x</span> <span class="id">Px</span>) <span class="kwd">as</span> [<span class="id">H</span>'|<span class="id">H</span>']; <span class="tactic">rewrite</span> <span class="id">H</span>'; <span class="tactic">apply</span> <span class="id">Hexp</span>|].<br/>
<span class="tactic">assert</span> (<span class="id">Hlx</span> : (<span class="id">fexp1</span> (2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>)) &lt; 2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>))%<span class="id">Z</span>).<br/>
{ <span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag_sqrt_disj">mag_sqrt_disj</a></span> <span class="id">x</span> <span class="id">Px</span>) <span class="kwd">as</span> [<span class="id">Hlx</span>|<span class="id">Hlx</span>].<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_exp_large">valid_exp_large</a></span> <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)); [|<span class="tactic">omega</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#mag_generic_gt">mag_generic_gt</a></span>; [|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>|].<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> &lt;- <span class="id">Hlx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#mag_generic_gt">mag_generic_gt</a></span>; [|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>|]. }<br/>
<span class="tactic">assert</span> (<span class="id">Hsl</span> : <span class="id">a</span> * <span class="id">a</span> + <span class="id">u1</span> * <span class="id">a</span> - <span class="id">u2</span> * <span class="id">a</span> + <span class="id">b</span> * <span class="id">b</span> &lt;= <span class="id">x</span>).<br/>
{ <span class="tactic">replace</span> (<span class="id">_</span> + <span class="id">_</span>) <span class="kwd">with</span> ((<span class="id">a</span> + <span class="id">b</span>) * (<span class="id">a</span> + <span class="id">b</span>)); [|<span class="id">now</span> <span class="tactic">unfold</span> <span class="id">b</span>; <span class="id">field</span>].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_def">sqrt_def</a></span>; [|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">H</span>' : 0 &lt;= <span class="id">a</span> + <span class="id">b</span>); [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_lt_0_compat">Rplus_le_lt_0_compat</a></span>|].<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat">Rmult_le_compat</a></span>. }<br/>
<span class="tactic">assert</span> (<span class="id">Hsr</span> : <span class="id">x</span> &lt;= <span class="id">a</span> * <span class="id">a</span> + <span class="id">u1</span> * <span class="id">a</span> + <span class="id">u2</span> * <span class="id">a</span> + <span class="id">b</span>' * <span class="id">b</span>').<br/>
{ <span class="tactic">replace</span> (<span class="id">_</span> + <span class="id">_</span>) <span class="kwd">with</span> ((<span class="id">a</span> + <span class="id">b</span>') * (<span class="id">a</span> + <span class="id">b</span>')); [|<span class="id">now</span> <span class="tactic">unfold</span> <span class="id">b</span>'; <span class="id">field</span>].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_def">sqrt_def</a></span> <span class="id">x</span>); [|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">H</span>' : 0 &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>); [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_pos">sqrt_pos</a></span>|].<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat">Rmult_le_compat</a></span>. }<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_dec">Req_dec</a></span> <span class="id">a</span> 0) <span class="kwd">as</span> [<span class="id">Za</span>|<span class="id">Nza</span>].<br/>
- <span class="comment">(*&nbsp;a&nbsp;=&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_irrefl">Rlt_irrefl</a></span> 0).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (<span class="id">b</span> * <span class="id">b</span>); [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>|].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;+ <span class="id">revert</span> <span class="id">Hsl</span>; <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rminus">Rminus</a></span>; <span class="tactic">rewrite</span> <span class="id">Za</span>; <span class="tactic">do</span> 3 <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_r">Rmult_0_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_0">Ropp_0</a></span>; <span class="tactic">do</span> 3 <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_0_l">Rplus_0_l</a></span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">Fx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_reg_r">Rmult_le_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_l">Rmult_0_l</a></span>; <span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">mx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Ztrunc_floor">Ztrunc_floor</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_pos">Rmult_le_pos</a></span>; [<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>|<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_ge_0">bpow_ge_0</a></span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_le">Req_le</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.DiscrR.html#IZR_eq">IZR_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor_imp">Zfloor_imp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_pos">Rmult_le_pos</a></span>; [<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>|<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_ge_0">bpow_ge_0</a></span>]|<span class="tactic">simpl</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_r">Rmult_lt_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)))); [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span>; <span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (2 * <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>))));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_le">bpow_le</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> 2%<span class="id">Z</span> <span class="kwd">with</span> (1 + 1)%<span class="id">Z</span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zmult_plus_distr_l">Zmult_plus_distr_l</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zmult_1_l">Zmult_1_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_plus">bpow_plus</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_def">sqrt_def</a></span> <span class="id">x</span>) <span class="tactic">at</span> 1; [|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span> &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>))));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rmult_lt_compat">Rmult_lt_compat</a></span>; [<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_pos">sqrt_pos</a></span>|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_pos">sqrt_pos</a></span>| |]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hr</span>); <span class="tactic">rewrite</span> <span class="id">Za</span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_0_l">Rplus_0_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">b</span>'; <span class="id">change</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> <span class="id">_</span>) <span class="kwd">with</span> <span class="id">u1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (/ 2 * (<span class="id">u1</span> + <span class="id">u1</span>)); [|<span class="id">lra</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_lt_compat_l">Rmult_lt_compat_l</a></span>; [<span class="id">lra</span>|]; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_lt_compat_l">Rplus_lt_compat_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">u2</span>, <span class="id">u1</span>, <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_lt">bpow_lt</a></span>; <span class="tactic">omega</span>.<br/>
- <span class="comment">(*&nbsp;a&nbsp;&lt;&gt;&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Pa</span> : 0 &lt; <span class="id">a</span>); [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hla</span> : (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">a</span> = <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>) :&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>)).<br/>
&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id">a</span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#mag_DN">mag_DN</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">exact</span> <span class="id">Vfexp1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="id">fold</span> <span class="id">a</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hl</span>' : 0 &lt; - (<span class="id">u2</span> * <span class="id">a</span>) + <span class="id">b</span> * <span class="id">b</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_reg_r">Rplus_lt_reg_r</a></span> (<span class="id">u2</span> * <span class="id">a</span>)); <span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">b</span>; <span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_reg_r">Rplus_lt_reg_r</a></span> (/ 2 * <span class="id">u2</span> * <span class="id">u1</span>)); <span class="id">field_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">_</span> / 2) <span class="kwd">with</span> (<span class="id">u2</span> * (<span class="id">a</span> + / 2 * <span class="id">u1</span>)) <span class="tactic">by</span> <span class="id">field</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">_</span> / 8) <span class="kwd">with</span> (/ 4 * (<span class="id">u2</span> ^ 2 + <span class="id">u1</span> ^ 2)) <span class="tactic">by</span> <span class="id">field</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (<span class="id">u2</span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_lt_compat_l">Rmult_lt_compat_l</a></span>; [<span class="id">now</span> <span class="tactic">unfold</span> <span class="id">u2</span>, <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">u1</span>; <span class="tactic">rewrite</span> &lt;- <span class="id">Hla</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (<span class="id">a</span> + <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">a</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_lt_compat_l">Rplus_lt_compat_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> <span class="id">_</span>)) <span class="tactic">at</span> 2.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_compat_r">Rmult_lt_compat_r</a></span>; [<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|<span class="id">lra</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (<span class="id">a</span>+ <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>; <span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp_neq_0">ulp_neq_0</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Ulp.html#id_p_ulp_le_bpow">id_p_ulp_le_bpow</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Pa</span> <span class="id">Fa</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rabs_lt_inv">Rabs_lt_inv</a></span>, <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_mag_gt">bpow_mag_gt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- 2) * <span class="id">u1</span> ^ 2).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpow_def.html#pow">pow</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_1_r">Rmult_1_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">u1</span>, <span class="id">u2</span>, <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="id">bpow_simplify</span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_le">bpow_le</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">Hexp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat">Rmult_le_compat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_ge_0">bpow_ge_0</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ratan.html#pow2_ge_0">pow2_ge_0</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow">Raux.bpow</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pow_pos">Z.pow_pos</a></span>; <span class="tactic">simpl</span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zmult_1_r">Zmult_1_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rinv_le">Rinv_le</a></span>; [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> 4%<span class="id">Z</span> <span class="kwd">with</span> (2 * 2)%<span class="id">Z</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#IZR_le">IZR_le</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zmult_le_compat">Zmult_le_compat</a></span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_0_l">Rplus_0_l</a></span> (<span class="id">u1</span> ^ 2)) <span class="tactic">at</span> 1; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat_r">Rplus_le_compat_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ratan.html#pow2_ge_0">pow2_ge_0</a></span>. }<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hr</span>' : <span class="id">x</span> &lt;= <span class="id">a</span> * <span class="id">a</span> + <span class="id">u1</span> * <span class="id">a</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">rewrite</span> <span class="id">Hla</span> <span class="kwd">in</span> <span class="id">Fa</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_plus_distr_r">Rmult_plus_distr_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">u1</span>, <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> <span class="id">_</span>)); <span class="tactic">rewrite</span> <span class="id">Fa</span>; <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_plus_distr_r">Rmult_plus_distr_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>; <span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span> <span class="id">_</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id">ma</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id">ma</span>)); <span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_reg_r">Rmult_le_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- 2 * <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>)))));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|<span class="id">bpow_simplify</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Fx</span> <span class="tactic">at</span> 1; <span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Raux.html#IZR_Zpower">IZR_Zpower</a></span>; [|<span class="tactic">omega</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#plus_IZR">plus_IZR</a></span>, &lt;- 2!<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mult_IZR">mult_IZR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#IZR_le">IZR_le</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zlt_succ_le">Zlt_succ_le</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#lt_IZR">lt_IZR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.succ">Z.succ</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#plus_IZR">plus_IZR</a></span>; <span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mult_IZR">mult_IZR</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#plus_IZR">plus_IZR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#IZR_Zpower">IZR_Zpower</a></span>; [|<span class="tactic">omega</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_r">Rmult_lt_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (2 * <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>)))));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|<span class="id">bpow_simplify</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Fx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> 2%<span class="id">Z</span> <span class="kwd">with</span> (1 + 1)%<span class="id">Z</span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zmult_plus_distr_l">Zmult_plus_distr_l</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zmult_1_l">Zmult_1_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_plus">bpow_plus</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">_</span> * <span class="id">_</span>) <span class="kwd">with</span> (<span class="id">a</span> * <span class="id">a</span> + <span class="id">u1</span> * <span class="id">a</span> + <span class="id">u1</span> * <span class="id">u1</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="tactic">unfold</span> <span class="id">u1</span>, <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="tactic">rewrite</span> <span class="id">Fa</span>; <span class="tactic">ring</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hsr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_assoc">Rplus_assoc</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_lt_compat_l">Rplus_lt_compat_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_reg_r">Rplus_lt_reg_r</a></span> (- <span class="id">b</span>' * <span class="id">b</span>' + / 2 * <span class="id">u1</span> * <span class="id">u2</span>)); <span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">_</span> + <span class="id">_</span>) <span class="kwd">with</span> ((<span class="id">a</span> + / 2 * <span class="id">u1</span>) * <span class="id">u2</span>) <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>)) * <span class="id">u2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_compat_r">Rmult_lt_compat_r</a></span>; [<span class="id">now</span> <span class="tactic">unfold</span> <span class="id">u2</span>, <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (<span class="id">a</span> + <span class="id">u1</span>); [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">u1</span>; <span class="id">fold</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp_DN">cexp_DN</a></span>; [|<span class="tactic">exact</span> <span class="id">Vfexp1</span>|<span class="tactic">exact</span> <span class="id">Pa</span>]; <span class="id">fold</span> <span class="id">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp_neq_0">ulp_neq_0</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Ulp.html#id_p_ulp_le_bpow">id_p_ulp_le_bpow</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">exact</span> <span class="id">Pa</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_DN_pt">round_DN_pt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_DN_pt">round_DN_pt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rabs_lt_inv">Rabs_lt_inv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_mag_gt">bpow_mag_gt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (/ 2 * <span class="id">u1</span> ^ 2).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- 2) * <span class="id">u1</span> ^ 2).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpow_def.html#pow">pow</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_1_r">Rmult_1_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">u2</span>, <span class="id">u1</span>, <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_le">bpow_le</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zplus_comm">Zplus_comm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">Hexp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_r">Rmult_le_compat_r</a></span>; [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ratan.html#pow2_ge_0">pow2_ge_0</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow">Raux.bpow</a></span>; <span class="tactic">simpl</span>; <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pow_pos">Z.pow_pos</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zmult_1_r">Zmult_1_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rinv_le">Rinv_le</a></span>; [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#IZR_le">IZR_le</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zmult_1_l">Zmult_1_l</a></span> 2).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zmult_le_compat">Zmult_le_compat</a></span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">assert</span> (<span class="id">u2</span> ^ 2 &lt; <span class="id">u1</span> ^ 2); [|<span class="tactic">unfold</span> <span class="id">b</span>'; <span class="id">lra</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpow_def.html#pow">pow</a></span>; <span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_1_r">Rmult_1_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">H</span>' : 0 &lt;= <span class="id">u2</span>); [<span class="tactic">unfold</span> <span class="id">u2</span>, <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_ge_0">bpow_ge_0</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">u2</span> &lt; <span class="id">u1</span>); [|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rmult_lt_compat">Rmult_lt_compat</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">u1</span>, <span class="id">u2</span>, <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_lt">bpow_lt</a></span>; <span class="tactic">omega</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_irrefl">Rlt_irrefl</a></span> (<span class="id">a</span> * <span class="id">a</span> + <span class="id">u1</span> * <span class="id">a</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (<span class="id">a</span> * <span class="id">a</span> + <span class="id">u1</span> * <span class="id">a</span> - <span class="id">u2</span> * <span class="id">a</span> + <span class="id">b</span> * <span class="id">b</span>).<br/>
&nbsp;&nbsp;+ <span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_0_r">Rplus_0_r</a></span> (<span class="id">a</span> * <span class="id">a</span> + <span class="id">_</span>)) <span class="tactic">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rminus">Rminus</a></span>; <span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_assoc">Rplus_assoc</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id">b</span> * <span class="id">b</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_lt_compat_l">Rplus_lt_compat_l</a></span>.<br/>
&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> <span class="id">x</span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_sqrt">round_round_sqrt</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">choice1</span> <span class="id">choice2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_sqrt_hyp">round_round_sqrt_hyp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6310')">Proof.</div>
<div class="proofscript" id="proof6310">
<span class="tactic">intros</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Vfexp1</span> <span class="id">Vfexp2</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Hexp</span> <span class="id">x</span> <span class="id">Fx</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_or_lt">Rle_or_lt</a></span> <span class="id">x</span> 0) <span class="kwd">as</span> [<span class="id">Npx</span>|<span class="id">Px</span>].<br/>
- <span class="comment">(*&nbsp;x&nbsp;&lt;=&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#sqrt_neg">sqrt_neg</a></span> <span class="id">_</span> <span class="id">Npx</span>).<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_0">round_0</a></span>; [|<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_rnd_N">valid_rnd_N</a></span>].<br/>
- <span class="comment">(*&nbsp;0&nbsp;&lt;&nbsp;x&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hfx</span> : (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)%<span class="id">Z</span>);<br/>
&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#mag_generic_gt">mag_generic_gt</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>; <span class="id">lra</span>|].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hfsx</span> : (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>)) &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>))%<span class="id">Z</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_or_lt">Rle_or_lt</a></span> <span class="id">x</span> 1) <span class="kwd">as</span> [<span class="id">Hx</span>|<span class="id">Hx</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;x&nbsp;&lt;=&nbsp;1&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_exp_large">valid_exp_large</a></span> <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)); [<span class="tactic">exact</span> <span class="id">Hfx</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#mag_le">mag_le</a></span>; [<span class="tactic">exact</span> <span class="id">Px</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_def">sqrt_def</a></span> <span class="id">x</span>) <span class="tactic">at</span> 1; [|<span class="id">lra</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_1_r">Rmult_1_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_l">Rmult_le_compat_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_pos">sqrt_pos</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_1">sqrt_1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_le_1_alt">sqrt_le_1_alt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;1&nbsp;&lt;&nbsp;x&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> ((<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj2">proj2</a></span> <span class="id">Hexp</span>)) 1%<span class="id">Z</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">_</span> - 1)%<span class="id">Z</span> <span class="kwd">with</span> 1%<span class="id">Z</span> <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">Hexp10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hf0</span> : (<span class="id">fexp1</span> 1 &lt; 1)%<span class="id">Z</span>); [<span class="tactic">omega</span>|<span class="tactic">clear</span> <span class="id">Hexp10</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_exp_large">valid_exp_large</a></span> <span class="id">fexp1</span> 1); [<span class="tactic">exact</span> <span class="id">Hf0</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#mag_ge_bpow">mag_ge_bpow</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zeq_minus">Zeq_minus</a></span>; [|<span class="tactic">reflexivity</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow">Raux.bpow</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rabs_ge">Rabs_ge</a></span>; <span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_1">sqrt_1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_le_1_alt">sqrt_le_1_alt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>. }<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hf2</span> : (<span class="id">fexp2</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>)) &lt;= <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>)) - 1)%<span class="id">Z</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">assert</span> (<span class="id">H</span> : (<span class="id">fexp1</span> (2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>)) &lt; 2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>))%<span class="id">Z</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag_sqrt_disj">mag_sqrt_disj</a></span> <span class="id">x</span> <span class="id">Px</span>) <span class="kwd">as</span> [<span class="id">Hlx</span>|<span class="id">Hlx</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_exp_large">valid_exp_large</a></span> <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)); [|<span class="tactic">omega</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#mag_generic_gt">mag_generic_gt</a></span>; [|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> &lt;- <span class="id">Hlx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#mag_generic_gt">mag_generic_gt</a></span>; [|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>|]. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> ((<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj2">proj2</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj2">proj2</a></span> <span class="id">Hexp</span>)) (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>)) <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_mid_cases">round_round_mid_cases</a></span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">exact</span> <span class="id">Vfexp1</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">exact</span> <span class="id">Vfexp2</span>.<br/>
&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_lt_R0">sqrt_lt_R0</a></span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">intros</span> <span class="id">Hmid</span>; <span class="id">casetype</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>; <span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_not_lt">Rle_not_lt</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hmid</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_sqrt_aux">round_round_sqrt_aux</a></span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Vfexp1</span> <span class="id">Vfexp2</span> <span class="id">Hexp</span> <span class="id">x</span> <span class="id">Px</span> <span class="id">Hf2</span> <span class="id">Fx</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Double_round.Double_round_sqrt.Double_round_sqrt_FLX">Double_round_sqrt_FLX</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Double_round.Double_round_sqrt.Double_round_sqrt_FLX.prec">prec</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id">prec</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<br/>
<span class="kwd">Context</span> { <span class="id">prec_gt_0_</span> : <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FLX.prec">prec</a></span> }.<br/>
<span class="kwd">Context</span> { <span class="id">prec_gt_0_</span>' : <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="id">prec</span>' }.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="FLX_round_round_sqrt_hyp">FLX_round_round_sqrt_hyp</a></span> :<br/>
&nbsp;&nbsp;(2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FLX.prec">prec</a></span> + 2 &lt;= <span class="id">prec</span>')%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_sqrt_hyp">round_round_sqrt_hyp</a></span> (<span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp">FLX_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FLX.prec">prec</a></span>) (<span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp">FLX_exp</a></span> <span class="id">prec</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6311')">Proof.</div>
<div class="proofscript" id="proof6311">
<span class="tactic">intros</span> <span class="id">Hprec</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp">FLX_exp</a></span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="kwd">in</span> <span class="id">prec_gt_0_</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_sqrt_hyp">round_round_sqrt_hyp</a></span>; <span class="tactic">split</span>; [|<span class="tactic">split</span>]; <span class="tactic">intro</span> <span class="id">ex</span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="round_round_sqrt_FLX">round_round_sqrt_FLX</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">choice1</span> <span class="id">choice2</span>,<br/>
&nbsp;&nbsp;(2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FLX.prec">prec</a></span> + 2 &lt;= <span class="id">prec</span>')%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_format">FLX_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FLX.prec">prec</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> (<span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp">FLX_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FLX.prec">prec</a></span>) (<span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp">FLX_exp</a></span> <span class="id">prec</span>') <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6312')">Proof.</div>
<div class="proofscript" id="proof6312">
<span class="tactic">intros</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Hprec</span> <span class="id">x</span> <span class="id">Fx</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_sqrt">round_round_sqrt</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp_valid">FLX_exp_valid</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp_valid">FLX_exp_valid</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#FLX_round_round_sqrt_hyp">FLX_round_round_sqrt_hyp</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#generic_format_FLX">generic_format_FLX</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FLX">Double_round_sqrt_FLX</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Double_round.Double_round_sqrt.Double_round_sqrt_FLT">Double_round_sqrt_FLT</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Double_round.Double_round_sqrt.Double_round_sqrt_FLT.emin">emin</a></span> <span class="id"><a name="Double_round.Double_round_sqrt.Double_round_sqrt_FLT.prec">prec</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id">emin</span>' <span class="id">prec</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<br/>
<span class="kwd">Context</span> { <span class="id">prec_gt_0_</span> : <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FLT.prec">prec</a></span> }.<br/>
<span class="kwd">Context</span> { <span class="id">prec_gt_0_</span>' : <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="id">prec</span>' }.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="FLT_round_round_sqrt_hyp">FLT_round_round_sqrt_hyp</a></span> :<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FLT.emin">emin</a></span> &lt;= 0)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;((<span class="id">emin</span>' &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FLT.emin">emin</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FLT.prec">prec</a></span> - 2)%<span class="id">Z</span><br/>
&nbsp;&nbsp;&nbsp;\/ (2 * <span class="id">emin</span>' &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FLT.emin">emin</a></span> - 4 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FLT.prec">prec</a></span> - 2)%<span class="id">Z</span>) -&gt;<br/>
&nbsp;&nbsp;(2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FLT.prec">prec</a></span> + 2 &lt;= <span class="id">prec</span>')%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_sqrt_hyp">round_round_sqrt_hyp</a></span> (<span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp">FLT_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FLT.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FLT.prec">prec</a></span>) (<span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp">FLT_exp</a></span> <span class="id">emin</span>' <span class="id">prec</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6313')">Proof.</div>
<div class="proofscript" id="proof6313">
<span class="tactic">intros</span> <span class="id">Hemin</span> <span class="id">Heminprec</span> <span class="id">Hprec</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp">FLT_exp</a></span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="kwd">in</span> <span class="id">prec_gt_0_</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_sqrt_hyp">round_round_sqrt_hyp</a></span>; <span class="tactic">split</span>; [|<span class="tactic">split</span>]; <span class="tactic">intros</span> <span class="id">ex</span>.<br/>
- <span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ex</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FLT.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FLT.emin">emin</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (2 * <span class="id">ex</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FLT.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FLT.emin">emin</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
- <span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ex</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FLT.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FLT.emin">emin</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (2 * <span class="id">ex</span> - 1 - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FLT.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FLT.emin">emin</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
- <span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (2 * <span class="id">ex</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FLT.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FLT.emin">emin</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ex</span> - <span class="id">prec</span>') <span class="id">emin</span>').<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ex</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FLT.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FLT.emin">emin</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="round_round_sqrt_FLT">round_round_sqrt_FLT</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">choice1</span> <span class="id">choice2</span>,<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FLT.emin">emin</a></span> &lt;= 0)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;((<span class="id">emin</span>' &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FLT.emin">emin</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FLT.prec">prec</a></span> - 2)%<span class="id">Z</span><br/>
&nbsp;&nbsp;&nbsp;\/ (2 * <span class="id">emin</span>' &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FLT.emin">emin</a></span> - 4 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FLT.prec">prec</a></span> - 2)%<span class="id">Z</span>) -&gt;<br/>
&nbsp;&nbsp;(2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FLT.prec">prec</a></span> + 2 &lt;= <span class="id">prec</span>')%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_format">FLT_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FLT.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FLT.prec">prec</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> (<span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp">FLT_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FLT.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FLT.prec">prec</a></span>) (<span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp">FLT_exp</a></span> <span class="id">emin</span>' <span class="id">prec</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6314')">Proof.</div>
<div class="proofscript" id="proof6314">
<span class="tactic">intros</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Hemin</span> <span class="id">Heminprec</span> <span class="id">Hprec</span> <span class="id">x</span> <span class="id">Fx</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_sqrt">round_round_sqrt</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp_valid">FLT_exp_valid</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp_valid">FLT_exp_valid</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#FLT_round_round_sqrt_hyp">FLT_round_round_sqrt_hyp</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLT.html#generic_format_FLT">generic_format_FLT</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FLT">Double_round_sqrt_FLT</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Double_round.Double_round_sqrt.Double_round_sqrt_FTZ">Double_round_sqrt_FTZ</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Double_round.Double_round_sqrt.Double_round_sqrt_FTZ.emin">emin</a></span> <span class="id"><a name="Double_round.Double_round_sqrt.Double_round_sqrt_FTZ.prec">prec</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id">emin</span>' <span class="id">prec</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<br/>
<span class="kwd">Context</span> { <span class="id">prec_gt_0_</span> : <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FTZ.prec">prec</a></span> }.<br/>
<span class="kwd">Context</span> { <span class="id">prec_gt_0_</span>' : <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="id">prec</span>' }.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="FTZ_round_round_sqrt_hyp">FTZ_round_round_sqrt_hyp</a></span> :<br/>
&nbsp;&nbsp;(2 * (<span class="id">emin</span>' + <span class="id">prec</span>') &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FTZ.emin">emin</a></span> + <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FTZ.prec">prec</a></span> &lt;= 1)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;(2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FTZ.prec">prec</a></span> + 2 &lt;= <span class="id">prec</span>')%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_sqrt_hyp">round_round_sqrt_hyp</a></span> (<span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp">FTZ_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FTZ.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FTZ.prec">prec</a></span>) (<span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp">FTZ_exp</a></span> <span class="id">emin</span>' <span class="id">prec</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6315')">Proof.</div>
<div class="proofscript" id="proof6315">
<span class="tactic">intros</span> <span class="id">Hemin</span> <span class="id">Hprec</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp">FTZ_exp</a></span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="kwd">in</span> *.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_sqrt_hyp">round_round_sqrt_hyp</a></span>; <span class="tactic">split</span>; [|<span class="tactic">split</span>]; <span class="tactic">intros</span> <span class="id">ex</span>.<br/>
- <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ex</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FTZ.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FTZ.emin">emin</a></span>);<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (2 * <span class="id">ex</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FTZ.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FTZ.emin">emin</a></span>);<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
- <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ex</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FTZ.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FTZ.emin">emin</a></span>);<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (2 * <span class="id">ex</span> - 1 - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FTZ.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FTZ.emin">emin</a></span>);<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
- <span class="tactic">intro</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zle_or_lt">Zle_or_lt</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FTZ.emin">emin</a></span> (2 * <span class="id">ex</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FTZ.prec">prec</a></span>)) <span class="kwd">as</span> [<span class="id">H</span>'|<span class="id">H</span>'].<br/>
&nbsp;&nbsp;+ <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ex</span> - <span class="id">prec</span>') <span class="id">emin</span>');<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ex</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FTZ.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FTZ.emin">emin</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;+ <span class="id">casetype</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.flocq.Core.Zaux.html#Zlt_bool_true">Zlt_bool_true</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>') <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="round_round_sqrt_FTZ">round_round_sqrt_FTZ</a></span> :<br/>
&nbsp;&nbsp;(4 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">choice1</span> <span class="id">choice2</span>,<br/>
&nbsp;&nbsp;(2 * (<span class="id">emin</span>' + <span class="id">prec</span>') &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FTZ.emin">emin</a></span> + <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FTZ.prec">prec</a></span> &lt;= 1)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;(2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FTZ.prec">prec</a></span> + 2 &lt;= <span class="id">prec</span>')%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_format">FTZ_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FTZ.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FTZ.prec">prec</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> (<span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp">FTZ_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FTZ.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FTZ.prec">prec</a></span>) (<span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp">FTZ_exp</a></span> <span class="id">emin</span>' <span class="id">prec</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6316')">Proof.</div>
<div class="proofscript" id="proof6316">
<span class="tactic">intros</span> <span class="id">Hbeta</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Hemin</span> <span class="id">Hprec</span> <span class="id">x</span> <span class="id">Fx</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_sqrt">round_round_sqrt</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp_valid">FTZ_exp_valid</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp_valid">FTZ_exp_valid</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#FTZ_round_round_sqrt_hyp">FTZ_round_round_sqrt_hyp</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FTZ.html#generic_format_FTZ">generic_format_FTZ</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_FTZ">Double_round_sqrt_FTZ</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4">Double_round_sqrt_radix_ge_4</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_round_sqrt_radix_ge_4_hyp">round_round_sqrt_radix_ge_4_hyp</a></span> <span class="id">fexp1</span> <span class="id">fexp2</span> :=<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">ex</span>, (2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span>))%<span class="id">Z</span>)<br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">ex</span>, (2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> - 1))%<span class="id">Z</span>)<br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">ex</span>, (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span>) &lt; 2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> + <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> &lt;= 2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> - 1)%<span class="id">Z</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_sqrt_radix_ge_4_aux">round_round_sqrt_radix_ge_4_aux</a></span> :<br/>
&nbsp;&nbsp;(4 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_sqrt_radix_ge_4_hyp">round_round_sqrt_radix_ge_4_hyp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>)) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>)) - 1)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;/ 2 * <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#midp">midp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6317')">Proof.</div>
<div class="proofscript" id="proof6317">
<span class="tactic">intros</span> <span class="id">Hbeta</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Vfexp1</span> <span class="id">Vfexp2</span> <span class="id">Hexp</span> <span class="id">x</span> <span class="id">Px</span> <span class="id">Hf2</span> <span class="id">Fx</span>.<br/>
<span class="tactic">set</span> (<span class="id">a</span> := <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>)).<br/>
<span class="tactic">set</span> (<span class="id">u1</span> := <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>)))).<br/>
<span class="tactic">set</span> (<span class="id">u2</span> := <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp2</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>)))).<br/>
<span class="tactic">set</span> (<span class="id">b</span> := / 2 * (<span class="id">u1</span> - <span class="id">u2</span>)).<br/>
<span class="tactic">set</span> (<span class="id">b</span>' := / 2 * (<span class="id">u1</span> + <span class="id">u2</span>)).<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#midp">midp</a></span>; <span class="tactic">rewrite</span> 2!<span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp_neq_0">ulp_neq_0</a></span>; <span class="tactic">try</span> <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_lt_R0">sqrt_lt_R0</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rnot_ge_lt">Rnot_ge_lt</a></span>; <span class="tactic">intro</span> <span class="id">H</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rge_le">Rge_le</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Fa</span> : <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id">a</span>).<br/>
{ <span class="tactic">unfold</span> <span class="id">a</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format_round">generic_format_round</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">exact</span> <span class="id">Vfexp1</span>.<br/>
&nbsp;&nbsp;- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_rnd_DN">valid_rnd_DN</a></span>. }<br/>
<span class="id">revert</span> <span class="id">Fa</span>; <span class="id">revert</span> <span class="id">Fx</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span>, <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="tactic">simpl</span>.<br/>
<span class="tactic">set</span> (<span class="id">mx</span> := <span class="id"><a href="compcert.flocq.Core.Raux.html#Ztrunc">Ztrunc</a></span> (<span class="id">x</span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)))).<br/>
<span class="tactic">set</span> (<span class="id">ma</span> := <span class="id"><a href="compcert.flocq.Core.Raux.html#Ztrunc">Ztrunc</a></span> (<span class="id">a</span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">a</span>)))).<br/>
<span class="tactic">intros</span> <span class="id">Fx</span> <span class="id">Fa</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Nna</span> : 0 &lt;= <span class="id">a</span>).<br/>
{ <span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_0">round_0</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">a</span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_le">round_le</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">exact</span> <span class="id">Vfexp1</span>.<br/>
&nbsp;&nbsp;- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_rnd_DN">valid_rnd_DN</a></span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_pos">sqrt_pos</a></span>. }<br/>
<span class="tactic">assert</span> (<span class="id">Phu1</span> : 0 &lt; / 2 * <span class="id">u1</span>).<br/>
{ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>; [<span class="id">lra</span>|<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>]. }<br/>
<span class="tactic">assert</span> (<span class="id">Phu2</span> : 0 &lt; / 2 * <span class="id">u2</span>).<br/>
{ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>; [<span class="id">lra</span>|<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>]. }<br/>
<span class="tactic">assert</span> (<span class="id">Pb</span> : 0 &lt; <span class="id">b</span>).<br/>
{ <span class="tactic">unfold</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_r">Rmult_0_r</a></span> (/ 2)).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_lt_compat_l">Rmult_lt_compat_l</a></span>; [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_Rminus">Rlt_Rminus</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">u2</span>, <span class="id">u1</span>, <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_lt">bpow_lt</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>. }<br/>
<span class="tactic">assert</span> (<span class="id">Pb</span>' : 0 &lt; <span class="id">b</span>').<br/>
{ <span class="id">now</span> <span class="tactic">unfold</span> <span class="id">b</span>'; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_plus_distr_l">Rmult_plus_distr_l</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_0_compat">Rplus_lt_0_compat</a></span>. }<br/>
<span class="tactic">assert</span> (<span class="id">Hr</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span> &lt;= <span class="id">a</span> + <span class="id">b</span>').<br/>
{ <span class="tactic">unfold</span> <span class="id">b</span>'; <span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_reg_r">Rplus_le_reg_r</a></span> (- / 2 * <span class="id">u1</span> - <span class="id">a</span>)); <span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">_</span> - <span class="id">_</span>) <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span> - (<span class="id">a</span> + / 2 * <span class="id">u1</span>)) <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rabs_le_inv">Rabs_le_inv</a></span>. }<br/>
<span class="tactic">assert</span> (<span class="id">Hl</span> : <span class="id">a</span> + <span class="id">b</span> &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>).<br/>
{ <span class="tactic">unfold</span> <span class="id">b</span>; <span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_reg_r">Rplus_le_reg_r</a></span> (- / 2 * <span class="id">u1</span> - <span class="id">a</span>)); <span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">_</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">_</span>) <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span> - (<span class="id">a</span> + / 2 * <span class="id">u1</span>)) <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_mult_distr_l_reverse">Ropp_mult_distr_l_reverse</a></span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rabs_le_inv">Rabs_le_inv</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">destruct</span> <span class="id">H</span>. }<br/>
<span class="tactic">assert</span> (<span class="id">Hf1</span> : (2 * <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>)) &lt;= <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span>)))%<span class="id">Z</span>);<br/>
&nbsp;&nbsp;[<span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag_sqrt_disj">mag_sqrt_disj</a></span> <span class="id">x</span> <span class="id">Px</span>) <span class="kwd">as</span> [<span class="id">H</span>'|<span class="id">H</span>']; <span class="tactic">rewrite</span> <span class="id">H</span>'; <span class="tactic">apply</span> <span class="id">Hexp</span>|].<br/>
<span class="tactic">assert</span> (<span class="id">Hlx</span> : (<span class="id">fexp1</span> (2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>)) &lt; 2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>))%<span class="id">Z</span>).<br/>
{ <span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag_sqrt_disj">mag_sqrt_disj</a></span> <span class="id">x</span> <span class="id">Px</span>) <span class="kwd">as</span> [<span class="id">Hlx</span>|<span class="id">Hlx</span>].<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_exp_large">valid_exp_large</a></span> <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)); [|<span class="tactic">omega</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#mag_generic_gt">mag_generic_gt</a></span>; [|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>|].<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> &lt;- <span class="id">Hlx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#mag_generic_gt">mag_generic_gt</a></span>; [|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>|]. }<br/>
<span class="tactic">assert</span> (<span class="id">Hsl</span> : <span class="id">a</span> * <span class="id">a</span> + <span class="id">u1</span> * <span class="id">a</span> - <span class="id">u2</span> * <span class="id">a</span> + <span class="id">b</span> * <span class="id">b</span> &lt;= <span class="id">x</span>).<br/>
{ <span class="tactic">replace</span> (<span class="id">_</span> + <span class="id">_</span>) <span class="kwd">with</span> ((<span class="id">a</span> + <span class="id">b</span>) * (<span class="id">a</span> + <span class="id">b</span>)); [|<span class="id">now</span> <span class="tactic">unfold</span> <span class="id">b</span>; <span class="id">field</span>].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_def">sqrt_def</a></span>; [|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">H</span>' : 0 &lt;= <span class="id">a</span> + <span class="id">b</span>); [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_lt_0_compat">Rplus_le_lt_0_compat</a></span>|].<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat">Rmult_le_compat</a></span>. }<br/>
<span class="tactic">assert</span> (<span class="id">Hsr</span> : <span class="id">x</span> &lt;= <span class="id">a</span> * <span class="id">a</span> + <span class="id">u1</span> * <span class="id">a</span> + <span class="id">u2</span> * <span class="id">a</span> + <span class="id">b</span>' * <span class="id">b</span>').<br/>
{ <span class="tactic">replace</span> (<span class="id">_</span> + <span class="id">_</span>) <span class="kwd">with</span> ((<span class="id">a</span> + <span class="id">b</span>') * (<span class="id">a</span> + <span class="id">b</span>')); [|<span class="id">now</span> <span class="tactic">unfold</span> <span class="id">b</span>'; <span class="id">field</span>].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_def">sqrt_def</a></span> <span class="id">x</span>); [|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">H</span>' : 0 &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>); [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_pos">sqrt_pos</a></span>|].<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat">Rmult_le_compat</a></span>. }<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_dec">Req_dec</a></span> <span class="id">a</span> 0) <span class="kwd">as</span> [<span class="id">Za</span>|<span class="id">Nza</span>].<br/>
- <span class="comment">(*&nbsp;a&nbsp;=&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_irrefl">Rlt_irrefl</a></span> 0).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (<span class="id">b</span> * <span class="id">b</span>); [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>|].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;+ <span class="id">revert</span> <span class="id">Hsl</span>; <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rminus">Rminus</a></span>; <span class="tactic">rewrite</span> <span class="id">Za</span>; <span class="tactic">do</span> 3 <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_r">Rmult_0_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_0">Ropp_0</a></span>; <span class="tactic">do</span> 3 <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_0_l">Rplus_0_l</a></span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">Fx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_reg_r">Rmult_le_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_l">Rmult_0_l</a></span>; <span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">mx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Ztrunc_floor">Ztrunc_floor</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_pos">Rmult_le_pos</a></span>; [<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>|<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_ge_0">bpow_ge_0</a></span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_le">Req_le</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.DiscrR.html#IZR_eq">IZR_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor_imp">Zfloor_imp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>; [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_pos">Rmult_le_pos</a></span>; [<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>|<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_ge_0">bpow_ge_0</a></span>]|<span class="tactic">simpl</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_r">Rmult_lt_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)))); [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span>; <span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (2 * <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>))));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_le">bpow_le</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> 2%<span class="id">Z</span> <span class="kwd">with</span> (1 + 1)%<span class="id">Z</span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zmult_plus_distr_l">Zmult_plus_distr_l</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zmult_1_l">Zmult_1_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_plus">bpow_plus</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_def">sqrt_def</a></span> <span class="id">x</span>) <span class="tactic">at</span> 1; [|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span> &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>))));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rmult_lt_compat">Rmult_lt_compat</a></span>; [<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_pos">sqrt_pos</a></span>|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_pos">sqrt_pos</a></span>| |]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hr</span>); <span class="tactic">rewrite</span> <span class="id">Za</span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_0_l">Rplus_0_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">b</span>'; <span class="id">change</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> <span class="id">_</span>) <span class="kwd">with</span> <span class="id">u1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (/ 2 * (<span class="id">u1</span> + <span class="id">u1</span>)); [|<span class="id">lra</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_lt_compat_l">Rmult_lt_compat_l</a></span>; [<span class="id">lra</span>|]; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_lt_compat_l">Rplus_lt_compat_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">u2</span>, <span class="id">u1</span>, <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_lt">bpow_lt</a></span>; <span class="tactic">omega</span>.<br/>
- <span class="comment">(*&nbsp;a&nbsp;&lt;&gt;&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Pa</span> : 0 &lt; <span class="id">a</span>); [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hla</span> : (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">a</span> = <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>) :&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>)).<br/>
&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id">a</span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#mag_DN">mag_DN</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">exact</span> <span class="id">Vfexp1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="id">fold</span> <span class="id">a</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hl</span>' : 0 &lt; - (<span class="id">u2</span> * <span class="id">a</span>) + <span class="id">b</span> * <span class="id">b</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_reg_r">Rplus_lt_reg_r</a></span> (<span class="id">u2</span> * <span class="id">a</span>)); <span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">b</span>; <span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_reg_r">Rplus_lt_reg_r</a></span> (/ 2 * <span class="id">u2</span> * <span class="id">u1</span>)); <span class="id">field_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">_</span> / 2) <span class="kwd">with</span> (<span class="id">u2</span> * (<span class="id">a</span> + / 2 * <span class="id">u1</span>)) <span class="tactic">by</span> <span class="id">field</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">_</span> / 8) <span class="kwd">with</span> (/ 4 * (<span class="id">u2</span> ^ 2 + <span class="id">u1</span> ^ 2)) <span class="tactic">by</span> <span class="id">field</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (<span class="id">u2</span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_lt_compat_l">Rmult_lt_compat_l</a></span>; [<span class="id">now</span> <span class="tactic">unfold</span> <span class="id">u2</span>, <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">u1</span>; <span class="tactic">rewrite</span> &lt;- <span class="id">Hla</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (<span class="id">a</span> + <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_lt_compat_l">Rplus_lt_compat_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span> (<span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp_neq_0">ulp_neq_0</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_compat_r">Rmult_lt_compat_r</a></span>; [<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|<span class="id">lra</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Ulp.html#id_p_ulp_le_bpow">id_p_ulp_le_bpow</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Pa</span> <span class="id">Fa</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rabs_lt_inv">Rabs_lt_inv</a></span>, <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_mag_gt">bpow_mag_gt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- 1) * <span class="id">u1</span> ^ 2).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpow_def.html#pow">pow</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_1_r">Rmult_1_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">u1</span>, <span class="id">u2</span>, <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="id">bpow_simplify</span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_le">bpow_le</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">Hexp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat">Rmult_le_compat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_ge_0">bpow_ge_0</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ratan.html#pow2_ge_0">pow2_ge_0</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow">Raux.bpow</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pow_pos">Z.pow_pos</a></span>; <span class="tactic">simpl</span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zmult_1_r">Zmult_1_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rinv_le">Rinv_le</a></span>; [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#IZR_le">IZR_le</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_0_l">Rplus_0_l</a></span> (<span class="id">u1</span> ^ 2)) <span class="tactic">at</span> 1; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat_r">Rplus_le_compat_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ratan.html#pow2_ge_0">pow2_ge_0</a></span>. }<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hr</span>' : <span class="id">x</span> &lt;= <span class="id">a</span> * <span class="id">a</span> + <span class="id">u1</span> * <span class="id">a</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">rewrite</span> <span class="id">Hla</span> <span class="kwd">in</span> <span class="id">Fa</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_plus_distr_r">Rmult_plus_distr_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">u1</span>, <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> <span class="id">_</span>)); <span class="tactic">rewrite</span> <span class="id">Fa</span>; <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_plus_distr_r">Rmult_plus_distr_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>; <span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span> <span class="id">_</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id">ma</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id">ma</span>)); <span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_reg_r">Rmult_le_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- 2 * <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>)))));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|<span class="id">bpow_simplify</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Fx</span> <span class="tactic">at</span> 1; <span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Raux.html#IZR_Zpower">IZR_Zpower</a></span>; [|<span class="tactic">omega</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#plus_IZR">plus_IZR</a></span>, &lt;- 2!<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mult_IZR">mult_IZR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#IZR_le">IZR_le</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zlt_succ_le">Zlt_succ_le</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#lt_IZR">lt_IZR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.succ">Z.succ</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#plus_IZR">plus_IZR</a></span>; <span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mult_IZR">mult_IZR</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#plus_IZR">plus_IZR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#IZR_Zpower">IZR_Zpower</a></span>; [|<span class="tactic">omega</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_r">Rmult_lt_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (2 * <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>)))));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|<span class="id">bpow_simplify</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Fx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> 2%<span class="id">Z</span> <span class="kwd">with</span> (1 + 1)%<span class="id">Z</span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zmult_plus_distr_l">Zmult_plus_distr_l</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zmult_1_l">Zmult_1_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_plus">bpow_plus</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">_</span> * <span class="id">_</span>) <span class="kwd">with</span> (<span class="id">a</span> * <span class="id">a</span> + <span class="id">u1</span> * <span class="id">a</span> + <span class="id">u1</span> * <span class="id">u1</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="tactic">unfold</span> <span class="id">u1</span>, <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="tactic">rewrite</span> <span class="id">Fa</span>; <span class="tactic">ring</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hsr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_assoc">Rplus_assoc</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_lt_compat_l">Rplus_lt_compat_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_reg_r">Rplus_lt_reg_r</a></span> (- <span class="id">b</span>' * <span class="id">b</span>' + / 2 * <span class="id">u1</span> * <span class="id">u2</span>)); <span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">_</span> + <span class="id">_</span>) <span class="kwd">with</span> ((<span class="id">a</span> + / 2 * <span class="id">u1</span>) * <span class="id">u2</span>) <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>)) * <span class="id">u2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_compat_r">Rmult_lt_compat_r</a></span>; [<span class="id">now</span> <span class="tactic">unfold</span> <span class="id">u2</span>, <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (<span class="id">a</span> + <span class="id">u1</span>); [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">u1</span>; <span class="id">fold</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp_DN">cexp_DN</a></span>; [|<span class="tactic">exact</span> <span class="id">Vfexp1</span>|<span class="tactic">exact</span> <span class="id">Pa</span>]; <span class="id">fold</span> <span class="id">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp_neq_0">ulp_neq_0</a></span>; <span class="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Ulp.html#id_p_ulp_le_bpow">id_p_ulp_le_bpow</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">exact</span> <span class="id">Pa</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_DN_pt">round_DN_pt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_DN_pt">round_DN_pt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rabs_lt_inv">Rabs_lt_inv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_mag_gt">bpow_mag_gt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (/ 2 * <span class="id">u1</span> ^ 2).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- 1) * <span class="id">u1</span> ^ 2).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpow_def.html#pow">pow</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_1_r">Rmult_1_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">u2</span>, <span class="id">u1</span>, <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_le">bpow_le</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zplus_comm">Zplus_comm</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">Hexp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_r">Rmult_le_compat_r</a></span>; [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ratan.html#pow2_ge_0">pow2_ge_0</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow">Raux.bpow</a></span>; <span class="tactic">simpl</span>; <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pow_pos">Z.pow_pos</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zmult_1_r">Zmult_1_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rinv_le">Rinv_le</a></span>; [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#IZR_le">IZR_le</a></span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">assert</span> (<span class="id">u2</span> ^ 2 &lt; <span class="id">u1</span> ^ 2); [|<span class="tactic">unfold</span> <span class="id">b</span>'; <span class="id">lra</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rpow_def.html#pow">pow</a></span>; <span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_1_r">Rmult_1_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">H</span>' : 0 &lt;= <span class="id">u2</span>); [<span class="tactic">unfold</span> <span class="id">u2</span>, <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_ge_0">bpow_ge_0</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">u2</span> &lt; <span class="id">u1</span>); [|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rmult_lt_compat">Rmult_lt_compat</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">u1</span>, <span class="id">u2</span>, <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_lt">bpow_lt</a></span>; <span class="tactic">omega</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_irrefl">Rlt_irrefl</a></span> (<span class="id">a</span> * <span class="id">a</span> + <span class="id">u1</span> * <span class="id">a</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (<span class="id">a</span> * <span class="id">a</span> + <span class="id">u1</span> * <span class="id">a</span> - <span class="id">u2</span> * <span class="id">a</span> + <span class="id">b</span> * <span class="id">b</span>).<br/>
&nbsp;&nbsp;+ <span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_0_r">Rplus_0_r</a></span> (<span class="id">a</span> * <span class="id">a</span> + <span class="id">_</span>)) <span class="tactic">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rminus">Rminus</a></span>; <span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_assoc">Rplus_assoc</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id">b</span> * <span class="id">b</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_lt_compat_l">Rplus_lt_compat_l</a></span>.<br/>
&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> <span class="id">x</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_sqrt_radix_ge_4">round_round_sqrt_radix_ge_4</a></span> :<br/>
&nbsp;&nbsp;(4 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">choice1</span> <span class="id">choice2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_sqrt_radix_ge_4_hyp">round_round_sqrt_radix_ge_4_hyp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6318')">Proof.</div>
<div class="proofscript" id="proof6318">
<span class="tactic">intros</span> <span class="id">Hbeta</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Vfexp1</span> <span class="id">Vfexp2</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Hexp</span> <span class="id">x</span> <span class="id">Fx</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_or_lt">Rle_or_lt</a></span> <span class="id">x</span> 0) <span class="kwd">as</span> [<span class="id">Npx</span>|<span class="id">Px</span>].<br/>
- <span class="comment">(*&nbsp;x&nbsp;&lt;=&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hs</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span> = 0).<br/>
&nbsp;&nbsp;{ <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_dec">Req_dec</a></span> <span class="id">x</span> 0) <span class="kwd">as</span> [<span class="id">Zx</span>|<span class="id">Nzx</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;x&nbsp;=&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Zx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exact</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_0">sqrt_0</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;x&nbsp;&lt;&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rcase_abs">Rcase_abs</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">casetype</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>; <span class="id">lra</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hs</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_0">round_0</a></span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_rnd_N">valid_rnd_N</a></span>.<br/>
- <span class="comment">(*&nbsp;0&nbsp;&lt;&nbsp;x&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hfx</span> : (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)%<span class="id">Z</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#mag_generic_gt">mag_generic_gt</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>; <span class="id">lra</span>|].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hfsx</span> : (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>)) &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>))%<span class="id">Z</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_or_lt">Rle_or_lt</a></span> <span class="id">x</span> 1) <span class="kwd">as</span> [<span class="id">Hx</span>|<span class="id">Hx</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;x&nbsp;&lt;=&nbsp;1&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_exp_large">valid_exp_large</a></span> <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)); [<span class="tactic">exact</span> <span class="id">Hfx</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#mag_le">mag_le</a></span>; [<span class="tactic">exact</span> <span class="id">Px</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_def">sqrt_def</a></span> <span class="id">x</span>) <span class="tactic">at</span> 1; [|<span class="id">lra</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_1_r">Rmult_1_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_l">Rmult_le_compat_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_pos">sqrt_pos</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_1">sqrt_1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_le_1_alt">sqrt_le_1_alt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;1&nbsp;&lt;&nbsp;x&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> ((<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj2">proj2</a></span> <span class="id">Hexp</span>)) 1%<span class="id">Z</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">_</span> - 1)%<span class="id">Z</span> <span class="kwd">with</span> 1%<span class="id">Z</span> <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">Hexp10</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hf0</span> : (<span class="id">fexp1</span> 1 &lt; 1)%<span class="id">Z</span>); [<span class="tactic">omega</span>|<span class="tactic">clear</span> <span class="id">Hexp10</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_exp_large">valid_exp_large</a></span> <span class="id">fexp1</span> 1); [<span class="tactic">exact</span> <span class="id">Hf0</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#mag_ge_bpow">mag_ge_bpow</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zeq_minus">Zeq_minus</a></span>; [|<span class="tactic">reflexivity</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow">Raux.bpow</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rabs_ge">Rabs_ge</a></span>; <span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_1">sqrt_1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_le_1_alt">sqrt_le_1_alt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>. }<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hf2</span> : (<span class="id">fexp2</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>)) &lt;= <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>)) - 1)%<span class="id">Z</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">assert</span> (<span class="id">H</span> : (<span class="id">fexp1</span> (2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>)) &lt; 2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>))%<span class="id">Z</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag_sqrt_disj">mag_sqrt_disj</a></span> <span class="id">x</span> <span class="id">Px</span>) <span class="kwd">as</span> [<span class="id">Hlx</span>|<span class="id">Hlx</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_exp_large">valid_exp_large</a></span> <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)); [|<span class="tactic">omega</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#mag_generic_gt">mag_generic_gt</a></span>; [|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> &lt;- <span class="id">Hlx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#mag_generic_gt">mag_generic_gt</a></span>; [|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>|]. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> ((<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj2">proj2</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj2">proj2</a></span> <span class="id">Hexp</span>)) (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id">x</span>)) <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_mid_cases">round_round_mid_cases</a></span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">exact</span> <span class="id">Vfexp1</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">exact</span> <span class="id">Vfexp2</span>.<br/>
&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt_lt_R0">sqrt_lt_R0</a></span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">intros</span> <span class="id">Hmid</span>; <span class="id">casetype</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>; <span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_not_lt">Rle_not_lt</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hmid</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_sqrt_radix_ge_4_aux">round_round_sqrt_radix_ge_4_aux</a></span> <span class="id">Hbeta</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Vfexp1</span> <span class="id">Vfexp2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hexp</span> <span class="id">x</span> <span class="id">Px</span> <span class="id">Hf2</span> <span class="id">Fx</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FLX">Double_round_sqrt_radix_ge_4_FLX</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FLX.prec">prec</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id">prec</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<br/>
<span class="kwd">Context</span> { <span class="id">prec_gt_0_</span> : <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FLX.prec">prec</a></span> }.<br/>
<span class="kwd">Context</span> { <span class="id">prec_gt_0_</span>' : <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="id">prec</span>' }.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="FLX_round_round_sqrt_radix_ge_4_hyp">FLX_round_round_sqrt_radix_ge_4_hyp</a></span> :<br/>
&nbsp;&nbsp;(2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FLX.prec">prec</a></span> + 1 &lt;= <span class="id">prec</span>')%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_sqrt_radix_ge_4_hyp">round_round_sqrt_radix_ge_4_hyp</a></span> (<span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp">FLX_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FLX.prec">prec</a></span>) (<span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp">FLX_exp</a></span> <span class="id">prec</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6319')">Proof.</div>
<div class="proofscript" id="proof6319">
<span class="tactic">intros</span> <span class="id">Hprec</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp">FLX_exp</a></span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="kwd">in</span> <span class="id">prec_gt_0_</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_sqrt_radix_ge_4_hyp">round_round_sqrt_radix_ge_4_hyp</a></span>; <span class="tactic">split</span>; [|<span class="tactic">split</span>]; <span class="tactic">intro</span> <span class="id">ex</span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="round_round_sqrt_radix_ge_4_FLX">round_round_sqrt_radix_ge_4_FLX</a></span> :<br/>
&nbsp;&nbsp;(4 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">choice1</span> <span class="id">choice2</span>,<br/>
&nbsp;&nbsp;(2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FLX.prec">prec</a></span> + 1 &lt;= <span class="id">prec</span>')%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_format">FLX_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FLX.prec">prec</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> (<span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp">FLX_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FLX.prec">prec</a></span>) (<span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp">FLX_exp</a></span> <span class="id">prec</span>') <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6320')">Proof.</div>
<div class="proofscript" id="proof6320">
<span class="tactic">intros</span> <span class="id">Hbeta</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Hprec</span> <span class="id">x</span> <span class="id">Fx</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_sqrt_radix_ge_4">round_round_sqrt_radix_ge_4</a></span>.<br/>
- <span class="tactic">exact</span> <span class="id">Hbeta</span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp_valid">FLX_exp_valid</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp_valid">FLX_exp_valid</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#FLX_round_round_sqrt_radix_ge_4_hyp">FLX_round_round_sqrt_radix_ge_4_hyp</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#generic_format_FLX">generic_format_FLX</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FLX">Double_round_sqrt_radix_ge_4_FLX</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FLT">Double_round_sqrt_radix_ge_4_FLT</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FLT.emin">emin</a></span> <span class="id"><a name="Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FLT.prec">prec</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id">emin</span>' <span class="id">prec</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<br/>
<span class="kwd">Context</span> { <span class="id">prec_gt_0_</span> : <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FLT.prec">prec</a></span> }.<br/>
<span class="kwd">Context</span> { <span class="id">prec_gt_0_</span>' : <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="id">prec</span>' }.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="FLT_round_round_sqrt_radix_ge_4_hyp">FLT_round_round_sqrt_radix_ge_4_hyp</a></span> :<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FLT.emin">emin</a></span> &lt;= 0)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;((<span class="id">emin</span>' &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FLT.emin">emin</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FLT.prec">prec</a></span> - 1)%<span class="id">Z</span><br/>
&nbsp;&nbsp;&nbsp;\/ (2 * <span class="id">emin</span>' &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FLT.emin">emin</a></span> - 4 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FLT.prec">prec</a></span>)%<span class="id">Z</span>) -&gt;<br/>
&nbsp;&nbsp;(2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FLT.prec">prec</a></span> + 1 &lt;= <span class="id">prec</span>')%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_sqrt_radix_ge_4_hyp">round_round_sqrt_radix_ge_4_hyp</a></span> (<span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp">FLT_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FLT.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FLT.prec">prec</a></span>) (<span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp">FLT_exp</a></span> <span class="id">emin</span>' <span class="id">prec</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6321')">Proof.</div>
<div class="proofscript" id="proof6321">
<span class="tactic">intros</span> <span class="id">Hemin</span> <span class="id">Heminprec</span> <span class="id">Hprec</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp">FLT_exp</a></span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="kwd">in</span> <span class="id">prec_gt_0_</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_sqrt_radix_ge_4_hyp">round_round_sqrt_radix_ge_4_hyp</a></span>; <span class="tactic">split</span>; [|<span class="tactic">split</span>]; <span class="tactic">intros</span> <span class="id">ex</span>.<br/>
- <span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ex</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FLT.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FLT.emin">emin</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (2 * <span class="id">ex</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FLT.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FLT.emin">emin</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
- <span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ex</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FLT.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FLT.emin">emin</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (2 * <span class="id">ex</span> - 1 - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FLT.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FLT.emin">emin</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
- <span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (2 * <span class="id">ex</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FLT.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FLT.emin">emin</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ex</span> - <span class="id">prec</span>') <span class="id">emin</span>').<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ex</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FLT.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FLT.emin">emin</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="round_round_sqrt_radix_ge_4_FLT">round_round_sqrt_radix_ge_4_FLT</a></span> :<br/>
&nbsp;&nbsp;(4 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">choice1</span> <span class="id">choice2</span>,<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FLT.emin">emin</a></span> &lt;= 0)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;((<span class="id">emin</span>' &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FLT.emin">emin</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FLT.prec">prec</a></span> - 1)%<span class="id">Z</span><br/>
&nbsp;&nbsp;&nbsp;\/ (2 * <span class="id">emin</span>' &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FLT.emin">emin</a></span> - 4 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FLT.prec">prec</a></span>)%<span class="id">Z</span>) -&gt;<br/>
&nbsp;&nbsp;(2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FLT.prec">prec</a></span> + 1 &lt;= <span class="id">prec</span>')%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_format">FLT_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FLT.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FLT.prec">prec</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> (<span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp">FLT_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FLT.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FLT.prec">prec</a></span>) (<span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp">FLT_exp</a></span> <span class="id">emin</span>' <span class="id">prec</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6322')">Proof.</div>
<div class="proofscript" id="proof6322">
<span class="tactic">intros</span> <span class="id">Hbeta</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Hemin</span> <span class="id">Heminprec</span> <span class="id">Hprec</span> <span class="id">x</span> <span class="id">Fx</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_sqrt_radix_ge_4">round_round_sqrt_radix_ge_4</a></span>.<br/>
- <span class="tactic">exact</span> <span class="id">Hbeta</span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp_valid">FLT_exp_valid</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp_valid">FLT_exp_valid</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#FLT_round_round_sqrt_radix_ge_4_hyp">FLT_round_round_sqrt_radix_ge_4_hyp</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLT.html#generic_format_FLT">generic_format_FLT</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FLT">Double_round_sqrt_radix_ge_4_FLT</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FTZ">Double_round_sqrt_radix_ge_4_FTZ</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FTZ.emin">emin</a></span> <span class="id"><a name="Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FTZ.prec">prec</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id">emin</span>' <span class="id">prec</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<br/>
<span class="kwd">Context</span> { <span class="id">prec_gt_0_</span> : <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FTZ.prec">prec</a></span> }.<br/>
<span class="kwd">Context</span> { <span class="id">prec_gt_0_</span>' : <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="id">prec</span>' }.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="FTZ_round_round_sqrt_radix_ge_4_hyp">FTZ_round_round_sqrt_radix_ge_4_hyp</a></span> :<br/>
&nbsp;&nbsp;(2 * (<span class="id">emin</span>' + <span class="id">prec</span>') &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FTZ.emin">emin</a></span> + <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FTZ.prec">prec</a></span> &lt;= 1)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;(2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FTZ.prec">prec</a></span> + 1 &lt;= <span class="id">prec</span>')%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_sqrt_radix_ge_4_hyp">round_round_sqrt_radix_ge_4_hyp</a></span> (<span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp">FTZ_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FTZ.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FTZ.prec">prec</a></span>) (<span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp">FTZ_exp</a></span> <span class="id">emin</span>' <span class="id">prec</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6323')">Proof.</div>
<div class="proofscript" id="proof6323">
<span class="tactic">intros</span> <span class="id">Hemin</span> <span class="id">Hprec</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp">FTZ_exp</a></span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="kwd">in</span> *.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_sqrt_radix_ge_4_hyp">round_round_sqrt_radix_ge_4_hyp</a></span>; <span class="tactic">split</span>; [|<span class="tactic">split</span>]; <span class="tactic">intros</span> <span class="id">ex</span>.<br/>
- <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ex</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FTZ.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FTZ.emin">emin</a></span>);<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (2 * <span class="id">ex</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FTZ.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FTZ.emin">emin</a></span>);<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
- <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ex</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FTZ.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FTZ.emin">emin</a></span>);<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (2 * <span class="id">ex</span> - 1 - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FTZ.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FTZ.emin">emin</a></span>);<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
- <span class="tactic">intro</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zle_or_lt">Zle_or_lt</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FTZ.emin">emin</a></span> (2 * <span class="id">ex</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FTZ.prec">prec</a></span>)) <span class="kwd">as</span> [<span class="id">H</span>'|<span class="id">H</span>'].<br/>
&nbsp;&nbsp;+ <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ex</span> - <span class="id">prec</span>') <span class="id">emin</span>');<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ex</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FTZ.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FTZ.emin">emin</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;+ <span class="id">casetype</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.flocq.Core.Zaux.html#Zlt_bool_true">Zlt_bool_true</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>') <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="round_round_sqrt_radix_ge_4_FTZ">round_round_sqrt_radix_ge_4_FTZ</a></span> :<br/>
&nbsp;&nbsp;(4 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">choice1</span> <span class="id">choice2</span>,<br/>
&nbsp;&nbsp;(2 * (<span class="id">emin</span>' + <span class="id">prec</span>') &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FTZ.emin">emin</a></span> + <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FTZ.prec">prec</a></span> &lt;= 1)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;(2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FTZ.prec">prec</a></span> + 1 &lt;= <span class="id">prec</span>')%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_format">FTZ_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FTZ.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FTZ.prec">prec</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> (<span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp">FTZ_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FTZ.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FTZ.prec">prec</a></span>) (<span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp">FTZ_exp</a></span> <span class="id">emin</span>' <span class="id">prec</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.R_sqrt.html#sqrt">sqrt</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6324')">Proof.</div>
<div class="proofscript" id="proof6324">
<span class="tactic">intros</span> <span class="id">Hbeta</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Hemin</span> <span class="id">Hprec</span> <span class="id">x</span> <span class="id">Fx</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_sqrt_radix_ge_4">round_round_sqrt_radix_ge_4</a></span>.<br/>
- <span class="tactic">exact</span> <span class="id">Hbeta</span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp_valid">FTZ_exp_valid</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp_valid">FTZ_exp_valid</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#FTZ_round_round_sqrt_radix_ge_4_hyp">FTZ_round_round_sqrt_radix_ge_4_hyp</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FTZ.html#generic_format_FTZ">generic_format_FTZ</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4.Double_round_sqrt_radix_ge_4_FTZ">Double_round_sqrt_radix_ge_4_FTZ</a></span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt.Double_round_sqrt_radix_ge_4">Double_round_sqrt_radix_ge_4</a></span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_sqrt">Double_round_sqrt</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Double_round.Double_round_div">Double_round_div</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_eq_mid_beta_even">round_round_eq_mid_beta_even</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">choice1</span> <span class="id">choice2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>),<br/>
&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">n</span>, (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> = 2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#n">n</a></span> :&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>)%<span class="id">Z</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) - 1)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#midp">midp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6325')">Proof.</div>
<div class="proofscript" id="proof6325">
<span class="tactic">intros</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Vfexp1</span> <span class="id">Vfexp2</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Ebeta</span> <span class="id">x</span> <span class="id">Px</span> <span class="id">Hf2</span> <span class="id">Hf1</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#midp">midp</a></span>.<br/>
<span class="tactic">set</span> (<span class="id">rd</span> := <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> <span class="id">x</span>).<br/>
<span class="tactic">set</span> (<span class="id">u</span> := <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id">x</span>).<br/>
<span class="tactic">intro</span> <span class="id">H</span>; <span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_eq_compat_l">Rplus_eq_compat_l</a></span> (- <span class="id">rd</span>)) <span class="kwd">in</span> <span class="id">H</span>.<br/>
<span class="id">ring_simplify</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">revert</span> <span class="id">H</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_comm">Rplus_comm</a></span>; <span class="id">fold</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rminus">Rminus</a></span> <span class="id">x</span> <span class="id">rd</span>).<br/>
<span class="tactic">intro</span> <span class="id">Xmid</span>.<br/>
<span class="tactic">destruct</span> <span class="id">Ebeta</span> <span class="kwd">as</span> (<span class="id">n</span>,<span class="id">Ebeta</span>).<br/>
<span class="tactic">assert</span> (<span class="id">Hbeta</span> : (2 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span>)%<span class="id">Z</span>).<br/>
{ <span class="tactic">destruct</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="kwd">as</span> (<span class="id">beta_val</span>,<span class="id">beta_prop</span>).<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zle_bool_imp_le">Zle_bool_imp_le</a></span>. }<br/>
<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_eq_compat_l">Rplus_eq_compat_l</a></span> <span class="id">rd</span>) <span class="kwd">in</span> <span class="id">Xmid</span>; <span class="id">ring_simplify</span> <span class="kwd">in</span> <span class="id">Xmid</span>.<br/>
<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_generic">round_generic</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span>); [<span class="tactic">reflexivity</span>|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_rnd_N">valid_rnd_N</a></span>|].<br/>
<span class="tactic">set</span> (<span class="id">f</span> := <span class="id"><a href="compcert.flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span> <span class="id">rd</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">n</span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> ^ (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) - 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">fexp2</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span> <span class="id">x</span>)).<br/>
<span class="tactic">assert</span> (<span class="id">Hf</span> : <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span> <span class="id">f</span> = <span class="id">x</span>).<br/>
{ <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rtopology.html#f">f</a></span>, <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#plus_IZR">plus_IZR</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_plus_distr_r">Rmult_plus_distr_r</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mult_IZR">mult_IZR</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#IZR_Zpower">IZR_Zpower</a></span>; [|<span class="tactic">omega</span>].<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="tactic">at</span> 2; <span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.sub">Zminus</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_plus">bpow_plus</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span> <span class="id">_</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- 1))).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id">n</span>)).<br/>
&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- 1)) <span class="kwd">with</span> (/ <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> * 1)).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zmult_1_r">Zmult_1_r</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Ebeta</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mult_IZR">mult_IZR</a></span> 2).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_mult_distr">Rinv_mult_distr</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="tactic">simpl</span>; <span class="id">lra</span> | <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#IZR_neq">IZR_neq</a></span>; <span class="tactic">omega</span>].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>; <span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id">n</span>));<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span> <span class="id">_</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id">n</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_r">Rinv_r</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_1_r">Rmult_1_r</a></span> | <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#IZR_neq">IZR_neq</a></span>; <span class="tactic">omega</span>].<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="id">fold</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- 2!<span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp_neq_0">ulp_neq_0</a></span>; <span class="tactic">try</span> <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="id">fold</span> <span class="id">u</span>; <span class="tactic">rewrite</span> <span class="id">Xmid</span> <span class="tactic">at</span> 2.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#f_equal2">f_equal2</a></span>; [|<span class="tactic">reflexivity</span>].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp_neq_0">ulp_neq_0</a></span>; <span class="tactic">try</span> <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_dec">Req_dec</a></span> <span class="id">rd</span> 0) <span class="kwd">as</span> [<span class="id">Zrd</span>|<span class="id">Nzrd</span>].<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;rd&nbsp;=&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Zrd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa_0">scaled_mantissa_0</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor_IZR">Zfloor_IZR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_l">Rmult_0_l</a></span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;rd&nbsp;&lt;&gt;&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Nnrd</span> : 0 &lt;= <span class="id">rd</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_DN_pt">round_DN_pt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">exact</span> <span class="id">Vfexp1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format_0">generic_format_0</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Prd</span> : 0 &lt; <span class="id">rd</span>); [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Lrd</span> : (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">rd</span> = <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> :&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zle_antisym">Zle_antisym</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#mag_le">mag_le</a></span>; [<span class="tactic">exact</span> <span class="id">Prd</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_DN_pt">round_DN_pt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#mag_round_ge">mag_round_ge</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">exact</span> <span class="id">Vfexp1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_rnd_DN">valid_rnd_DN</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">exact</span> <span class="id">Nzrd</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">rd</span> <span class="tactic">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span>, <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Lrd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="compcert.flocq.Core.Raux.html#IZR_Zpower">IZR_Zpower</a></span> <span class="id">_</span> (<span class="id">_</span> - <span class="id">_</span>)); [|<span class="tactic">omega</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mult_IZR">mult_IZR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor_imp">Zfloor_imp</a></span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> (<span class="id">x</span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))) *<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> ^ (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) - <span class="id">fexp2</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mult_IZR">mult_IZR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#IZR_Zpower">IZR_Zpower</a></span>; [|<span class="tactic">omega</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">unfold</span> <span class="id">rd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">split</span>; [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_refl">Rle_refl</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#plus_IZR">plus_IZR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="id">lra</span>. }<br/>
<span class="tactic">apply</span> (<span class="id">generic_format_F2R</span>' <span class="id">_</span> <span class="id">_</span> <span class="id">x</span> <span class="id">f</span> <span class="id">Hf</span>).<br/>
<span class="tactic">intros</span> <span class="id">_</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_refl">Z.le_refl</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_really_zero">round_round_really_zero</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">choice1</span> <span class="id">choice2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>),<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) - 2)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6326')">Proof.</div>
<div class="proofscript" id="proof6326">
<span class="tactic">intros</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Vfexp1</span> <span class="id">Vfexp2</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">x</span> <span class="id">Px</span> <span class="id">Hf1</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Hlx</span> : <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> - 1) &lt;= <span class="id">x</span> &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)).<br/>
{ <span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) <span class="kwd">as</span> (<span class="id">ex</span>,<span class="id">Hex</span>); <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span> <span class="id">x</span>); [|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_ge">Rle_ge</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hex</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>. }<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span>.<br/>
<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_N_small_pos">round_N_small_pos</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id">_</span> <span class="id">x</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)); [|<span class="tactic">exact</span> <span class="id">Hlx</span>|<span class="tactic">omega</span>].<br/>
<span class="tactic">set</span> (<span class="id">x</span>'' := <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Znearest">Znearest</a></span> <span class="id">choice2</span>) <span class="id">x</span>).<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_dec">Req_dec</a></span> <span class="id">x</span>'' 0) <span class="kwd">as</span> [<span class="id">Zx</span>''|<span class="id">Nzx</span>''];<br/>
&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">Zx</span>''; <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_0">round_0</a></span>; [|<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_rnd_N">valid_rnd_N</a></span>]|].<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zle_or_lt">Zle_or_lt</a></span> (<span class="id">fexp2</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)) (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)).<br/>
- <span class="comment">(*&nbsp;fexp2&nbsp;(mag&nbsp;x)&nbsp;&lt;=&nbsp;mag&nbsp;x&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_or_le">Rlt_or_le</a></span> <span class="id">x</span>'' (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))).<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;x''&nbsp;&lt;&nbsp;bpow&nbsp;(mag&nbsp;x)&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_N_small_pos">round_N_small_pos</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="tactic">reflexivity</span>|<span class="tactic">split</span>; [|<span class="tactic">exact</span> <span class="id">H0</span>]|<span class="tactic">omega</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_large_pos_ge_bpow">round_large_pos_ge_bpow</a></span>; [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_rnd_N">valid_rnd_N</a></span>| |<span class="id">now</span> <span class="tactic">apply</span> <span class="id">Hlx</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fold</span> <span class="id">x</span>''; <span class="tactic">assert</span> (0 &lt;= <span class="id">x</span>''); [|<span class="id">lra</span>]; <span class="tactic">unfold</span> <span class="id">x</span>''.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_0">round_0</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Znearest">Znearest</a></span> <span class="id">choice2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_le">round_le</a></span>; [|<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_rnd_N">valid_rnd_N</a></span>|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>].<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;bpow&nbsp;(mag&nbsp;x)&nbsp;&lt;=&nbsp;x''&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hx</span>'' : <span class="id">x</span>'' = <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_antisym">Rle_antisym</a></span>; [|<span class="tactic">exact</span> <span class="id">H0</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_generic">round_generic</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Znearest">Znearest</a></span> <span class="id">choice2</span>) (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_le">round_le</a></span>; [|<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_rnd_N">valid_rnd_N</a></span>|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="tactic">apply</span> <span class="id">generic_format_bpow</span>'. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hx</span>''.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span>, <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#mag_bpow">mag_bpow</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hf11</span> : (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> + 1) = <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) :&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>)%<span class="id">Z</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="tactic">apply</span> <span class="id">Vfexp1</span>; <span class="tactic">omega</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hf11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_eq_reg_r">Rmult_eq_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_l">Rmult_0_l</a></span>; <span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.DiscrR.html#IZR_eq">IZR_eq</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Znearest_imp">Znearest_imp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rminus">Rminus</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_0">Ropp_0</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_0_r">Rplus_0_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span>; [|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_ge">Rle_ge</a></span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_ge_0">bpow_ge_0</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- 2)); [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_le">bpow_le</a></span>; <span class="tactic">omega</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow">Raux.bpow</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pow_pos">Z.pow_pos</a></span>; <span class="tactic">simpl</span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zmult_1_r">Zmult_1_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hbeta</span> : (2 &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span>)%<span class="id">Z</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">destruct</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="kwd">as</span> (<span class="id">beta_val</span>,<span class="id">beta_prop</span>); <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zle_bool_imp_le">Zle_bool_imp_le</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_lt_contravar">Rinv_lt_contravar</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>; [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mult_IZR">mult_IZR</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#IZR_lt">IZR_lt</a></span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#IZR_lt">IZR_lt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_lt_trans">Z.le_lt_trans</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hbeta</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zmult_1_r">Zmult_1_r</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span>) <span class="tactic">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zmult_lt_compat_l">Zmult_lt_compat_l</a></span>; <span class="tactic">omega</span>.<br/>
- <span class="comment">(*&nbsp;mag&nbsp;x&nbsp;&lt;&nbsp;fexp2&nbsp;(mag&nbsp;x)&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">casetype</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>; <span class="tactic">apply</span> <span class="id">Nzx</span>''.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_N_small_pos">round_N_small_pos</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_zero">round_round_zero</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">choice1</span> <span class="id">choice2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>),<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) = <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> + 1 :&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) - / 2 * <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6327')">Proof.</div>
<div class="proofscript" id="proof6327">
<span class="tactic">intros</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Vfexp1</span> <span class="id">Vfexp2</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">x</span> <span class="id">Px</span> <span class="id">Hf1</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span>.<br/>
<span class="tactic">set</span> (<span class="id">x</span>'' := <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Znearest">Znearest</a></span> <span class="id">choice2</span>) <span class="id">x</span>).<br/>
<span class="tactic">set</span> (<span class="id">u1</span> := <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id">x</span>).<br/>
<span class="tactic">set</span> (<span class="id">u2</span> := <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span> <span class="id">x</span>).<br/>
<span class="tactic">intro</span> <span class="id">Hx</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Hlx</span> : <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> - 1) &lt;= <span class="id">x</span> &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)).<br/>
{ <span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) <span class="kwd">as</span> (<span class="id">ex</span>,<span class="id">Hex</span>); <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span> <span class="id">x</span>); [|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_ge">Rle_ge</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hex</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>. }<br/>
<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_N_small_pos">round_N_small_pos</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id">choice1</span> <span class="id">x</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>));<br/>
&nbsp;&nbsp;[|<span class="tactic">exact</span> <span class="id">Hlx</span>|<span class="tactic">omega</span>].<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_dec">Req_dec</a></span> <span class="id">x</span>'' 0) <span class="kwd">as</span> [<span class="id">Zx</span>''|<span class="id">Nzx</span>''];<br/>
&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">Zx</span>''; <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_0">round_0</a></span>; [<span class="tactic">reflexivity</span>|<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_rnd_N">valid_rnd_N</a></span>]|].<br/>
<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_N_small_pos">round_N_small_pos</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">x</span>'' (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>));<br/>
&nbsp;&nbsp;[<span class="tactic">reflexivity</span>| |<span class="tactic">omega</span>].<br/>
<span class="tactic">split</span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_large_pos_ge_bpow">round_large_pos_ge_bpow</a></span>.<br/>
&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_rnd_N">valid_rnd_N</a></span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">assert</span> (0 &lt;= <span class="id">x</span>''); [|<span class="id">now</span> <span class="id">fold</span> <span class="id">x</span>''; <span class="id">lra</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_0">round_0</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Znearest">Znearest</a></span> <span class="id">choice2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_le">round_le</a></span>; [|<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_rnd_N">valid_rnd_N</a></span>|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>].<br/>
&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id">x</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span>; [<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_refl">Rle_refl</a></span>|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_ge">Rle_ge</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) <span class="kwd">as</span> (<span class="id">ex</span>,<span class="id">Hex</span>); <span class="tactic">simpl</span>; <span class="tactic">apply</span> <span class="id">Hex</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>.<br/>
- <span class="tactic">replace</span> <span class="id">x</span>'' <span class="kwd">with</span> (<span class="id">x</span> + (<span class="id">x</span>'' - <span class="id">x</span>)) <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> <span class="id">_</span>) <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) - / 2 * <span class="id">u2</span> + / 2 * <span class="id">u2</span>) <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_le_compat">Rplus_lt_le_compat</a></span>; [<span class="tactic">exact</span> <span class="id">Hx</span>|].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rabs_le_inv">Rabs_le_inv</a></span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Ulp.html#error_le_half_ulp">error_le_half_ulp</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_all_mid_cases">round_round_all_mid_cases</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">choice1</span> <span class="id">choice2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>),<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) - 1)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;((<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) = <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> + 1 :&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) - / 2 * <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) -&gt;<br/>
&nbsp;&nbsp;((<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#midp">midp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> - / 2 * <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#midp">midp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) -&gt;<br/>
&nbsp;&nbsp;((<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#midp">midp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) -&gt;<br/>
&nbsp;&nbsp;((<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#midp">midp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#midp">midp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> + / 2 * <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6328')">Proof.</div>
<div class="proofscript" id="proof6328">
<span class="tactic">intros</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Vfexp1</span> <span class="id">Vfexp2</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">x</span> <span class="id">Px</span> <span class="id">Hf2</span>.<br/>
<span class="tactic">set</span> (<span class="id">x</span>' := <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> <span class="id">x</span>).<br/>
<span class="tactic">set</span> (<span class="id">u1</span> := <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id">x</span>).<br/>
<span class="tactic">set</span> (<span class="id">u2</span> := <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span> <span class="id">x</span>).<br/>
<span class="tactic">intros</span> <span class="id">Cz</span> <span class="id">Clt</span> <span class="id">Ceq</span> <span class="id">Cgt</span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Ztrichotomy">Ztrichotomy</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) - 1)) <span class="kwd">as</span> [<span class="id">Hlt</span>|[<span class="id">Heq</span>|<span class="id">Hgt</span>]].<br/>
- <span class="comment">(*&nbsp;mag&nbsp;x&nbsp;&lt;&nbsp;fexp1&nbsp;(mag&nbsp;x)&nbsp;-&nbsp;1&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">H</span> : (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> &lt;= <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) - 2)%<span class="id">Z</span>) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_really_zero">round_round_really_zero</a></span>.<br/>
- <span class="comment">(*&nbsp;mag&nbsp;x&nbsp;=&nbsp;fexp1&nbsp;(mag&nbsp;x)&nbsp;-&nbsp;1&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">H</span> : (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) = (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> + 1))%<span class="id">Z</span>) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_or_le">Rlt_or_le</a></span> <span class="id">x</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) - / 2 * <span class="id">u2</span>)) <span class="kwd">as</span> [<span class="id">Hlt</span>'|<span class="id">Hge</span>'].<br/>
&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_zero">round_round_zero</a></span>.<br/>
&nbsp;&nbsp;+ <span class="id">now</span> <span class="tactic">apply</span> <span class="id">Cz</span>.<br/>
- <span class="comment">(*&nbsp;mag&nbsp;x&nbsp;&gt;&nbsp;fexp1&nbsp;(mag&nbsp;x)&nbsp;-&nbsp;1&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">H</span> : (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)%<span class="id">Z</span>) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rtotal_order">Rtotal_order</a></span> <span class="id">x</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#midp">midp</a></span> <span class="id">fexp1</span> <span class="id">x</span>)) <span class="kwd">as</span> [<span class="id">Hlt</span>'|[<span class="id">Heq</span>'|<span class="id">Hgt</span>']].<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;x&nbsp;&lt;&nbsp;midp&nbsp;fexp1&nbsp;x&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_or_le">Rlt_or_le</a></span> <span class="id">x</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#midp">midp</a></span> <span class="id">fexp1</span> <span class="id">x</span> - / 2 * <span class="id">u2</span>)) <span class="kwd">as</span> [<span class="id">Hlt</span>''|<span class="id">Hle</span>''].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_lt_mid_further_place">round_round_lt_mid_further_place</a></span>; [| | |<span class="tactic">omega</span>| |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">now</span> <span class="tactic">apply</span> <span class="id">Clt</span>; [|<span class="tactic">split</span>].<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;x&nbsp;=&nbsp;midp&nbsp;fexp1&nbsp;x&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id">Ceq</span>.<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;x&nbsp;&gt;&nbsp;midp&nbsp;fexp1&nbsp;x&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_or_lt">Rle_or_lt</a></span> <span class="id">x</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#midp">midp</a></span> <span class="id">fexp1</span> <span class="id">x</span> + / 2 * <span class="id">u2</span>)) <span class="kwd">as</span> [<span class="id">Hlt</span>''|<span class="id">Hle</span>''].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">now</span> <span class="tactic">apply</span> <span class="id">Cgt</span>; [|<span class="tactic">split</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* { <span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format_EM">generic_format_EM</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id">x</span>) <span class="kwd">as</span> [<span class="id">Fx</span>|<span class="id">Nfx</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;generic_format&nbsp;beta&nbsp;fexp1&nbsp;x&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span>; <span class="tactic">rewrite</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_generic">round_generic</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="tactic">reflexivity</span>|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_rnd_N">valid_rnd_N</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_inclusion_mag">generic_inclusion_mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span>); [<span class="tactic">omega</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;~&nbsp;generic_format&nbsp;beta&nbsp;fexp1&nbsp;x&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hceil</span> : <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zceil">Zceil</a></span> <span class="id">x</span> = <span class="id">x</span>' + <span class="id">u1</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Ulp.html#round_UP_DN_ulp">round_UP_DN_ulp</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Hf2</span>' : (<span class="id">fexp2</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) &lt;= <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) - 1)%<span class="id">Z</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="tactic">omega</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">midp</span>' <span class="id">fexp1</span> <span class="id">x</span> + / 2 * <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span> <span class="id">x</span> &lt; <span class="id">x</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_gt_mid_further_place">round_round_gt_mid_further_place</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">Hle</span>''; <span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#midp">midp</a></span>, <span class="id">midp</span>'; <span class="id">fold</span> <span class="id">x</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hceil</span>; <span class="id">fold</span> <span class="id">u1</span>; <span class="id">fold</span> <span class="id">u2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">lra</span>. }<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="mag_div_disj">mag_div_disj</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#R">R</a></span>,<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt; 0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;((<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> / <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>) = <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> :&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>)%<span class="id">Z</span><br/>
&nbsp;&nbsp;&nbsp;\/ (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> / <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>) = <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> + 1 :&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>)%<span class="id">Z</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6329')">Proof.</div>
<div class="proofscript" id="proof6329">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Px</span> <span class="id">Py</span>.<br/>
<span class="tactic">generalize</span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#mag_div">mag_div</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">x</span> <span class="id">y</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">Px</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">Py</span>)).<br/>
<span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_round_div_hyp">round_round_div_hyp</a></span> <span class="id">fexp1</span> <span class="id">fexp2</span> :=<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">ex</span>, (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> - 1)%<span class="id">Z</span>)<br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">ex</span> <span class="id">ey</span>, (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span>)%<span class="id">Z</span> -&gt; (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span> &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span>) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span> + 1)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span>) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span>)%<span class="id">Z</span>)<br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">ex</span> <span class="id">ey</span>, (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span>)%<span class="id">Z</span> -&gt; (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span> &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span> + 1) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span> + 1 + 1)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span> + 1) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span>)%<span class="id">Z</span>)<br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">ex</span> <span class="id">ey</span>, (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span>)%<span class="id">Z</span> -&gt; (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span> &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span>) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span>) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span>)%<span class="id">Z</span>)<br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">ex</span> <span class="id">ey</span>, (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span>)%<span class="id">Z</span> -&gt; (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span> &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span>) = <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span> + 1)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span>) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ex">ex</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span> + <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#ey">ey</a></span>)%<span class="id">Z</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_div_aux0">round_round_div_aux0</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">choice1</span> <span class="id">choice2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_div_hyp">round_round_div_hyp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt; 0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> / <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>)) = (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> / <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>) + 1)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;~ (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> / <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>)) - / 2 * <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> / <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> / <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6330')">Proof.</div>
<div class="proofscript" id="proof6330">
<span class="tactic">intros</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Vfexp1</span> <span class="id">Vfexp2</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Hexp</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Px</span> <span class="id">Py</span> <span class="id">Fx</span> <span class="id">Fy</span> <span class="id">Hf1</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Hfx</span> : (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)%<span class="id">Z</span>);<br/>
&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#mag_generic_gt">mag_generic_gt</a></span>; [|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>|]|].<br/>
<span class="tactic">assert</span> (<span class="id">Hfy</span> : (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>) &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>)%<span class="id">Z</span>);<br/>
&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#mag_generic_gt">mag_generic_gt</a></span>; [|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>|]|].<br/>
<span class="tactic">set</span> (<span class="id">p</span> := <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> / <span class="id">y</span>))).<br/>
<span class="tactic">set</span> (<span class="id">u2</span> := <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp2</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> / <span class="id">y</span>)))).<br/>
<span class="id">revert</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span>, <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="tactic">simpl</span>.<br/>
<span class="tactic">set</span> (<span class="id">mx</span> := <span class="id"><a href="compcert.flocq.Core.Raux.html#Ztrunc">Ztrunc</a></span> (<span class="id">x</span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)))).<br/>
<span class="tactic">set</span> (<span class="id">my</span> := <span class="id"><a href="compcert.flocq.Core.Raux.html#Ztrunc">Ztrunc</a></span> (<span class="id">y</span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>)))).<br/>
<span class="tactic">intros</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp_neq_0">ulp_neq_0</a></span>.<br/>
2: <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_integral_contrapositive_currified">Rmult_integral_contrapositive_currified</a></span>; [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>|<span class="id">idtac</span>].<br/>
2: <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_neq_0_compat">Rinv_neq_0_compat</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>.<br/>
<span class="tactic">intro</span> <span class="id">Hl</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Hr</span> : <span class="id">x</span> / <span class="id">y</span> &lt; <span class="id">p</span>);<br/>
&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rabs_lt_inv">Rabs_lt_inv</a></span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_mag_gt">bpow_mag_gt</a></span>|].<br/>
<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_irrefl">Rlt_irrefl</a></span> (<span class="id">p</span> - / 2 * <span class="id">u2</span>)).<br/>
<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hl</span>).<br/>
<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_r">Rmult_lt_reg_r</a></span> <span class="id">y</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Py</span>).<br/>
<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rinv_l">Rinv_l</a></span>; [|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>]; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_1_r">Rmult_1_r</a></span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zle_or_lt">Zle_or_lt</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z0">Z0</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> / <span class="id">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>))%<span class="id">Z</span>) <span class="kwd">as</span> [<span class="id">He</span>|<span class="id">He</span>].<br/>
- <span class="comment">(*&nbsp;mag&nbsp;(x&nbsp;/&nbsp;y)&nbsp;+&nbsp;fexp1&nbsp;(mag&nbsp;y)&nbsp;&lt;=&nbsp;fexp1&nbsp;(mag&nbsp;x)&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (<span class="id">p</span> * <span class="id">y</span> - <span class="id">p</span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>))).<br/>
&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">Fx</span>; <span class="tactic">rewrite</span> <span class="id">Fy</span> <span class="tactic">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span> <span class="id">p</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">p</span>; <span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_reg_r">Rmult_le_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> / <span class="id">y</span>) - <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>))));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rmult_minus_distr_r">Rmult_minus_distr_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Raux.html#IZR_Zpower">IZR_Zpower</a></span>; [|<span class="tactic">exact</span> <span class="id">He</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mult_IZR">mult_IZR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#minus_IZR">minus_IZR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#IZR_le">IZR_le</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zplus_le_reg_r">Zplus_le_reg_r</a></span> <span class="id">_</span> <span class="id">_</span> 1); <span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zlt_le_succ">Zlt_le_succ</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#lt_IZR">lt_IZR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mult_IZR">mult_IZR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#IZR_Zpower">IZR_Zpower</a></span>; [|<span class="tactic">exact</span> <span class="id">He</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_r">Rmult_lt_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>) + <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> / <span class="id">y</span>))));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Fx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_plus">bpow_plus</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>; <span class="tactic">rewrite</span> &lt;- <span class="id">Fy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fold</span> <span class="id">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_r">Rmult_lt_reg_r</a></span> (/ <span class="id">y</span>)); [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">field_simplify</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rmult_minus_distr_r">Rmult_minus_distr_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rminus">Rminus</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_lt_compat_l">Rplus_lt_compat_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_lt_contravar">Ropp_lt_contravar</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (<span class="id">u2</span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span> (<span class="id">u2</span> * <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rmult_lt_compat">Rmult_lt_compat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_pos">Rmult_le_pos</a></span>; [<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_ge_0">bpow_ge_0</a></span>|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_lt_compat_l">Rmult_lt_compat_l</a></span>; [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rabs_lt_inv">Rabs_lt_inv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_mag_gt">bpow_mag_gt</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">unfold</span> <span class="id">u2</span>, <span class="id">p</span>, <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="id">bpow_simplify</span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_le">bpow_le</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zplus_le_reg_r">Zplus_le_reg_r</a></span> <span class="id">_</span> <span class="id">_</span> (- <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>)); <span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zplus_comm">Zplus_comm</a></span> (- <span class="id">_</span>)); <span class="id">fold</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zminus">Zminus</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> / <span class="id">y</span>)) (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag_div_disj">mag_div_disj</a></span> <span class="id">x</span> <span class="id">y</span> <span class="id">Px</span> <span class="id">Py</span>) <span class="kwd">as</span> [<span class="id">Hxy</span>|<span class="id">Hxy</span>]; <span class="tactic">rewrite</span> <span class="id">Hxy</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id">Hexp</span>; [| |<span class="tactic">rewrite</span> &lt;- <span class="id">Hxy</span>]|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">_</span> - <span class="id">_</span> + 1)%<span class="id">Z</span> <span class="kwd">with</span> ((<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> + 1) - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>)%<span class="id">Z</span> <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hexp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">now</span> <span class="tactic">assert</span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> + 1) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)%<span class="id">Z</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_exp">valid_exp</a></span>|<span class="tactic">omega</span>]. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">assumption</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">_</span> + 1 - <span class="id">_</span>)%<span class="id">Z</span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span> + 1)%<span class="id">Z</span> <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> &lt;- <span class="id">Hxy</span>.<br/>
- <span class="comment">(*&nbsp;fexp1&nbsp;(mag&nbsp;x)&nbsp;&lt;&nbsp;mag&nbsp;(x&nbsp;/&nbsp;y)&nbsp;+&nbsp;fexp1&nbsp;(mag&nbsp;y)&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (<span class="id">p</span> * <span class="id">y</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))).<br/>
&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">Fx</span> <span class="tactic">at</span> 1; <span class="tactic">rewrite</span> <span class="id">Fy</span> <span class="tactic">at</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_reg_r">Rmult_le_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rmult_minus_distr_r">Rmult_minus_distr_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span> <span class="id">p</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">p</span>; <span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Raux.html#IZR_Zpower">IZR_Zpower</a></span>; [|<span class="tactic">omega</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mult_IZR">mult_IZR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#minus_IZR">minus_IZR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#IZR_le">IZR_le</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zplus_le_reg_r">Zplus_le_reg_r</a></span> <span class="id">_</span> <span class="id">_</span> 1); <span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zlt_le_succ">Zlt_le_succ</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#lt_IZR">lt_IZR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mult_IZR">mult_IZR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#IZR_Zpower">IZR_Zpower</a></span>; [|<span class="tactic">omega</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_r">Rmult_lt_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|<span class="id">bpow_simplify</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Fx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zplus_comm">Zplus_comm</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_plus">bpow_plus</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>; <span class="tactic">rewrite</span> &lt;- <span class="id">Fy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fold</span> <span class="id">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_r">Rmult_lt_reg_r</a></span> (/ <span class="id">y</span>)); [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">field_simplify</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rmult_minus_distr_r">Rmult_minus_distr_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rminus">Rminus</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_lt_compat_l">Rplus_lt_compat_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_lt_contravar">Ropp_lt_contravar</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (<span class="id">u2</span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span> (<span class="id">u2</span> * <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rmult_lt_compat">Rmult_lt_compat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_pos">Rmult_le_pos</a></span>; [<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_ge_0">bpow_ge_0</a></span>|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_lt_compat_l">Rmult_lt_compat_l</a></span>; [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rabs_lt_inv">Rabs_lt_inv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_mag_gt">bpow_mag_gt</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">unfold</span> <span class="id">u2</span>, <span class="id">p</span>, <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="id">bpow_simplify</span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_le">bpow_le</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zplus_le_reg_r">Zplus_le_reg_r</a></span> <span class="id">_</span> <span class="id">_</span> (- <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>)); <span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zplus_comm">Zplus_comm</a></span> (- <span class="id">_</span>)); <span class="id">fold</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zminus">Zminus</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> / <span class="id">y</span>)) (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag_div_disj">mag_div_disj</a></span> <span class="id">x</span> <span class="id">y</span> <span class="id">Px</span> <span class="id">Py</span>) <span class="kwd">as</span> [<span class="id">Hxy</span>|<span class="id">Hxy</span>]; <span class="tactic">rewrite</span> <span class="id">Hxy</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hexp</span>; <span class="tactic">try</span> <span class="tactic">assumption</span>; <span class="tactic">rewrite</span> &lt;- <span class="id">Hxy</span>; <span class="tactic">rewrite</span> <span class="id">Hf1</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_refl">Z.le_refl</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_div_aux1">round_round_div_aux1</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">choice1</span> <span class="id">choice2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_div_hyp">round_round_div_hyp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt; 0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> / <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>)) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> / <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>))%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;~ (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#midp">midp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> / <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>) - / 2 * <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> / <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> / <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#midp">midp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> / <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6331')">Proof.</div>
<div class="proofscript" id="proof6331">
<span class="tactic">intros</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Vfexp1</span> <span class="id">Vfexp2</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Hexp</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Px</span> <span class="id">Py</span> <span class="id">Fx</span> <span class="id">Fy</span> <span class="id">Hf1</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Hfx</span> : (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)%<span class="id">Z</span>);<br/>
&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#mag_generic_gt">mag_generic_gt</a></span>; [|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>|]|].<br/>
<span class="tactic">assert</span> (<span class="id">Hfy</span> : (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>) &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>)%<span class="id">Z</span>);<br/>
&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#mag_generic_gt">mag_generic_gt</a></span>; [|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>|]|].<br/>
<span class="tactic">assert</span> (<span class="id">S</span> : (<span class="id">x</span> / <span class="id">y</span> &lt;&gt; 0)%<span class="id">R</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_integral_contrapositive_currified">Rmult_integral_contrapositive_currified</a></span>; [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>|<span class="id">idtac</span>].<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_neq_0_compat">Rinv_neq_0_compat</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>.<br/>
<span class="tactic">cut</span> (~ (/ 2 * (<span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> (<span class="id">x</span> / <span class="id">y</span>) - <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span> (<span class="id">x</span> / <span class="id">y</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;= <span class="id">x</span> / <span class="id">y</span> - <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> (<span class="id">x</span> / <span class="id">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt; / 2 * <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> (<span class="id">x</span> / <span class="id">y</span>))).<br/>
{ <span class="tactic">intro</span> <span class="id">H</span>; <span class="tactic">intro</span> <span class="id">H</span>'; <span class="tactic">apply</span> <span class="id">H</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_reg_l">Rplus_le_reg_l</a></span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> (<span class="id">x</span> / <span class="id">y</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>'.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_reg_l">Rplus_lt_reg_l</a></span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> (<span class="id">x</span> / <span class="id">y</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>'. }<br/>
<span class="tactic">set</span> (<span class="id">u1</span> := <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> / <span class="id">y</span>)))).<br/>
<span class="tactic">set</span> (<span class="id">u2</span> := <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp2</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> / <span class="id">y</span>)))).<br/>
<span class="tactic">set</span> (<span class="id">x</span>' := <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> (<span class="id">x</span> / <span class="id">y</span>)).<br/>
<span class="tactic">rewrite</span> 2!<span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp_neq_0">ulp_neq_0</a></span>; <span class="tactic">trivial</span>.<br/>
<span class="id">revert</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span>, <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="tactic">simpl</span>.<br/>
<span class="tactic">set</span> (<span class="id">mx</span> := <span class="id"><a href="compcert.flocq.Core.Raux.html#Ztrunc">Ztrunc</a></span> (<span class="id">x</span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)))).<br/>
<span class="tactic">set</span> (<span class="id">my</span> := <span class="id"><a href="compcert.flocq.Core.Raux.html#Ztrunc">Ztrunc</a></span> (<span class="id">y</span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>)))).<br/>
<span class="tactic">intros</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">intro</span> <span class="id">Hlr</span>.<br/>
<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_irrefl">Rlt_irrefl</a></span> (/ 2 * (<span class="id">u1</span> - <span class="id">u2</span>))).<br/>
<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> <span class="id">Hlr</span>)).<br/>
<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_reg_r">Rplus_lt_reg_r</a></span> <span class="id">x</span>'); <span class="id">ring_simplify</span>.<br/>
<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_r">Rmult_lt_reg_r</a></span> <span class="id">y</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Py</span>).<br/>
<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rinv_l">Rinv_l</a></span>; [|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>]; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_1_r">Rmult_1_r</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rmult_minus_distr_r">Rmult_minus_distr_r</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_plus_distr_r">Rmult_plus_distr_r</a></span>.<br/>
<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_l">Rmult_lt_reg_l</a></span> 2); [<span class="id">lra</span>|].<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_minus_distr_l">Rmult_minus_distr_l</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_plus_distr_l">Rmult_plus_distr_l</a></span>.<br/>
<span class="tactic">do</span> 5 <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_r">Rinv_r</a></span>; [|<span class="id">lra</span>]; <span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zle_or_lt">Zle_or_lt</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z0">Z0</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) - <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> / <span class="id">y</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>))%<span class="id">Z</span>) <span class="kwd">as</span> [<span class="id">He</span>|<span class="id">He</span>].<br/>
- <span class="comment">(*&nbsp;fexp1&nbsp;(mag&nbsp;(x&nbsp;/&nbsp;y))&nbsp;+&nbsp;fexp1&nbsp;(mag&nbsp;y))&nbsp;&lt;=&nbsp;fexp1&nbsp;(mag&nbsp;x)&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (2 * <span class="id">x</span>' * <span class="id">y</span> + <span class="id">u1</span> * <span class="id">y</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> / <span class="id">y</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>))).<br/>
&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">Fx</span> <span class="tactic">at</span> 1; <span class="tactic">rewrite</span> <span class="id">Fy</span> <span class="tactic">at</span> 1 2.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_reg_r">Rmult_le_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> / <span class="id">y</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>))));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rmult_minus_distr_r">Rmult_minus_distr_r</a></span>; <span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_plus_distr_r">Rmult_plus_distr_r</a></span> (<span class="id">_</span> * <span class="id">_</span> * <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (2 * <span class="id">x</span>' * <span class="id">_</span> * <span class="id">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (2 * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id">my</span> * <span class="id">x</span>' * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> / <span class="id">y</span>)))) <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span> <span class="id">u1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">x</span>', <span class="id">u1</span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span>, <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span>, <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Raux.html#IZR_Zpower">IZR_Zpower</a></span>; [|<span class="tactic">exact</span> <span class="id">He</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 4 <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mult_IZR">mult_IZR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#plus_IZR">plus_IZR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#minus_IZR">minus_IZR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#IZR_le">IZR_le</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zplus_le_reg_r">Zplus_le_reg_r</a></span> <span class="id">_</span> <span class="id">_</span> 1); <span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zlt_le_succ">Zlt_le_succ</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#lt_IZR">lt_IZR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#plus_IZR">plus_IZR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 4 <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mult_IZR">mult_IZR</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#IZR_Zpower">IZR_Zpower</a></span>; [|<span class="tactic">exact</span> <span class="id">He</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_r">Rmult_lt_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> / <span class="id">y</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>))));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|<span class="id">bpow_simplify</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Fx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_plus_distr_r">Rmult_plus_distr_r</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#bpow">Raux.bpow</a></span> <span class="id">_</span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_plus">bpow_plus</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> <span class="id">_</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> <span class="id">_</span>) * <span class="id">_</span>) <span class="kwd">with</span> <span class="id">x</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span> <span class="id">_</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>)))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id">my</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Fy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> <span class="id">_</span>) <span class="kwd">with</span> <span class="id">u1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_l">Rmult_lt_reg_l</a></span> (/ 2)); [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_plus_distr_l">Rmult_plus_distr_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 4 <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rinv_l">Rinv_l</a></span>; [|<span class="id">lra</span>]; <span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_reg_r">Rplus_lt_reg_r</a></span> (- <span class="id">y</span> * <span class="id">x</span>')); <span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_l">Rmult_lt_reg_l</a></span> (/ <span class="id">y</span>)); [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_minus_distr_l">Rmult_minus_distr_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 3 <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rinv_l">Rinv_l</a></span>; [|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>]; <span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_lt_compat_l">Rplus_lt_compat_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_lt_contravar">Ropp_lt_contravar</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (<span class="id">u2</span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* { <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_lt_compat_l">Rmult_lt_compat_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rabs_lt_inv">Rabs_lt_inv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_mag_gt">bpow_mag_gt</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">unfold</span> <span class="id">u2</span>, <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="id">bpow_simplify</span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_le">bpow_le</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zplus_le_reg_r">Zplus_le_reg_r</a></span> <span class="id">_</span> <span class="id">_</span> (- <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>)); <span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zplus_assoc">Zplus_assoc</a></span>; <span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zplus_comm">Zplus_comm</a></span> (- <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag_div_disj">mag_div_disj</a></span> <span class="id">x</span> <span class="id">y</span> <span class="id">Px</span> <span class="id">Py</span>) <span class="kwd">as</span> [<span class="id">Hxy</span>|<span class="id">Hxy</span>]; <span class="tactic">rewrite</span> <span class="id">Hxy</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id">Hexp</span>; [| |<span class="tactic">rewrite</span> &lt;- <span class="id">Hxy</span>]|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">_</span> - <span class="id">_</span> + 1)%<span class="id">Z</span> <span class="kwd">with</span> ((<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> + 1) - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>)%<span class="id">Z</span> <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hexp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">now</span> <span class="tactic">assert</span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> + 1) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)%<span class="id">Z</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_exp">valid_exp</a></span>|<span class="tactic">omega</span>]. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">assumption</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">_</span> + 1 - <span class="id">_</span>)%<span class="id">Z</span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span> + 1)%<span class="id">Z</span> <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> &lt;- <span class="id">Hxy</span>.<br/>
- <span class="comment">(*&nbsp;fexp1&nbsp;(mag&nbsp;x)&nbsp;&lt;&nbsp;fexp1&nbsp;(mag&nbsp;(x&nbsp;/&nbsp;y))&nbsp;+&nbsp;fexp1&nbsp;(mag&nbsp;y)&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (2 * <span class="id">x</span>' * <span class="id">y</span> + <span class="id">u1</span> * <span class="id">y</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))).<br/>
&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">Fx</span> <span class="tactic">at</span> 1; <span class="tactic">rewrite</span> <span class="id">Fy</span> <span class="tactic">at</span> 1 2.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_reg_r">Rmult_le_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rmult_minus_distr_r">Rmult_minus_distr_r</a></span>; <span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_plus_distr_r">Rmult_plus_distr_r</a></span> (<span class="id">_</span> * <span class="id">_</span> * <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (2 * <span class="id">x</span>' * <span class="id">_</span> * <span class="id">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (2 * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id">my</span> * <span class="id">x</span>' * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>) - <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))) <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span> <span class="id">u1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">x</span>', <span class="id">u1</span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span>, <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span>, <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="compcert.flocq.Core.Raux.html#IZR_Zpower">IZR_Zpower</a></span> <span class="id">_</span> (<span class="id">_</span> - <span class="id">_</span>)%<span class="id">Z</span>); [|<span class="tactic">omega</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 5 <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mult_IZR">mult_IZR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#plus_IZR">plus_IZR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#minus_IZR">minus_IZR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#IZR_le">IZR_le</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zplus_le_reg_r">Zplus_le_reg_r</a></span> <span class="id">_</span> <span class="id">_</span> 1); <span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zlt_le_succ">Zlt_le_succ</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#lt_IZR">lt_IZR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#plus_IZR">plus_IZR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 5 <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mult_IZR">mult_IZR</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#IZR_Zpower">IZR_Zpower</a></span>; [|<span class="tactic">omega</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_r">Rmult_lt_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Fx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_plus_distr_r">Rmult_plus_distr_r</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#bpow">Raux.bpow</a></span> <span class="id">_</span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_plus">bpow_plus</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> <span class="id">_</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> <span class="id">_</span>) * <span class="id">_</span>) <span class="kwd">with</span> <span class="id">x</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span> <span class="id">_</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>)))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id">my</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Fy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> <span class="id">_</span>) <span class="kwd">with</span> <span class="id">u1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_l">Rmult_lt_reg_l</a></span> (/ 2)); [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_plus_distr_l">Rmult_plus_distr_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 4 <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rinv_l">Rinv_l</a></span>; [|<span class="id">lra</span>]; <span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_reg_r">Rplus_lt_reg_r</a></span> (- <span class="id">y</span> * <span class="id">x</span>')); <span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_l">Rmult_lt_reg_l</a></span> (/ <span class="id">y</span>)); [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_minus_distr_l">Rmult_minus_distr_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 3 <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rinv_l">Rinv_l</a></span>; [|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>]; <span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_lt_compat_l">Rplus_lt_compat_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_lt_contravar">Ropp_lt_contravar</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (<span class="id">u2</span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* { <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_lt_compat_l">Rmult_lt_compat_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rabs_lt_inv">Rabs_lt_inv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_mag_gt">bpow_mag_gt</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">unfold</span> <span class="id">u2</span>, <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="id">bpow_simplify</span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_le">bpow_le</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zplus_le_reg_r">Zplus_le_reg_r</a></span> <span class="id">_</span> <span class="id">_</span> (- <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>)); <span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zplus_comm">Zplus_comm</a></span> (- <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag_div_disj">mag_div_disj</a></span> <span class="id">x</span> <span class="id">y</span> <span class="id">Px</span> <span class="id">Py</span>) <span class="kwd">as</span> [<span class="id">Hxy</span>|<span class="id">Hxy</span>]; <span class="tactic">rewrite</span> <span class="id">Hxy</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hexp</span>; <span class="tactic">try</span> <span class="tactic">assumption</span>; <span class="tactic">rewrite</span> &lt;- <span class="id">Hxy</span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_div_aux2">round_round_div_aux2</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">choice1</span> <span class="id">choice2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_div_hyp">round_round_div_hyp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt; 0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> / <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>)) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> / <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>))%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;~ (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#midp">midp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> / <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> / <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#midp">midp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> / <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>) + / 2 * <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> / <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6332')">Proof.</div>
<div class="proofscript" id="proof6332">
<span class="tactic">intros</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Vfexp1</span> <span class="id">Vfexp2</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Hexp</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Px</span> <span class="id">Py</span> <span class="id">Fx</span> <span class="id">Fy</span> <span class="id">Hf1</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Hfx</span> : (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)%<span class="id">Z</span>);<br/>
&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#mag_generic_gt">mag_generic_gt</a></span>; [|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>|]|].<br/>
<span class="tactic">assert</span> (<span class="id">Hfy</span> : (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>) &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>)%<span class="id">Z</span>);<br/>
&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#mag_generic_gt">mag_generic_gt</a></span>; [|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>|]|].<br/>
<span class="tactic">cut</span> (~ (/ 2 * <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> (<span class="id">x</span> / <span class="id">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt; <span class="id">x</span> / <span class="id">y</span> - <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> (<span class="id">x</span> / <span class="id">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;= / 2 * (<span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> (<span class="id">x</span> / <span class="id">y</span>) + <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp2</span> (<span class="id">x</span> / <span class="id">y</span>)))).<br/>
{ <span class="tactic">intro</span> <span class="id">H</span>; <span class="tactic">intro</span> <span class="id">H</span>'; <span class="tactic">apply</span> <span class="id">H</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_reg_l">Rplus_lt_reg_l</a></span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> (<span class="id">x</span> / <span class="id">y</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>'.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_reg_l">Rplus_le_reg_l</a></span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> (<span class="id">x</span> / <span class="id">y</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span>'. }<br/>
<span class="tactic">set</span> (<span class="id">u1</span> := <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> / <span class="id">y</span>)))).<br/>
<span class="tactic">set</span> (<span class="id">u2</span> := <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp2</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> / <span class="id">y</span>)))).<br/>
<span class="tactic">set</span> (<span class="id">x</span>' := <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id">fexp1</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> (<span class="id">x</span> / <span class="id">y</span>)).<br/>
<span class="tactic">assert</span> (<span class="id">S</span> : (<span class="id">x</span> / <span class="id">y</span> &lt;&gt; 0)%<span class="id">R</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_integral_contrapositive_currified">Rmult_integral_contrapositive_currified</a></span>; [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>|<span class="id">idtac</span>].<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_neq_0_compat">Rinv_neq_0_compat</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>.<br/>
<span class="tactic">rewrite</span> 2!<span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp_neq_0">ulp_neq_0</a></span>; <span class="tactic">trivial</span>.<br/>
<span class="id">revert</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span>, <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="tactic">simpl</span>.<br/>
<span class="tactic">set</span> (<span class="id">mx</span> := <span class="id"><a href="compcert.flocq.Core.Raux.html#Ztrunc">Ztrunc</a></span> (<span class="id">x</span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)))).<br/>
<span class="tactic">set</span> (<span class="id">my</span> := <span class="id"><a href="compcert.flocq.Core.Raux.html#Ztrunc">Ztrunc</a></span> (<span class="id">y</span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>)))).<br/>
<span class="tactic">intros</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">intro</span> <span class="id">Hlr</span>.<br/>
<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_irrefl">Rlt_irrefl</a></span> (/ 2 * (<span class="id">u1</span> + <span class="id">u2</span>))).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (<span class="id">x</span> / <span class="id">y</span> - <span class="id">x</span>'); [|<span class="id">now</span> <span class="tactic">apply</span> <span class="id">Hlr</span>].<br/>
<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_reg_r">Rplus_lt_reg_r</a></span> <span class="id">x</span>'); <span class="id">ring_simplify</span>.<br/>
<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_r">Rmult_lt_reg_r</a></span> <span class="id">y</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Py</span>).<br/>
<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rinv_l">Rinv_l</a></span>; [|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>]; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_1_r">Rmult_1_r</a></span>.<br/>
<span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_plus_distr_r">Rmult_plus_distr_r</a></span>.<br/>
<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_l">Rmult_lt_reg_l</a></span> 2); [<span class="id">lra</span>|].<br/>
<span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_plus_distr_l">Rmult_plus_distr_l</a></span>.<br/>
<span class="tactic">do</span> 5 <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_r">Rinv_r</a></span>; [|<span class="id">lra</span>]; <span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zle_or_lt">Zle_or_lt</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z0">Z0</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>) - <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> / <span class="id">y</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>))%<span class="id">Z</span>) <span class="kwd">as</span> [<span class="id">He</span>|<span class="id">He</span>].<br/>
- <span class="comment">(*&nbsp;fexp1&nbsp;(mag&nbsp;(x&nbsp;/&nbsp;y))&nbsp;+&nbsp;fexp1&nbsp;(mag&nbsp;y)&nbsp;&lt;=&nbsp;fexp1&nbsp;(mag&nbsp;x)&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (<span class="id">u1</span> * <span class="id">y</span> + <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> / <span class="id">y</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ 2 * <span class="id">x</span>' * <span class="id">y</span>).<br/>
&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_compat_r">Rplus_lt_compat_r</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_lt_compat_l">Rplus_lt_compat_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (<span class="id">u2</span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* { <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_lt_compat_l">Rmult_lt_compat_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rabs_lt_inv">Rabs_lt_inv</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_mag_gt">bpow_mag_gt</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">unfold</span> <span class="id">u2</span>, <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="id">bpow_simplify</span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_le">bpow_le</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zplus_le_reg_r">Zplus_le_reg_r</a></span> <span class="id">_</span> <span class="id">_</span> (- <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>)); <span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zplus_assoc">Zplus_assoc</a></span>; <span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zplus_comm">Zplus_comm</a></span> (- <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag_div_disj">mag_div_disj</a></span> <span class="id">x</span> <span class="id">y</span> <span class="id">Px</span> <span class="id">Py</span>) <span class="kwd">as</span> [<span class="id">Hxy</span>|<span class="id">Hxy</span>]; <span class="tactic">rewrite</span> <span class="id">Hxy</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id">Hexp</span>; [| |<span class="tactic">rewrite</span> &lt;- <span class="id">Hxy</span>]|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">_</span> - <span class="id">_</span> + 1)%<span class="id">Z</span> <span class="kwd">with</span> ((<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> + 1) - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>)%<span class="id">Z</span> <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hexp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">now</span> <span class="tactic">assert</span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> + 1) &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>)%<span class="id">Z</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_exp">valid_exp</a></span>|<span class="tactic">omega</span>]. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">assumption</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">_</span> + 1 - <span class="id">_</span>)%<span class="id">Z</span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span> + 1)%<span class="id">Z</span> <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> &lt;- <span class="id">Hxy</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rge_le">Rge_le</a></span>; <span class="tactic">rewrite</span> <span class="id">Fx</span> <span class="tactic">at</span> 1; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_ge">Rle_ge</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">u1</span> * <span class="id">y</span>) <span class="kwd">with</span> (<span class="id">u1</span> * (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id">my</span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>))));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_sym">eq_sym</a></span>; <span class="tactic">rewrite</span> <span class="id">Fy</span> <span class="tactic">at</span> 1].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (2 * <span class="id">x</span>' * <span class="id">y</span>) <span class="kwd">with</span> (2 * <span class="id">x</span>' * (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id">my</span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>))));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_sym">eq_sym</a></span>; <span class="tactic">rewrite</span> <span class="id">Fy</span> <span class="tactic">at</span> 1].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_reg_r">Rmult_le_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> / <span class="id">y</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>))));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_plus_distr_r">Rmult_plus_distr_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span> <span class="id">u1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">u1</span>, <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span> 2).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span> <span class="id">x</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span> 2).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">x</span>', <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span>, <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="compcert.flocq.Core.Raux.html#IZR_Zpower">IZR_Zpower</a></span> <span class="id">_</span> (<span class="id">_</span> - <span class="id">_</span>)%<span class="id">Z</span>); [|<span class="tactic">exact</span> <span class="id">He</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 4 <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mult_IZR">mult_IZR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#plus_IZR">plus_IZR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#IZR_le">IZR_le</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zplus_comm">Zplus_comm</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zplus_assoc">Zplus_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zlt_le_succ">Zlt_le_succ</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#lt_IZR">lt_IZR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#plus_IZR">plus_IZR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 4 <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mult_IZR">mult_IZR</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#IZR_Zpower">IZR_Zpower</a></span>; [|<span class="tactic">exact</span> <span class="id">He</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_r">Rmult_lt_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>))));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_plus_distr_r">Rmult_plus_distr_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span> <span class="id">_</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Fy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.sub">Zminus</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_plus">bpow_plus</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span> <span class="id">_</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id">mx</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id">mx</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Fx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_r">Rmult_lt_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> (<span class="id">x</span> / <span class="id">y</span>)))));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_plus_distr_r">Rmult_plus_distr_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span> <span class="id">_</span> <span class="id">y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> <span class="id">_</span>) * <span class="id">_</span>) <span class="kwd">with</span> <span class="id">x</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> <span class="id">_</span>) <span class="kwd">with</span> <span class="id">u1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_l">Rmult_lt_reg_l</a></span> (/ 2)); [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_plus_distr_l">Rmult_plus_distr_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 4 <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rinv_l">Rinv_l</a></span>; [|<span class="id">lra</span>]; <span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_reg_r">Rplus_lt_reg_r</a></span> (- <span class="id">y</span> * <span class="id">x</span>')); <span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_l">Rmult_lt_reg_l</a></span> (/ <span class="id">y</span>)); [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_plus_distr_l">Rmult_plus_distr_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 3 <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_mult_distr_r_reverse">Ropp_mult_distr_r_reverse</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_mult_distr_l_reverse">Ropp_mult_distr_l_reverse</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rinv_l">Rinv_l</a></span>; [|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>]; <span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span> (/ <span class="id">y</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_comm">Rplus_comm</a></span> (- <span class="id">x</span>')).<br/>
- <span class="comment">(*&nbsp;fexp1&nbsp;(mag&nbsp;x)&nbsp;&lt;&nbsp;fexp1&nbsp;(mag&nbsp;(x&nbsp;/&nbsp;y))&nbsp;+&nbsp;fexp1&nbsp;(mag&nbsp;y)&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (2 * <span class="id">x</span>' * <span class="id">y</span> + <span class="id">u1</span> * <span class="id">y</span> + <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))).<br/>
&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_comm">Rplus_comm</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_assoc">Rplus_assoc</a></span>; <span class="tactic">do</span> 2 <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_lt_compat_l">Rplus_lt_compat_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (<span class="id">u2</span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_lt_compat_l">Rmult_lt_compat_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rabs_lt_inv">Rabs_lt_inv</a></span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_mag_gt">bpow_mag_gt</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">unfold</span> <span class="id">u2</span>, <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="id">bpow_simplify</span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_le">bpow_le</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zplus_le_reg_r">Zplus_le_reg_r</a></span> <span class="id">_</span> <span class="id">_</span> (- <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>)); <span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zplus_comm">Zplus_comm</a></span> (- <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag_div_disj">mag_div_disj</a></span> <span class="id">x</span> <span class="id">y</span> <span class="id">Px</span> <span class="id">Py</span>) <span class="kwd">as</span> [<span class="id">Hxy</span>|<span class="id">Hxy</span>]; <span class="tactic">rewrite</span> <span class="id">Hxy</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hexp</span>; <span class="tactic">try</span> <span class="tactic">assumption</span>; <span class="tactic">rewrite</span> &lt;- <span class="id">Hxy</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rge_le">Rge_le</a></span>; <span class="tactic">rewrite</span> <span class="id">Fx</span> <span class="tactic">at</span> 1; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_ge">Rle_ge</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Fy</span> <span class="tactic">at</span> 1 2.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_reg_r">Rmult_le_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (- <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_plus_distr_r">Rmult_plus_distr_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (2 * <span class="id">x</span>' * <span class="id">_</span> * <span class="id">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (2 * <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id">my</span> * <span class="id">x</span>' * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>) - <span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))) <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span> <span class="id">u1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">x</span>', <span class="id">u1</span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span>, <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span>, <span class="id"><a href="compcert.flocq.Core.Ulp.html#ulp">ulp</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span>, <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="compcert.flocq.Core.Raux.html#IZR_Zpower">IZR_Zpower</a></span> <span class="id">_</span> (<span class="id">_</span> - <span class="id">_</span>)%<span class="id">Z</span>); [|<span class="tactic">omega</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 5 <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mult_IZR">mult_IZR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#plus_IZR">plus_IZR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#IZR_le">IZR_le</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zlt_le_succ">Zlt_le_succ</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#lt_IZR">lt_IZR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#plus_IZR">plus_IZR</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 5 <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#mult_IZR">mult_IZR</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#IZR_Zpower">IZR_Zpower</a></span>; [|<span class="tactic">omega</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_r">Rmult_lt_reg_r</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">x</span>))));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span> <span class="id">_</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id">mx</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Fx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_plus_distr_r">Rmult_plus_distr_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">bpow_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_plus">bpow_plus</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id">_</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id">_</span> * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> <span class="id">_</span>) <span class="kwd">with</span> <span class="id">x</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span> <span class="id">_</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> (<span class="id">fexp1</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#mag">mag</a></span> <span class="id">y</span>)))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 2 <span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id">my</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Fy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#bpow">bpow</a></span> <span class="id">_</span>) <span class="kwd">with</span> <span class="id">u1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_l">Rmult_lt_reg_l</a></span> (/ 2)); [<span class="id">lra</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_plus_distr_l">Rmult_plus_distr_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 4 <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rinv_l">Rinv_l</a></span>; [|<span class="id">lra</span>]; <span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_reg_r">Rplus_lt_reg_r</a></span> (- <span class="id">y</span> * <span class="id">x</span>')); <span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_reg_l">Rmult_lt_reg_l</a></span> (/ <span class="id">y</span>)); [<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_plus_distr_l">Rmult_plus_distr_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 3 <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_mult_distr_r_reverse">Ropp_mult_distr_r_reverse</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_mult_distr_l_reverse">Ropp_mult_distr_l_reverse</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rinv_l">Rinv_l</a></span>; [|<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>]; <span class="tactic">do</span> 2 <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span> (/ <span class="id">y</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_comm">Rplus_comm</a></span> (- <span class="id">x</span>')).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_div_aux">round_round_div_aux</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">choice1</span> <span class="id">choice2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>),<br/>
&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">n</span>, (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> = 2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#n">n</a></span> :&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>)%<span class="id">Z</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_div_hyp">round_round_div_hyp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt; 0 &lt; <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> / <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6333')">Proof.</div>
<div class="proofscript" id="proof6333">
<span class="tactic">intros</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Vfexp1</span> <span class="id">Vfexp2</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Ebeta</span> <span class="id">Hexp</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Px</span> <span class="id">Py</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Pxy</span> : 0 &lt; <span class="id">x</span> / <span class="id">y</span>).<br/>
{ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_0_compat">Rmult_lt_0_compat</a></span>; [<span class="tactic">exact</span> <span class="id">Px</span>|].<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span>. }<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_all_mid_cases">round_round_all_mid_cases</a></span>.<br/>
- <span class="tactic">exact</span> <span class="id">Vfexp1</span>.<br/>
- <span class="tactic">exact</span> <span class="id">Vfexp2</span>.<br/>
- <span class="tactic">exact</span> <span class="id">Pxy</span>.<br/>
- <span class="tactic">apply</span> <span class="id">Hexp</span>.<br/>
- <span class="tactic">intros</span> <span class="id">Hf1</span> <span class="id">Hlxy</span>.<br/>
&nbsp;&nbsp;<span class="id">casetype</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_div_aux0">round_round_div_aux0</a></span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">_</span> <span class="id">_</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Hexp</span> <span class="id">x</span> <span class="id">y</span>).<br/>
- <span class="tactic">intros</span> <span class="id">Hf1</span> <span class="id">Hlxy</span>.<br/>
&nbsp;&nbsp;<span class="id">casetype</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_div_aux1">round_round_div_aux1</a></span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">_</span> <span class="id">_</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Hexp</span> <span class="id">x</span> <span class="id">y</span>).<br/>
- <span class="tactic">intro</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq_mid_beta_even">round_round_eq_mid_beta_even</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Hexp</span>.<br/>
- <span class="tactic">intros</span> <span class="id">Hf1</span> <span class="id">Hlxy</span>.<br/>
&nbsp;&nbsp;<span class="id">casetype</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_div_aux2">round_round_div_aux2</a></span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">_</span> <span class="id">_</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Hexp</span> <span class="id">x</span> <span class="id">y</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_round_div">round_round_div</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fexp1</span> <span class="id">fexp2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">choice1</span> <span class="id">choice2</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>),<br/>
&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">n</span>, (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> = 2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#n">n</a></span> :&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>)%<span class="id">Z</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_div_hyp">round_round_div_hyp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> &lt;&gt; 0 -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp1">fexp1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#fexp2">fexp2</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> / <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6334')">Proof.</div>
<div class="proofscript" id="proof6334">
<span class="tactic">intros</span> <span class="id">fexp1</span> <span class="id">fexp2</span> <span class="id">Vfexp1</span> <span class="id">Vfexp2</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Ebeta</span> <span class="id">Hexp</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Nzy</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rtotal_order">Rtotal_order</a></span> <span class="id">x</span> 0) <span class="kwd">as</span> [<span class="id">Nx</span>|[<span class="id">Zx</span>|<span class="id">Px</span>]].<br/>
- <span class="comment">(*&nbsp;x&nbsp;&lt;&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rtotal_order">Rtotal_order</a></span> <span class="id">y</span> 0) <span class="kwd">as</span> [<span class="id">Ny</span>|[<span class="id">Zy</span>|<span class="id">Py</span>]].<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;y&nbsp;&lt;&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_involutive">Ropp_involutive</a></span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_involutive">Ropp_involutive</a></span> <span class="id">y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ratan.html#Ropp_div">Ropp_div</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>; <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_inv_permute">Ropp_inv_permute</a></span>; [|<span class="id">lra</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_mult_distr_r_reverse">Ropp_mult_distr_r_reverse</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_involutive">Ropp_involutive</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fold</span> ((- <span class="id">x</span>) / (- <span class="id">y</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_lt_contravar">Ropp_lt_contravar</a></span> <span class="kwd">in</span> <span class="id">Nx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_lt_contravar">Ropp_lt_contravar</a></span> <span class="kwd">in</span> <span class="id">Ny</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_0">Ropp_0</a></span> <span class="kwd">in</span> <span class="id">Nx</span>, <span class="id">Ny</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format_opp">generic_format_opp</a></span> <span class="kwd">in</span> <span class="id">Fx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format_opp">generic_format_opp</a></span> <span class="kwd">in</span> <span class="id">Fy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_div_aux">round_round_div_aux</a></span>.<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;y&nbsp;=&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">casetype</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>; <span class="tactic">apply</span> <span class="id">Nzy</span>.<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;y&nbsp;&gt;&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_involutive">Ropp_involutive</a></span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Ratan.html#Ropp_div">Ropp_div</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 3 <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_N_opp">round_N_opp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_eq_compat">Ropp_eq_compat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_lt_contravar">Ropp_lt_contravar</a></span> <span class="kwd">in</span> <span class="id">Nx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_0">Ropp_0</a></span> <span class="kwd">in</span> <span class="id">Nx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format_opp">generic_format_opp</a></span> <span class="kwd">in</span> <span class="id">Fx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_div_aux">round_round_div_aux</a></span>.<br/>
- <span class="comment">(*&nbsp;x&nbsp;=&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Zx</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_l">Rmult_0_l</a></span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_0">round_0</a></span>; [|<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#valid_rnd_N">valid_rnd_N</a></span>].<br/>
- <span class="comment">(*&nbsp;x&nbsp;&gt;&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rtotal_order">Rtotal_order</a></span> <span class="id">y</span> 0) <span class="kwd">as</span> [<span class="id">Ny</span>|[<span class="id">Zy</span>|<span class="id">Py</span>]].<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;y&nbsp;&lt;&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_involutive">Ropp_involutive</a></span> <span class="id">y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span>; <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_inv_permute">Ropp_inv_permute</a></span>; [|<span class="id">lra</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_mult_distr_r_reverse">Ropp_mult_distr_r_reverse</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> 3 <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_N_opp">round_N_opp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_eq_compat">Ropp_eq_compat</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_lt_contravar">Ropp_lt_contravar</a></span> <span class="kwd">in</span> <span class="id">Ny</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_0">Ropp_0</a></span> <span class="kwd">in</span> <span class="id">Ny</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format_opp">generic_format_opp</a></span> <span class="kwd">in</span> <span class="id">Fy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_div_aux">round_round_div_aux</a></span>.<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;y&nbsp;=&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">casetype</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>; <span class="tactic">apply</span> <span class="id">Nzy</span>.<br/>
&nbsp;&nbsp;+ <span class="comment">(*&nbsp;y&nbsp;&gt;&nbsp;0&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_div_aux">round_round_div_aux</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Double_round.Double_round_div.Double_round_div_FLX">Double_round_div_FLX</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Double_round.Double_round_div.Double_round_div_FLX.prec">prec</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id">prec</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<br/>
<span class="kwd">Context</span> { <span class="id">prec_gt_0_</span> : <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLX.prec">prec</a></span> }.<br/>
<span class="kwd">Context</span> { <span class="id">prec_gt_0_</span>' : <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="id">prec</span>' }.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="FLX_round_round_div_hyp">FLX_round_round_div_hyp</a></span> :<br/>
&nbsp;&nbsp;(2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLX.prec">prec</a></span> &lt;= <span class="id">prec</span>')%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_div_hyp">round_round_div_hyp</a></span> (<span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp">FLX_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLX.prec">prec</a></span>) (<span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp">FLX_exp</a></span> <span class="id">prec</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6335')">Proof.</div>
<div class="proofscript" id="proof6335">
<span class="tactic">intros</span> <span class="id">Hprec</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="kwd">in</span> <span class="id">prec_gt_0_</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp">FLX_exp</a></span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_div_hyp">round_round_div_hyp</a></span>.<br/>
<span class="tactic">split</span>; [<span class="id">now</span> <span class="tactic">intro</span> <span class="id">ex</span>; <span class="tactic">omega</span>|].<br/>
<span class="tactic">split</span>; [|<span class="tactic">split</span>; [|<span class="tactic">split</span>]]; <span class="tactic">intros</span> <span class="id">ex</span> <span class="id">ey</span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="round_round_div_FLX">round_round_div_FLX</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">choice1</span> <span class="id">choice2</span>,<br/>
&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">n</span>, (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> = 2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#n">n</a></span> :&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>)%<span class="id">Z</span>) -&gt;<br/>
&nbsp;&nbsp;(2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLX.prec">prec</a></span> &lt;= <span class="id">prec</span>')%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> &lt;&gt; 0 -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_format">FLX_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLX.prec">prec</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_format">FLX_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLX.prec">prec</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> (<span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp">FLX_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLX.prec">prec</a></span>) (<span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp">FLX_exp</a></span> <span class="id">prec</span>') <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> / <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6336')">Proof.</div>
<div class="proofscript" id="proof6336">
<span class="tactic">intros</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Ebeta</span> <span class="id">Hprec</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Nzy</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_div">round_round_div</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp_valid">FLX_exp_valid</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#FLX_exp_valid">FLX_exp_valid</a></span>.<br/>
- <span class="tactic">exact</span> <span class="id">Ebeta</span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#FLX_round_round_div_hyp">FLX_round_round_div_hyp</a></span>.<br/>
- <span class="tactic">exact</span> <span class="id">Nzy</span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#generic_format_FLX">generic_format_FLX</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#generic_format_FLX">generic_format_FLX</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLX">Double_round_div_FLX</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Double_round.Double_round_div.Double_round_div_FLT">Double_round_div_FLT</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Double_round.Double_round_div.Double_round_div_FLT.emin">emin</a></span> <span class="id"><a name="Double_round.Double_round_div.Double_round_div_FLT.prec">prec</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id">emin</span>' <span class="id">prec</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<br/>
<span class="kwd">Context</span> { <span class="id">prec_gt_0_</span> : <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLT.prec">prec</a></span> }.<br/>
<span class="kwd">Context</span> { <span class="id">prec_gt_0_</span>' : <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="id">prec</span>' }.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="FLT_round_round_div_hyp">FLT_round_round_div_hyp</a></span> :<br/>
&nbsp;&nbsp;(<span class="id">emin</span>' &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLT.emin">emin</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLT.prec">prec</a></span> - 2)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;(2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLT.prec">prec</a></span> &lt;= <span class="id">prec</span>')%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_div_hyp">round_round_div_hyp</a></span> (<span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp">FLT_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLT.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLT.prec">prec</a></span>) (<span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp">FLT_exp</a></span> <span class="id">emin</span>' <span class="id">prec</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6337')">Proof.</div>
<div class="proofscript" id="proof6337">
<span class="tactic">intros</span> <span class="id">Hemin</span> <span class="id">Hprec</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp">FLT_exp</a></span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="kwd">in</span> <span class="id">prec_gt_0_</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_div_hyp">round_round_div_hyp</a></span>.<br/>
<span class="tactic">split</span>; [<span class="tactic">intro</span> <span class="id">ex</span>|<span class="tactic">split</span>; [|<span class="tactic">split</span>; [|<span class="tactic">split</span>]]; <span class="tactic">intros</span> <span class="id">ex</span> <span class="id">ey</span>].<br/>
- <span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ex</span> - <span class="id">prec</span>') <span class="id">emin</span>').<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ex</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLT.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLT.emin">emin</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
- <span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ex</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLT.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLT.emin">emin</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ey</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLT.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLT.emin">emin</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ex</span> - <span class="id">ey</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLT.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLT.emin">emin</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ex</span> - <span class="id">ey</span> - <span class="id">prec</span>') <span class="id">emin</span>').<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
- <span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ex</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLT.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLT.emin">emin</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ey</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLT.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLT.emin">emin</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ex</span> - <span class="id">ey</span> + 1 - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLT.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLT.emin">emin</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ex</span> - <span class="id">ey</span> + 1 - <span class="id">prec</span>') <span class="id">emin</span>').<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
- <span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ex</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLT.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLT.emin">emin</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ey</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLT.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLT.emin">emin</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ex</span> - <span class="id">ey</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLT.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLT.emin">emin</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ex</span> - <span class="id">ey</span> - <span class="id">prec</span>') <span class="id">emin</span>').<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
- <span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ex</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLT.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLT.emin">emin</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ey</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLT.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLT.emin">emin</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ex</span> - <span class="id">ey</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLT.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLT.emin">emin</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmax.html#Zmax_spec">Zmax_spec</a></span> (<span class="id">ex</span> - <span class="id">ey</span> - <span class="id">prec</span>') <span class="id">emin</span>').<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="round_round_div_FLT">round_round_div_FLT</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">choice1</span> <span class="id">choice2</span>,<br/>
&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">n</span>, (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> = 2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#n">n</a></span> :&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>)%<span class="id">Z</span>) -&gt;<br/>
&nbsp;&nbsp;(<span class="id">emin</span>' &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLT.emin">emin</a></span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLT.prec">prec</a></span> - 2)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;(2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLT.prec">prec</a></span> &lt;= <span class="id">prec</span>')%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> &lt;&gt; 0 -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_format">FLT_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLT.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLT.prec">prec</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_format">FLT_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLT.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLT.prec">prec</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> (<span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp">FLT_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLT.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLT.prec">prec</a></span>) (<span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp">FLT_exp</a></span> <span class="id">emin</span>' <span class="id">prec</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> / <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6338')">Proof.</div>
<div class="proofscript" id="proof6338">
<span class="tactic">intros</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Ebeta</span> <span class="id">Hemin</span> <span class="id">Hprec</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Nzy</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_div">round_round_div</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp_valid">FLT_exp_valid</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLT.html#FLT_exp_valid">FLT_exp_valid</a></span>.<br/>
- <span class="tactic">exact</span> <span class="id">Ebeta</span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#FLT_round_round_div_hyp">FLT_round_round_div_hyp</a></span>.<br/>
- <span class="tactic">exact</span> <span class="id">Nzy</span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLT.html#generic_format_FLT">generic_format_FLT</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FLT.html#generic_format_FLT">generic_format_FLT</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FLT">Double_round_div_FLT</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Double_round.Double_round_div.Double_round_div_FTZ">Double_round_div_FTZ</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Double_round.Double_round_div.Double_round_div_FTZ.emin">emin</a></span> <span class="id"><a name="Double_round.Double_round_div.Double_round_div_FTZ.prec">prec</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id">emin</span>' <span class="id">prec</span>' : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<br/>
<span class="kwd">Context</span> { <span class="id">prec_gt_0_</span> : <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FTZ.prec">prec</a></span> }.<br/>
<span class="kwd">Context</span> { <span class="id">prec_gt_0_</span>' : <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="id">prec</span>' }.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="FTZ_round_round_div_hyp">FTZ_round_round_div_hyp</a></span> :<br/>
&nbsp;&nbsp;(<span class="id">emin</span>' + <span class="id">prec</span>' &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FTZ.emin">emin</a></span> - 1)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;(2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FTZ.prec">prec</a></span> &lt;= <span class="id">prec</span>')%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_div_hyp">round_round_div_hyp</a></span> (<span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp">FTZ_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FTZ.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FTZ.prec">prec</a></span>) (<span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp">FTZ_exp</a></span> <span class="id">emin</span>' <span class="id">prec</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6339')">Proof.</div>
<div class="proofscript" id="proof6339">
<span class="tactic">intros</span> <span class="id">Hemin</span> <span class="id">Hprec</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp">FTZ_exp</a></span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="kwd">in</span> <span class="id">prec_gt_0_</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="kwd">in</span> <span class="id">prec_gt_0_</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_div_hyp">round_round_div_hyp</a></span>.<br/>
<span class="tactic">split</span>; [<span class="tactic">intro</span> <span class="id">ex</span>|<span class="tactic">split</span>; [|<span class="tactic">split</span>; [|<span class="tactic">split</span>]]; <span class="tactic">intros</span> <span class="id">ex</span> <span class="id">ey</span>].<br/>
- <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ex</span> - <span class="id">prec</span>') <span class="id">emin</span>');<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ex</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FTZ.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FTZ.emin">emin</a></span>);<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
- <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ex</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FTZ.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FTZ.emin">emin</a></span>);<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ey</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FTZ.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FTZ.emin">emin</a></span>);<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ex</span> - <span class="id">ey</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FTZ.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FTZ.emin">emin</a></span>);<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ex</span> - <span class="id">ey</span> - <span class="id">prec</span>') <span class="id">emin</span>');<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
- <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ex</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FTZ.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FTZ.emin">emin</a></span>);<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ey</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FTZ.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FTZ.emin">emin</a></span>);<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ex</span> - <span class="id">ey</span> + 1 - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FTZ.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FTZ.emin">emin</a></span>);<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ex</span> - <span class="id">ey</span> + 1 - <span class="id">prec</span>') <span class="id">emin</span>');<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
- <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ex</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FTZ.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FTZ.emin">emin</a></span>);<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ey</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FTZ.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FTZ.emin">emin</a></span>);<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ex</span> - <span class="id">ey</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FTZ.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FTZ.emin">emin</a></span>);<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ex</span> - <span class="id">ey</span> - <span class="id">prec</span>') <span class="id">emin</span>');<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
- <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ex</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FTZ.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FTZ.emin">emin</a></span>);<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ey</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FTZ.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FTZ.emin">emin</a></span>);<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ex</span> - <span class="id">ey</span> - <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FTZ.prec">prec</a></span>) <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FTZ.emin">emin</a></span>);<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id">ex</span> - <span class="id">ey</span> - <span class="id">prec</span>') <span class="id">emin</span>');<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="round_round_div_FTZ">round_round_div_FTZ</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">choice1</span> <span class="id">choice2</span>,<br/>
&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">n</span>, (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> = 2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#n">n</a></span> :&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>)%<span class="id">Z</span>) -&gt;<br/>
&nbsp;&nbsp;(<span class="id">emin</span>' + <span class="id">prec</span>' &lt;= <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FTZ.emin">emin</a></span> - 1)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;(2 * <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FTZ.prec">prec</a></span> &lt;= <span class="id">prec</span>')%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> &lt;&gt; 0 -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_format">FTZ_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FTZ.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FTZ.prec">prec</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> -&gt; <span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_format">FTZ_format</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FTZ.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FTZ.prec">prec</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_eq">round_round_eq</a></span> (<span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp">FTZ_exp</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FTZ.emin">emin</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FTZ.prec">prec</a></span>) (<span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp">FTZ_exp</a></span> <span class="id">emin</span>' <span class="id">prec</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice1">choice1</a></span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#choice2">choice2</a></span> (<span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#x">x</a></span> / <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#y">y</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6340')">Proof.</div>
<div class="proofscript" id="proof6340">
<span class="tactic">intros</span> <span class="id">choice1</span> <span class="id">choice2</span> <span class="id">Ebeta</span> <span class="id">Hemin</span> <span class="id">Hprec</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Nzy</span> <span class="id">Fx</span> <span class="id">Fy</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#round_round_div">round_round_div</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp_valid">FTZ_exp_valid</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FTZ.html#FTZ_exp_valid">FTZ_exp_valid</a></span>.<br/>
- <span class="tactic">exact</span> <span class="id">Ebeta</span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#FTZ_round_round_div_hyp">FTZ_round_round_div_hyp</a></span>.<br/>
- <span class="tactic">exact</span> <span class="id">Nzy</span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FTZ.html#generic_format_FTZ">generic_format_FTZ</a></span>.<br/>
- <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.FTZ.html#generic_format_FTZ">generic_format_FTZ</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div.Double_round_div_FTZ">Double_round_div_FTZ</a></span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round.Double_round_div">Double_round_div</a></span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.flocq.Prop.Double_rounding.html#Double_round">Double_round</a></span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
