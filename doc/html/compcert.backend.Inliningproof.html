
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module Inliningproof</title>
<meta name="description" content="Documentation of Coq module Inliningproof" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module Inliningproof</h1>
<div class="coq">
<br/>
<div class="doc">RTL function inlining: semantic preservation </div>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.lib.Coqlib.html">Coqlib</a></span> <span class="id"><a href="compcert.lib.Wfsimpl.html">Wfsimpl</a></span> <span class="id"><a href="compcert.lib.Maps.html">Maps</a></span> <span class="id"><a href="compcert.common.Errors.html">Errors</a></span> <span class="id"><a href="compcert.lib.Integers.html">Integers</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.common.AST.html">AST</a></span> <span class="id"><a href="compcert.common.Linking.html">Linking</a></span> <span class="id"><a href="compcert.common.Values.html">Values</a></span> <span class="id"><a href="compcert.common.Memory.html">Memory</a></span> <span class="id"><a href="compcert.common.Globalenvs.html">Globalenvs</a></span> <span class="id"><a href="compcert.common.Events.html">Events</a></span> <span class="id"><a href="compcert.common.LanguageInterface.html">LanguageInterface</a></span> <span class="id"><a href="compcert.common.Smallstep.html">Smallstep</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.x86.Op.html">Op</a></span> <span class="id"><a href="compcert.backend.Registers.html">Registers</a></span> <span class="id"><a href="compcert.backend.RTL.html">RTL</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.backend.Inlining.html">Inlining</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html">Inliningspec</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="match_prog">match_prog</a></span> (<span class="id">prog</span> <span class="id">tprog</span>: <span class="id"><a href="compcert.backend.RTL.html#program">program</a></span>) :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#match_program">match_program</a></span> (<span class="kwd">fun</span> <span class="id">cunit</span> <span class="id">f</span> <span class="id">tf</span> =&gt; <span class="id"><a href="compcert.backend.Inlining.html#transf_fundef">transf_fundef</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#funenv_program">funenv_program</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#cunit">cunit</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#tf">tf</a></span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#prog">prog</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#tprog">tprog</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="transf_program_match">transf_program_match</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">prog</span> <span class="id">tprog</span>, <span class="id"><a href="compcert.backend.Inlining.html#transf_program">transf_program</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#prog">prog</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#tprog">tprog</a></span> -&gt; <span class="id"><a href="compcert.backend.Inliningproof.html#match_prog">match_prog</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#prog">prog</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#tprog">tprog</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3167')">Proof.</div>
<div class="proofscript" id="proof3167">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Linking.html#match_transform_partial_program_contextual">match_transform_partial_program_contextual</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="INLINING">INLINING</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="INLINING.prog">prog</a></span>: <span class="id"><a href="compcert.backend.RTL.html#program">program</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="INLINING.tprog">tprog</a></span>: <span class="id"><a href="compcert.backend.RTL.html#program">program</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="INLINING.TRANSF">TRANSF</a></span>: <span class="id"><a href="compcert.backend.Inliningproof.html#match_prog">match_prog</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.prog">prog</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.tprog">tprog</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="INLINING.w">w</a></span>: <span class="id"><a href="compcert.common.LanguageInterface.html#meminj_thr">meminj_thr</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="INLINING.se">se</a></span>: <span class="id"><a href="compcert.common.Globalenvs.html#Genv.symtbl">Genv.symtbl</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="INLINING.tse">tse</a></span>: <span class="id"><a href="compcert.common.Globalenvs.html#Genv.symtbl">Genv.symtbl</a></span>.<br/>
<span class="kwd">Let</span> <span class="id"><a name="INLINING.ge">ge</a></span> := <span class="id"><a href="compcert.common.Globalenvs.html#Genv.globalenv">Genv.globalenv</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.se">se</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.prog">prog</a></span>.<br/>
<span class="kwd">Let</span> <span class="id"><a name="INLINING.tge">tge</a></span> := <span class="id"><a href="compcert.common.Globalenvs.html#Genv.globalenv">Genv.globalenv</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.tse">tse</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.tprog">tprog</a></span>.<br/>
<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="INLINING.GE">GE</a></span>: <span class="id"><a href="compcert.common.LanguageInterface.html#cc_inj_senv">cc_inj_senv</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.w">w</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.se">se</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.tse">tse</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="INLINING.VALID">VALID</a></span>: <span class="id"><a href="compcert.common.Globalenvs.html#Genv.valid_for">Genv.valid_for</a></span> (<span class="id"><a href="compcert.common.AST.html#erase_program">erase_program</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.prog">prog</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.se">se</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="functions_translated">functions_translated</a></span> (<span class="id">j</span>: <span class="id"><a href="compcert.common.Values.html#meminj">meminj</a></span>):<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Globalenvs.html#Genv.match_stbls">Genv.match_stbls</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.se">se</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.tse">tse</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">v</span> <span class="id">tv</span>: <span class="id"><a href="compcert.common.Values.html#val">val</a></span>) (<span class="id">f</span>: <span class="id"><a href="compcert.backend.RTL.html#fundef">fundef</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct">Genv.find_funct</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.ge">ge</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#v">v</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span> -&gt; <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#v">v</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#tv">tv</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">cu</span> <span class="id">f</span>', <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct">Genv.find_funct</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.tge">tge</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#tv">tv</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">f</span>' /\ <span class="id"><a href="compcert.backend.Inlining.html#transf_fundef">transf_fundef</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#funenv_program">funenv_program</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#cu">cu</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id">f</span>' /\ <span class="id"><a href="compcert.common.Linking.html#linkorder">linkorder</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#cu">cu</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.prog">prog</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3168')">Proof.</div>
<div class="proofscript" id="proof3168">
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct_match">Genv.find_funct_match</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.TRANSF">TRANSF</a></span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sig_function_translated">sig_function_translated</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">cu</span> <span class="id">f</span> <span class="id">f</span>', <span class="id"><a href="compcert.backend.Inlining.html#transf_fundef">transf_fundef</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#funenv_program">funenv_program</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#cu">cu</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id">f</span>' -&gt; <span class="id"><a href="compcert.backend.RTL.html#funsig">funsig</a></span> <span class="id">f</span>' = <span class="id"><a href="compcert.backend.RTL.html#funsig">funsig</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3169')">Proof.</div>
<div class="proofscript" id="proof3169">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">f</span>; <span class="id">Errors.monadInv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningspec.html#transf_function_spec">transf_function_spec</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">SP</span>; <span class="id">inv</span> <span class="id">SP</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<h2> Properties of contexts and relocations </h2>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="sreg_below_diff">sreg_below_diff</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ctx</span> <span class="id">r</span> <span class="id">r</span>', <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id">r</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dreg">dreg</a></span>) -&gt; <span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> &lt;&gt; <span class="id">r</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3170')">Proof.</div>
<div class="proofscript" id="proof3170">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">zify</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Inliningspec.html#shiftpos_eq">shiftpos_eq</a></span>. <span class="id">xomega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="context_below_diff">context_below_diff</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ctx1</span> <span class="id">ctx2</span> <span class="id">r1</span> <span class="id">r2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#context_below">context_below</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx1">ctx1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx2">ctx2</a></span> -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r1">r1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx1">ctx1</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mreg">mreg</a></span>) -&gt; <span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx1">ctx1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r1">r1</a></span> &lt;&gt; <span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx2">ctx2</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r2">r2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3171')">Proof.</div>
<div class="proofscript" id="proof3171">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">zify</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span>; <span class="tactic">rewrite</span> ! <span class="id"><a href="compcert.backend.Inliningspec.html#shiftpos_eq">shiftpos_eq</a></span>. <span class="id">xomega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="context_below_lt">context_below_lt</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ctx1</span> <span class="id">ctx2</span> <span class="id">r</span>, <span class="id"><a href="compcert.backend.Inliningspec.html#context_below">context_below</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx1">ctx1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx2">ctx2</a></span> -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx1">ctx1</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mreg">mreg</a></span>) -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx1">ctx1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#ctx2">ctx2</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dreg">dreg</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3172')">Proof.</div>
<div class="proofscript" id="proof3172">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span>; <span class="id">zify</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Inliningspec.html#shiftpos_eq">shiftpos_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="id">xomega</span>.<br/>
Qed.</div>
<br/>
<br/>
<h2> Agreement between register sets before and after inlining. </h2>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="agree_regs">agree_regs</a></span> (<span class="id">F</span>: <span class="id"><a href="compcert.common.Values.html#meminj">meminj</a></span>) (<span class="id">ctx</span>: <span class="id"><a href="compcert.backend.Inlining.html#context">context</a></span>) (<span class="id">rs</span> <span class="id">rs</span>': <span class="id"><a href="compcert.backend.RTL.html#regset">regset</a></span>) :=<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mreg">mreg</a></span>) -&gt; <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span>#<span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> <span class="id">rs</span>'#(<span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span>))<br/>
/\(<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mreg">mreg</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> -&gt; <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span>#<span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> = <span class="id"><a href="compcert.common.Values.html#Vundef">Vundef</a></span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="val_reg_charact">val_reg_charact</a></span> (<span class="id">F</span>: <span class="id"><a href="compcert.common.Values.html#meminj">meminj</a></span>) (<span class="id">ctx</span>: <span class="id"><a href="compcert.backend.Inlining.html#context">context</a></span>) (<span class="id">rs</span>': <span class="id"><a href="compcert.backend.RTL.html#regset">regset</a></span>) (<span class="id">v</span>: <span class="id"><a href="compcert.common.Values.html#val">val</a></span>) (<span class="id">r</span>: <span class="id"><a href="compcert.backend.Registers.html#reg">reg</a></span>) :=<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mreg">mreg</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> /\ <span class="id"><a href="compcert.backend.Inliningproof.html#v">v</a></span> = <span class="id"><a href="compcert.common.Values.html#Vundef">Vundef</a></span>) \/ (<span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mreg">mreg</a></span>) /\ <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#v">v</a></span> <span class="id">rs</span>'#(<span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span>)).<br/>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="Plt_Ple_dec">Plt_Ple_dec</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">p</span> <span class="id">q</span>, {<span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#p">p</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#q">q</a></span>} + {<span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#q">q</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#p">p</a></span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3173')">Proof.</div>
<div class="proofscript" id="proof3173">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#plt">plt</a></span> <span class="id">p</span> <span class="id">q</span>). <span class="id">left</span>; <span class="tactic">auto</span>. <span class="id">right</span>; <span class="id">xomega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_val_reg_gen">agree_val_reg_gen</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">ctx</span> <span class="id">rs</span> <span class="id">rs</span>' <span class="id">r</span>, <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span> <span class="id">rs</span>' -&gt; <span class="id"><a href="compcert.backend.Inliningproof.html#val_reg_charact">val_reg_charact</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">rs</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span>#<span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3174')">Proof.</div>
<div class="proofscript" id="proof3174">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">A</span> <span class="id">B</span>].<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.Inliningproof.html#Plt_Ple_dec">Plt_Ple_dec</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#mreg">mreg</a></span> <span class="id">ctx</span>) <span class="id">r</span>).<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">rewrite</span> <span class="id">B</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">right</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_val_regs_gen">agree_val_regs_gen</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">ctx</span> <span class="id">rs</span> <span class="id">rs</span>' <span class="id">rl</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span> <span class="id">rs</span>' -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#list_forall2">list_forall2</a></span> (<span class="id"><a href="compcert.backend.Inliningproof.html#val_reg_charact">val_reg_charact</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">rs</span>') <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span>##<span class="id"><a href="compcert.backend.Inliningproof.html#rl">rl</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rl">rl</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3175')">Proof.</div>
<div class="proofscript" id="proof3175">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">rl</span>; <span class="tactic">intros</span>; <span class="id">constructor</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_val_reg_gen">agree_val_reg_gen</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_val_reg">agree_val_reg</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">ctx</span> <span class="id">rs</span> <span class="id">rs</span>' <span class="id">r</span>, <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span> <span class="id">rs</span>' -&gt; <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span>#<span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> <span class="id">rs</span>'#(<span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3176')">Proof.</div>
<div class="proofscript" id="proof3176">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_val_reg_gen">agree_val_reg_gen</a></span>; <span class="tactic">eauto</span>. <span class="id">instantiate</span> (1 := <span class="id">r</span>). <span class="tactic">intros</span> [[<span class="id">A</span> <span class="id">B</span>] | [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">B</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_val_regs">agree_val_regs</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">ctx</span> <span class="id">rs</span> <span class="id">rs</span>' <span class="id">rl</span>, <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span> <span class="id">rs</span>' -&gt; <span class="id"><a href="compcert.common.Values.html#Val.inject_list">Val.inject_list</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span>##<span class="id"><a href="compcert.backend.Inliningproof.html#rl">rl</a></span> <span class="id">rs</span>'##(<span class="id"><a href="compcert.backend.Inlining.html#sregs">sregs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rl">rl</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3177')">Proof.</div>
<div class="proofscript" id="proof3177">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">rl</span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span>. <span class="id">constructor</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_val_reg">agree_val_reg</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_set_reg">agree_set_reg</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">ctx</span> <span class="id">rs</span> <span class="id">rs</span>' <span class="id">r</span> <span class="id">v</span> <span class="id">v</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span> <span class="id">rs</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#v">v</a></span> <span class="id">v</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mreg">mreg</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> (<span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span>#<span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> &lt;- <span class="id"><a href="compcert.backend.Inliningproof.html#v">v</a></span>) (<span class="id">rs</span>'#(<span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span>) &lt;- <span class="id">v</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3178')">Proof.</div>
<div class="proofscript" id="proof3178">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span>. <span class="tactic">split</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Registers.html#Regmap.gsspec">Regmap.gsspec</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#peq">peq</a></span> <span class="id">r0</span> <span class="id">r</span>). <span class="tactic">subst</span> <span class="id">r0</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#peq_true">peq_true</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#peq_false">peq_false</a></span>. <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#shiftpos_diff">shiftpos_diff</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Registers.html#Regmap.gso">Regmap.gso</a></span>. <span class="tactic">auto</span>. <span class="id">xomega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_set_reg_undef">agree_set_reg_undef</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">ctx</span> <span class="id">rs</span> <span class="id">rs</span>' <span class="id">r</span> <span class="id">v</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span> <span class="id">rs</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> (<span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span>#<span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> &lt;- <span class="id"><a href="compcert.common.Values.html#Vundef">Vundef</a></span>) (<span class="id">rs</span>'#(<span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span>) &lt;- <span class="id">v</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3179')">Proof.</div>
<div class="proofscript" id="proof3179">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span>. <span class="tactic">split</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Registers.html#Regmap.gsspec">Regmap.gsspec</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#peq">peq</a></span> <span class="id">r0</span> <span class="id">r</span>). <span class="tactic">subst</span> <span class="id">r0</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#peq_true">peq_true</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#peq_false">peq_false</a></span>. <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#shiftpos_diff">shiftpos_diff</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Registers.html#Regmap.gsspec">Regmap.gsspec</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#peq">peq</a></span> <span class="id">r0</span> <span class="id">r</span>); <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">agree_set_reg_undef</span>':<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">ctx</span> <span class="id">rs</span> <span class="id">rs</span>' <span class="id">r</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span> <span class="id">rs</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> (<span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span>#<span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> &lt;- <span class="id"><a href="compcert.common.Values.html#Vundef">Vundef</a></span>) <span class="id">rs</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3180')">Proof.</div>
<div class="proofscript" id="proof3180">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span>. <span class="tactic">split</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Registers.html#Regmap.gsspec">Regmap.gsspec</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#peq">peq</a></span> <span class="id">r0</span> <span class="id">r</span>). <span class="tactic">subst</span> <span class="id">r0</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Registers.html#Regmap.gsspec">Regmap.gsspec</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#peq">peq</a></span> <span class="id">r0</span> <span class="id">r</span>); <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_regs_invariant">agree_regs_invariant</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">ctx</span> <span class="id">rs</span> <span class="id">rs1</span> <span class="id">rs2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs1">rs1</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dreg">dreg</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> (<span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dreg">dreg</a></span>) + <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mreg">mreg</a></span>)) -&gt; <span class="id"><a href="compcert.backend.Inliningproof.html#rs2">rs2</a></span>#<span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> = <span class="id"><a href="compcert.backend.Inliningproof.html#rs1">rs1</a></span>#<span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs2">rs2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3181')">Proof.</div>
<div class="proofscript" id="proof3181">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span>. <span class="tactic">split</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#shiftpos_above">shiftpos_above</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.lt_le_trans">Pos.lt_le_trans</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#shiftpos_below">shiftpos_below</a></span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H1</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_regs_incr">agree_regs_incr</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">ctx</span> <span class="id">rs1</span> <span class="id">rs2</span> <span class="id">F</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs1">rs1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs2">rs2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#inject_incr">inject_incr</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id">F</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span> <span class="id">F</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs1">rs1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs2">rs2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3182')">Proof.</div>
<div class="proofscript" id="proof3182">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span>. <span class="tactic">split</span>; <span class="tactic">intros</span>. <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="agree_regs_init">agree_regs_init</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">ctx</span> <span class="id">rs</span>, <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> (<span class="id"><a href="compcert.backend.Registers.html#Regmap.init">Regmap.init</a></span> <span class="id"><a href="compcert.common.Values.html#Vundef">Vundef</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3183')">Proof.</div>
<div class="proofscript" id="proof3183">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">split</span>; <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Registers.html#Regmap.gi">Regmap.gi</a></span>; <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Registers.html#Regmap.gi">Regmap.gi</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_regs_init_regs">agree_regs_init_regs</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">ctx</span> <span class="id">rl</span> <span class="id">vl</span> <span class="id">vl</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.inject_list">Val.inject_list</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#vl">vl</a></span> <span class="id">vl</span>' -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rl">rl</a></span> -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mreg">mreg</a></span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> (<span class="id"><a href="compcert.backend.RTL.html#init_regs">init_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#vl">vl</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rl">rl</a></span>) (<span class="id"><a href="compcert.backend.RTL.html#init_regs">init_regs</a></span> <span class="id">vl</span>' (<span class="id"><a href="compcert.backend.Inlining.html#sregs">sregs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rl">rl</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3184')">Proof.</div>
<div class="proofscript" id="proof3184">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">rl</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs_init">agree_regs_init</a></span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs_init">agree_regs_init</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_set_reg">agree_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<h2> Executing sequences of moves </h2>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="tr_moves_init_regs">tr_moves_init_regs</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">stk</span> <span class="id">f</span> <span class="id">sp</span> <span class="id">m</span> <span class="id">ctx1</span> <span class="id">ctx2</span>, <span class="id"><a href="compcert.backend.Inliningspec.html#context_below">context_below</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx1">ctx1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx2">ctx2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">rdsts</span> <span class="id">rsrcs</span> <span class="id">vl</span> <span class="id">pc1</span> <span class="id">pc2</span> <span class="id">rs1</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#tr_moves">tr_moves</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span>.(<span class="id"><a href="compcert.backend.RTL.html#fn_code">fn_code</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#pc1">pc1</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#sregs">sregs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx1">ctx1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rsrcs">rsrcs</a></span>) (<span class="id"><a href="compcert.backend.Inlining.html#sregs">sregs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx2">ctx2</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rdsts">rdsts</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#pc2">pc2</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rdsts">rdsts</a></span> -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx2">ctx2</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mreg">mreg</a></span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#list_forall2">list_forall2</a></span> (<span class="id"><a href="compcert.backend.Inliningproof.html#val_reg_charact">val_reg_charact</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx1">ctx1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs1">rs1</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#vl">vl</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rsrcs">rsrcs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">rs2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Smallstep.html#star">star</a></span> <span class="id"><a href="compcert.backend.RTL.html#step">step</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.tge">tge</a></span> (<span class="id"><a href="compcert.backend.RTL.html#State">State</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#pc1">pc1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs1">rs1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Events.html#E0">E0</a></span> (<span class="id"><a href="compcert.backend.RTL.html#State">State</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#pc2">pc2</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs2">rs2</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span>)<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx2">ctx2</a></span> (<span class="id"><a href="compcert.backend.RTL.html#init_regs">init_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#vl">vl</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rdsts">rdsts</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#rs2">rs2</a></span><br/>
&nbsp;&nbsp;/\ <span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx2">ctx2</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dreg">dreg</a></span>) -&gt; <span class="id"><a href="compcert.backend.Inliningproof.html#rs2">rs2</a></span>#<span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> = <span class="id"><a href="compcert.backend.Inliningproof.html#rs1">rs1</a></span>#<span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3185')">Proof.</div>
<div class="proofscript" id="proof3185">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">rdsts</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
<span class="comment">(*&nbsp;rdsts&nbsp;=&nbsp;nil&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>. <span class="id">exists</span> <span class="id">rs1</span>; <span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#star_refl">star_refl</a></span>. <span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs_init">agree_regs_init</a></span>. <span class="tactic">auto</span>.<br/>
<span class="comment">(*&nbsp;rdsts&nbsp;=&nbsp;a&nbsp;::&nbsp;rdsts&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H2</span>. <span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">rs1</span>; <span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#star_refl">star_refl</a></span>. <span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs_init">agree_regs_init</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHrdsts</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">rs2</span> [<span class="id">A</span> [<span class="id">B</span> <span class="id">C</span>]]].<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">rs2</span>#(<span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span> <span class="id">ctx2</span> <span class="id">a</span>) &lt;- (<span class="id">rs2</span>#(<span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span> <span class="id">ctx1</span> <span class="id">b1</span>))).<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#star_right">star_right</a></span>. <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.RTL.html#exec_Iop">exec_Iop</a></span>; <span class="tactic">eauto</span>. <span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">destruct</span> <span class="id">H3</span> <span class="kwd">as</span> [[<span class="id">P</span> <span class="id">Q</span>] | [<span class="id">P</span> <span class="id">Q</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">a1</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_set_reg_undef">agree_set_reg_undef</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_set_reg">agree_set_reg</a></span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id">C</span>; <span class="tactic">auto</span>.  <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#context_below_lt">context_below_lt</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Registers.html#Regmap.gso">Regmap.gso</a></span>. <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#not_eq_sym">not_eq_sym</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#sreg_below_diff">sreg_below_diff</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span>; <span class="tactic">discriminate</span>.<br/>
Qed.</div>
<br/>
<h2> Memory invariants </h2>
<br/>
<div class="doc">A stack location is private if it is not the image of a valid
   location and we have full rights on it. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="loc_private">loc_private</a></span> (<span class="id">F</span>: <span class="id"><a href="compcert.common.Values.html#meminj">meminj</a></span>) (<span class="id">m</span> <span class="id">m</span>': <span class="id"><a href="compcert.common.Memory.html#mem">mem</a></span>) (<span class="id">sp</span>: <span class="id"><a href="compcert.common.Values.html#block">block</a></span>) (<span class="id">ofs</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Cur">Cur</a></span> <span class="id"><a href="compcert.common.Memtype.html#Freeable">Freeable</a></span> /\<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">b</span> <span class="id">delta</span>, <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span>, <span class="id"><a href="compcert.backend.Inliningproof.html#delta">delta</a></span>) -&gt; ~<span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> (<span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> - <span class="id"><a href="compcert.backend.Inliningproof.html#delta">delta</a></span>) <span class="id"><a href="compcert.common.Memtype.html#Max">Max</a></span> <span class="id"><a href="compcert.common.Memtype.html#Nonempty">Nonempty</a></span>).<br/>
<br/>
<div class="doc">Likewise, for a range of locations. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="range_private">range_private</a></span> (<span class="id">F</span>: <span class="id"><a href="compcert.common.Values.html#meminj">meminj</a></span>) (<span class="id">m</span> <span class="id">m</span>': <span class="id"><a href="compcert.common.Memory.html#mem">mem</a></span>) (<span class="id">sp</span>: <span class="id"><a href="compcert.common.Values.html#block">block</a></span>) (<span class="id">lo</span> <span class="id">hi</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ofs</span>, <span class="id"><a href="compcert.backend.Inliningproof.html#lo">lo</a></span> &lt;= <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> &lt; <span class="id"><a href="compcert.backend.Inliningproof.html#hi">hi</a></span> -&gt; <span class="id"><a href="compcert.backend.Inliningproof.html#loc_private">loc_private</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="range_private_invariant">range_private_invariant</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">sp</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">F1</span> <span class="id">m1</span> <span class="id">m1</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#range_private">range_private</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#lo">lo</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#hi">hi</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">b</span> <span class="id">delta</span> <span class="id">ofs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#F1">F1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span>, <span class="id"><a href="compcert.backend.Inliningproof.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m1">m1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Max">Max</a></span> <span class="id"><a href="compcert.common.Memtype.html#Nonempty">Nonempty</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#lo">lo</a></span> &lt;= <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> + <span class="id"><a href="compcert.backend.Inliningproof.html#delta">delta</a></span> &lt; <span class="id"><a href="compcert.backend.Inliningproof.html#hi">hi</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span>, <span class="id"><a href="compcert.backend.Inliningproof.html#delta">delta</a></span>) /\ <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Max">Max</a></span> <span class="id"><a href="compcert.common.Memtype.html#Nonempty">Nonempty</a></span>) -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">ofs</span>, <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Cur">Cur</a></span> <span class="id"><a href="compcert.common.Memtype.html#Freeable">Freeable</a></span> -&gt; <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m1</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Cur">Cur</a></span> <span class="id"><a href="compcert.common.Memtype.html#Freeable">Freeable</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#range_private">range_private</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F1">F1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m1">m1</a></span> <span class="id">m1</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#lo">lo</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#hi">hi</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3186')">Proof.</div>
<div class="proofscript" id="proof3186">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id">H</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>]. <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">omega</span>. <span class="tactic">intros</span> [<span class="id">P</span> <span class="id">Q</span>].<br/>
&nbsp;&nbsp;<span class="id">eelim</span> <span class="id">B</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="range_private_perms">range_private_perms</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">sp</span> <span class="id">lo</span> <span class="id">hi</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#range_private">range_private</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#lo">lo</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#hi">hi</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.range_perm">Mem.range_perm</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#lo">lo</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#hi">hi</a></span> <span class="id"><a href="compcert.common.Memtype.html#Cur">Cur</a></span> <span class="id"><a href="compcert.common.Memtype.html#Freeable">Freeable</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3187')">Proof.</div>
<div class="proofscript" id="proof3187">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id">H</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="range_private_alloc_left">range_private_alloc_left</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">sp</span>' <span class="id">base</span> <span class="id">hi</span> <span class="id">sz</span> <span class="id">m1</span> <span class="id">sp</span> <span class="id">F1</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#range_private">range_private</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id">sp</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#base">base</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#hi">hi</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.alloc">Mem.alloc</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> 0 <span class="id"><a href="compcert.backend.Inliningproof.html#sz">sz</a></span> = (<span class="id"><a href="compcert.backend.Inliningproof.html#m1">m1</a></span>, <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#F1">F1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id">sp</span>', <span class="id"><a href="compcert.backend.Inliningproof.html#base">base</a></span>) -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">b</span>, <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> &lt;&gt; <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> -&gt; <span class="id"><a href="compcert.backend.Inliningproof.html#F1">F1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> = <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#range_private">range_private</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F1">F1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m1">m1</a></span> <span class="id">m</span>' <span class="id">sp</span>' (<span class="id"><a href="compcert.backend.Inliningproof.html#base">base</a></span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.max">Z.max</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sz">sz</a></span> 0) <span class="id"><a href="compcert.backend.Inliningproof.html#hi">hi</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3188')">Proof.</div>
<div class="proofscript" id="proof3188">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">H</span> <span class="id">ofs</span>). <span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_max_r">Z.le_max_r</a></span> <span class="id">sz</span> 0). <span class="tactic">omega</span>. <span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>].<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_alloc_inv">Mem.perm_alloc_inv</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Values.html#eq_block">eq_block</a></span> <span class="id">b</span> <span class="id">sp</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">b</span>. <span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H4</span>; <span class="id">inv</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#Zmax_spec">Zmax_spec</a></span> <span class="kwd">in</span> <span class="id">H3</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> 0 <span class="id">sz</span>); <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H4</span>; <span class="tactic">auto</span>. <span class="id">eelim</span> <span class="id">B</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="range_private_free_left">range_private_free_left</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">sp</span> <span class="id">base</span> <span class="id">sz</span> <span class="id">hi</span> <span class="id">b</span> <span class="id">m1</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#range_private">range_private</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> (<span class="id"><a href="compcert.backend.Inliningproof.html#base">base</a></span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.max">Z.max</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sz">sz</a></span> 0) <span class="id"><a href="compcert.backend.Inliningproof.html#hi">hi</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.free">Mem.free</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> 0 <span class="id"><a href="compcert.backend.Inliningproof.html#sz">sz</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m1">m1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span>, <span class="id"><a href="compcert.backend.Inliningproof.html#base">base</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.inject">Mem.inject</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#range_private">range_private</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m1">m1</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#base">base</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#hi">hi</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3189')">Proof.</div>
<div class="proofscript" id="proof3189">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id">ofs</span> (<span class="id">base</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.max">Z.max</a></span> <span class="id">sz</span> 0)) <span class="kwd">as</span> [<span class="id">z</span>|<span class="id">z</span>].<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> <span class="id">ofs</span> <span class="kwd">with</span> ((<span class="id">ofs</span> - <span class="id">base</span>) + <span class="id">base</span>) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_inject">Mem.perm_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.free_range_perm">Mem.free_range_perm</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#Zmax_spec">Zmax_spec</a></span> <span class="kwd">in</span> <span class="id">z</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> 0 <span class="id">sz</span>); <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Values.html#eq_block">eq_block</a></span> <span class="id">b</span> <span class="id">b0</span>).<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">b0</span>. <span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H4</span>; <span class="id">inv</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;<span class="id">eelim</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_free_2">Mem.perm_free_2</a></span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#Zmax_spec">Zmax_spec</a></span> <span class="kwd">in</span> <span class="id">z</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> 0 <span class="id">sz</span>); <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.mi_no_overlap">Mem.mi_no_overlap</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_cur_max">Mem.perm_cur_max</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_implies">Mem.perm_implies</a></span> <span class="kwd">with</span> <span class="id"><a href="compcert.common.Memtype.html#Freeable">Freeable</a></span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.free_range_perm">Mem.free_range_perm</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id">ofs</span> - <span class="id">base</span>). <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#Zmax_spec">Zmax_spec</a></span> <span class="kwd">in</span> <span class="id">z</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> 0 <span class="id">sz</span>); <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_free_3">Mem.perm_free_3</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">A</span> | <span class="id">A</span>]. <span class="tactic">congruence</span>. <span class="tactic">omega</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">H</span> <span class="id">ofs</span>). <span class="tactic">omega</span>. <span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>]. <span class="tactic">split</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="id">eelim</span> <span class="id">B</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_free_3">Mem.perm_free_3</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="range_private_extcall">range_private_extcall</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">F</span>' <span class="id">m1</span> <span class="id">m2</span> <span class="id">m1</span>' <span class="id">m2</span>' <span class="id">sp</span> <span class="id">base</span> <span class="id">hi</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#range_private">range_private</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m1">m1</a></span> <span class="id">m1</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#base">base</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#hi">hi</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m1">m1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> -&gt; <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m2">m2</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Max">Max</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#p">p</a></span> -&gt; <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m1">m1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Max">Max</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#p">p</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.unchanged_on">Mem.unchanged_on</a></span> (<span class="id"><a href="compcert.common.Events.html#loc_out_of_reach">loc_out_of_reach</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m1">m1</a></span>) <span class="id">m1</span>' <span class="id">m2</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.inject">Mem.inject</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m1">m1</a></span> <span class="id">m1</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#inject_incr">inject_incr</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id">F</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Events.html#inject_separated">inject_separated</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id">F</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#m1">m1</a></span> <span class="id">m1</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="id">m1</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#range_private">range_private</a></span> <span class="id">F</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#m2">m2</a></span> <span class="id">m2</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#base">base</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#hi">hi</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3190')">Proof.</div>
<div class="proofscript" id="proof3190">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">hi</span>; <span class="tactic">intros</span> <span class="id">RP</span> <span class="id">PERM</span> <span class="id">UNCH</span> <span class="id">INJ</span> <span class="id">INCR</span> <span class="id">SEP</span> <span class="id">VB</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id">RP</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>].<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_unchanged_on">Mem.perm_unchanged_on</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="tactic">destruct</span> (<span class="id">F</span> <span class="id">b</span>) <span class="kwd">as</span> [[<span class="id">sp1</span> <span class="id">delta1</span>] |] <span class="id">eqn</span>:?.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">INCR</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">EQ</span>; <span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">EQ</span>; <span class="id">inv</span> <span class="id">EQ</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="id">eelim</span> <span class="id">B</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id">PERM</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#plt">plt</a></span> <span class="id">b</span> (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">m1</span>)); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.mi_freeblocks">Mem.mi_freeblocks</a></span>; <span class="tactic">eauto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SEP</span>; <span class="tactic">eauto</span>. <span class="tactic">tauto</span>.<br/>
Qed.</div>
<br/>
<h2> Relating global environments </h2>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ros_address_agree">ros_address_agree</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ros</span> <span class="id">rs</span> <span class="id">F</span> <span class="id">ctx</span> <span class="id">rs</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span> <span class="id">rs</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Globalenvs.html#Genv.match_stbls">Genv.match_stbls</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.se">se</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.tse">tse</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> (<span class="id"><a href="compcert.backend.RTL.html#ros_address">ros_address</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.ge">ge</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ros">ros</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span>) (<span class="id"><a href="compcert.backend.RTL.html#ros_address">ros_address</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.tge">tge</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#sros">sros</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ros">ros</a></span>) <span class="id">rs</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3191')">Proof.</div>
<div class="proofscript" id="proof3191">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">ros</span> <span class="kwd">as</span> [<span class="id">r</span> | <span class="id">id</span>]; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
- <span class="comment">(*&nbsp;register&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">Hlo</span> <span class="id">Hhi</span>]. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#plt">plt</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#mreg">mreg</a></span> <span class="id">ctx</span>) <span class="id">r</span>).<br/>
&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">Hhi</span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id">Hlo</span>. <span class="id">xomega</span>.<br/>
- <span class="comment">(*&nbsp;symbol&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.symbol_address">Genv.symbol_address</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.se">se</a></span> <span class="id">id</span>) <span class="id">eqn</span>:<span class="id">Hb</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">edestruct</span> @<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_symbol_match">Genv.find_symbol_match</a></span> <span class="kwd">as</span> (<span class="id">b</span>' &amp; <span class="id">Hb</span>' &amp; <span class="id">H</span>'); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>'. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ros_address_inlined">ros_address_inlined</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fenv</span> <span class="id">id</span> <span class="id">rs</span> <span class="id">fd</span> <span class="id">f</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#fenv_compat">fenv_compat</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.prog">prog</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#fenv">fenv</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct">Genv.find_funct</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.ge">ge</a></span> (<span class="id"><a href="compcert.backend.RTL.html#ros_address">ros_address</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.ge">ge</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#inr">inr</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#id">id</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#fd">fd</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#fenv">fenv</a></span>!<span class="id"><a href="compcert.backend.Inliningproof.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#fd">fd</a></span> = <span class="id"><a href="compcert.common.AST.html#Internal">Internal</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3192')">Proof.</div>
<div class="proofscript" id="proof3192">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_def_symbol">Genv.find_def_symbol</a></span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">eauto</span>. <span class="tactic">destruct</span> <span class="id">H1</span> <span class="kwd">as</span> (<span class="id">b</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>).<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.symbol_address">Genv.symbol_address</a></span>, <span class="id"><a href="compcert.backend.Inliningproof.html#ge">ge</a></span>, <span class="id"><a href="compcert.backend.RTL.html#fundef">fundef</a></span> <span class="kwd">in</span> *. <span class="tactic">setoid_rewrite</span> <span class="id">A</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct_ptr_iff">Genv.find_funct_ptr_iff</a></span> <span class="kwd">in</span> <span class="id">B</span>. <span class="id">cbn</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.eq_dec">Ptrofs.eq_dec</a></span>; <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Translation of builtin arguments. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="tr_builtin_arg">tr_builtin_arg</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">ctx</span> <span class="id">rs</span> <span class="id">rs</span>' <span class="id">sp</span> <span class="id">sp</span>' <span class="id">m</span> <span class="id">m</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Globalenvs.html#Genv.match_stbls">Genv.match_stbls</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.se">se</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.tse">tse</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span> <span class="id">rs</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id">sp</span>', <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.inject">Mem.inject</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">a</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Events.html#eval_builtin_arg">eval_builtin_arg</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.ge">ge</a></span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span>#<span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span>) (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#a">a</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>', <span class="id"><a href="compcert.common.Events.html#eval_builtin_arg">eval_builtin_arg</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.tge">tge</a></span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="id">rs</span>'#<span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span>) (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id">m</span>' (<span class="id"><a href="compcert.backend.Inlining.html#sbuiltinarg">sbuiltinarg</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#a">a</a></span>) <span class="id">v</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#v">v</a></span> <span class="id">v</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3193')">Proof.</div>
<div class="proofscript" id="proof3193">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">m</span>'; <span class="tactic">intros</span> <span class="id">MG</span> <span class="id">AG</span> <span class="id">SP</span> <span class="id">MI</span>. <span class="tactic">induction</span> 1; <span class="tactic">simpl</span>.<br/>
- <span class="id">exists</span> <span class="id">rs</span>'#(<span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span> <span class="id">ctx</span> <span class="id">x</span>); <span class="tactic">split</span>. <span class="id">constructor</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_val_reg">agree_val_reg</a></span>; <span class="tactic">eauto</span>.<br/>
- <span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">barg</span>.<br/>
- <span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">barg</span>.<br/>
- <span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">barg</span>.<br/>
- <span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">barg</span>.<br/>
- <span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.loadv_inject">Mem.loadv_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.add">Ptrofs.add</a></span> <span class="id">ofs</span> (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span> <span class="id">ctx</span>)))).<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.add_zero_l">Ptrofs.add_zero_l</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">v</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span>). <span class="id">exists</span> <span class="id">v</span>'; <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="id">constructor</span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.add_zero_l">Ptrofs.add_zero_l</a></span>; <span class="tactic">auto</span>.<br/>
- <span class="id">econstructor</span>; <span class="tactic">split</span>. <span class="id">constructor</span>. <span class="tactic">simpl</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> ! <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.add_zero_l">Ptrofs.add_zero_l</a></span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">assert</span> (<span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id">F</span> (<span class="id"><a href="compcert.common.Globalenvs.html#Genv.symbol_address">Genv.symbol_address</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.ge">ge</a></span> <span class="id">id</span> <span class="id">ofs</span>) (<span class="id"><a href="compcert.common.Globalenvs.html#Genv.symbol_address">Genv.symbol_address</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.tge">tge</a></span> <span class="id">id</span> <span class="id">ofs</span>)).<br/>
&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.symbol_address">Genv.symbol_address</a></span>; <span class="tactic">simpl</span>; <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.symbol_address">Genv.symbol_address</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.se">se</a></span> <span class="id">id</span>) <span class="kwd">as</span> [<span class="id">b</span>|] <span class="id">eqn</span>:<span class="id">FS</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">edestruct</span> @<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_symbol_match">Genv.find_symbol_match</a></span> <span class="kwd">as</span> (<span class="id">tb</span> &amp; <span class="id">Htb</span> &amp; <span class="id">TFS</span>); <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id">TFS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.add_zero">Ptrofs.add_zero</a></span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.loadv_inject">Mem.loadv_inject</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">v</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span>).<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>'; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">barg</span>.<br/>
- <span class="id">econstructor</span>; <span class="tactic">split</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.symbol_address">Genv.symbol_address</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.se">se</a></span> <span class="id">id</span>) <span class="kwd">as</span> [<span class="id">b</span>|] <span class="id">eqn</span>:<span class="id">FS</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">edestruct</span> @<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_symbol_match">Genv.find_symbol_match</a></span> <span class="kwd">as</span> (<span class="id">tb</span> &amp; <span class="id">Htb</span> &amp; <span class="id">TFS</span>); <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id">TFS</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.add_zero">Ptrofs.add_zero</a></span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">destruct</span> <span class="id">IHeval_builtin_arg1</span> <span class="kwd">as</span> (<span class="id">v1</span>' &amp; <span class="id">A1</span> &amp; <span class="id">B1</span>).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">IHeval_builtin_arg2</span> <span class="kwd">as</span> (<span class="id">v2</span>' &amp; <span class="id">A2</span> &amp; <span class="id">B2</span>).<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">barg</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Values.html#Val.longofwords_inject">Val.longofwords_inject</a></span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">destruct</span> <span class="id">IHeval_builtin_arg1</span> <span class="kwd">as</span> (<span class="id">v1</span>' &amp; <span class="id">A1</span> &amp; <span class="id">B1</span>).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">IHeval_builtin_arg2</span> <span class="kwd">as</span> (<span class="id">v2</span>' &amp; <span class="id">A2</span> &amp; <span class="id">B2</span>).<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">barg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="compcert.x86_64.Archi.html#ptr64">Archi.ptr64</a></span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="compcert.common.Values.html#Val.add_inject">Val.add_inject</a></span>, <span class="id"><a href="compcert.common.Values.html#Val.addl_inject">Val.addl_inject</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="tr_builtin_args">tr_builtin_args</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">ctx</span> <span class="id">rs</span> <span class="id">rs</span>' <span class="id">sp</span> <span class="id">sp</span>' <span class="id">m</span> <span class="id">m</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Globalenvs.html#Genv.match_stbls">Genv.match_stbls</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.se">se</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.tse">tse</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span> <span class="id">rs</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id">sp</span>', <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.inject">Mem.inject</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">al</span> <span class="id">vl</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Events.html#eval_builtin_args">eval_builtin_args</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.ge">ge</a></span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span>#<span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span>) (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#al">al</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#vl">vl</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">vl</span>', <span class="id"><a href="compcert.common.Events.html#eval_builtin_args">eval_builtin_args</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.tge">tge</a></span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="id">rs</span>'#<span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span>) (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id">m</span>' (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#sbuiltinarg">sbuiltinarg</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#al">al</a></span>) <span class="id">vl</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="compcert.common.Values.html#Val.inject_list">Val.inject_list</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#vl">vl</a></span> <span class="id">vl</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3194')">Proof.</div>
<div class="proofscript" id="proof3194">
&nbsp;&nbsp;<span class="tactic">induction</span> 5; <span class="tactic">simpl</span>.<br/>
- <span class="id">exists</span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="compcert.common.Values.html#val">val</a></span>); <span class="tactic">split</span>; <span class="id">constructor</span>.<br/>
- <span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#tr_builtin_arg">tr_builtin_arg</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">v1</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span>).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">IHlist_forall2</span> <span class="kwd">as</span> (<span class="id">vl</span>' &amp; <span class="id">C</span> &amp; <span class="id">D</span>).<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">v1</span>' :: <span class="id">vl</span>'); <span class="tactic">split</span>; <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<h2> Relating stacks </h2>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="match_stacks">match_stacks</a></span> (<span class="id">F</span>: <span class="id"><a href="compcert.common.Values.html#meminj">meminj</a></span>) (<span class="id">m</span> <span class="id">m</span>': <span class="id"><a href="compcert.common.Memory.html#mem">mem</a></span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.RTL.html#stackframe">stackframe</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.RTL.html#stackframe">stackframe</a></span> -&gt; <span class="id"><a href="compcert.common.Values.html#block">block</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="match_stacks_nil">match_stacks_nil</a></span>: <span class="kwd">forall</span> <span class="id">bound</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MG</span>: <span class="id"><a href="compcert.common.LanguageInterface.html#mit_incr">mit_incr</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.w">w</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">NB</span>: <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> (<span class="id"><a href="compcert.common.Globalenvs.html#Genv.genv_next">Genv.genv_next</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.se">se</a></span>) (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TNB</span>: <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> (<span class="id"><a href="compcert.common.Globalenvs.html#Genv.genv_next">Genv.genv_next</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.tse">tse</a></span>) (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">m</span>'))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">BELOW</span>: <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> (<span class="id"><a href="compcert.common.Globalenvs.html#Genv.genv_next">Genv.genv_next</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.tse">tse</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="match_stacks_cons">match_stacks_cons</a></span>: <span class="kwd">forall</span> <span class="id">res</span> <span class="id">f</span> <span class="id">sp</span> <span class="id">pc</span> <span class="id">rs</span> <span class="id">stk</span> <span class="id">f</span>' <span class="id">sp</span>' <span class="id">rs</span>' <span class="id">stk</span>' <span class="id">bound</span> <span class="id">fenv</span> <span class="id">ctx</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MS</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">sp</span>' <span class="id">rs</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">COMPAT</span>: <span class="id"><a href="compcert.backend.Inliningspec.html#fenv_compat">fenv_compat</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.prog">prog</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#fenv">fenv</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FB</span>: <span class="id"><a href="compcert.backend.Inliningspec.html#tr_funbody">tr_funbody</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#fenv">fenv</a></span> <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span> <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_code">fn_code</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">AG</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span> <span class="id">rs</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SP</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id">sp</span>', <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">PRIV</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#range_private">range_private</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id">sp</span>' (<span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span>) + <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mstk">mstk</a></span>)) <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SSZ1</span>: 0 &lt;= <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>) &lt; <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SSZ2</span>: <span class="kwd">forall</span> <span class="id">ofs</span>, <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m</span>' <span class="id">sp</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Max">Max</a></span> <span class="id"><a href="compcert.common.Memtype.html#Nonempty">Nonempty</a></span> -&gt; 0 &lt;= <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> &lt;= <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">RES</span>: <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#res">res</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mreg">mreg</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">BELOW</span>: <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id">sp</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.RTL.html#Stackframe">Stackframe</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#res">res</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#pc">pc</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span> :: <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.RTL.html#Stackframe">Stackframe</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#res">res</a></span>) <span class="id">f</span>' (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (<span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#pc">pc</a></span>) <span class="id">rs</span>' :: <span class="id">stk</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="match_stacks_untailcall">match_stacks_untailcall</a></span>: <span class="kwd">forall</span> <span class="id">stk</span> <span class="id">res</span> <span class="id">f</span>' <span class="id">sp</span>' <span class="id">rpc</span> <span class="id">rs</span>' <span class="id">stk</span>' <span class="id">bound</span> <span class="id">ctx</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MS</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">sp</span>' <span class="id">rs</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">PRIV</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#range_private">range_private</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id">sp</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span>) <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SSZ1</span>: 0 &lt;= <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>) &lt; <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SSZ2</span>: <span class="kwd">forall</span> <span class="id">ofs</span>, <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m</span>' <span class="id">sp</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Max">Max</a></span> <span class="id"><a href="compcert.common.Memtype.html#Nonempty">Nonempty</a></span> -&gt; 0 &lt;= <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> &lt;= <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">RET</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#retinfo">retinfo</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.backend.Inliningproof.html#rpc">rpc</a></span>, <span class="id"><a href="compcert.backend.Inliningproof.html#res">res</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">BELOW</span>: <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id">sp</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.RTL.html#Stackframe">Stackframe</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#res">res</a></span> <span class="id">f</span>' (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#rpc">rpc</a></span> <span class="id">rs</span>' :: <span class="id">stk</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span><br/>
<br/>
<span class="kwd">with</span> <span class="id"><a name="match_stacks_inside">match_stacks_inside</a></span> (<span class="id">F</span>: <span class="id">meminj</span>) (<span class="id">m</span> <span class="id">m</span>': <span class="id">mem</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.RTL.html#stackframe">stackframe</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.RTL.html#stackframe">stackframe</a></span> -&gt; <span class="id"><a href="compcert.backend.RTL.html#function">function</a></span> -&gt; <span class="id"><a href="compcert.backend.Inlining.html#context">context</a></span> -&gt; <span class="id"><a href="compcert.common.Values.html#block">block</a></span> -&gt; <span class="id"><a href="compcert.backend.RTL.html#regset">regset</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="match_stacks_inside_base">match_stacks_inside_base</a></span>: <span class="kwd">forall</span> <span class="id">stk</span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id">ctx</span> <span class="id">sp</span>' <span class="id">rs</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MS</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">sp</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">RET</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#retinfo">retinfo</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">DSTK</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span>) = 0),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">sp</span>' <span class="id">rs</span>'<br/>
&nbsp;&nbsp;| <span class="id"><a name="match_stacks_inside_inlined">match_stacks_inside_inlined</a></span>: <span class="kwd">forall</span> <span class="id">res</span> <span class="id">f</span> <span class="id">sp</span> <span class="id">pc</span> <span class="id">rs</span> <span class="id">stk</span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id">fenv</span> <span class="id">ctx</span> <span class="id">sp</span>' <span class="id">rs</span>' <span class="id">ctx</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MS</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id">ctx</span>' <span class="id">sp</span>' <span class="id">rs</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">COMPAT</span>: <span class="id"><a href="compcert.backend.Inliningspec.html#fenv_compat">fenv_compat</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.prog">prog</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#fenv">fenv</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FB</span>: <span class="id"><a href="compcert.backend.Inliningspec.html#tr_funbody">tr_funbody</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#fenv">fenv</a></span> <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>) <span class="id">ctx</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span> <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_code">fn_code</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">AG</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id">ctx</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span> <span class="id">rs</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SP</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id">sp</span>', <span class="id">ctx</span>'.(<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">PAD</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#range_private">range_private</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id">sp</span>' (<span class="id">ctx</span>'.(<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span>) + <span class="id">ctx</span>'.(<span class="id"><a href="compcert.backend.Inlining.html#mstk">mstk</a></span>)) <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">RES</span>: <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#res">res</a></span> <span class="id">ctx</span>'.(<span class="id"><a href="compcert.backend.Inlining.html#mreg">mreg</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">RET</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#retinfo">retinfo</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id">ctx</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#pc">pc</a></span>, <span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span> <span class="id">ctx</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#res">res</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">BELOW</span>: <span class="id"><a href="compcert.backend.Inliningspec.html#context_below">context_below</a></span> <span class="id">ctx</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SBELOW</span>: <span class="id"><a href="compcert.backend.Inliningspec.html#context_stack_call">context_stack_call</a></span> <span class="id">ctx</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' (<span class="id"><a href="compcert.backend.RTL.html#Stackframe">Stackframe</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#res">res</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#pc">pc</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span> :: <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">stk</span>' <span class="id">f</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">sp</span>' <span class="id">rs</span>'.<br/>
<br/>
<div class="doc">Properties of match_stacks </div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="INLINING.MATCH_STACKS">MATCH_STACKS</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="INLINING.MATCH_STACKS.F">F</a></span>: <span class="id"><a href="compcert.common.Values.html#meminj">meminj</a></span>.<br/>
<span class="kwd">Variables</span> <span class="id"><a name="INLINING.MATCH_STACKS.m">m</a></span> <span class="id">m</span>': <span class="id"><a href="compcert.common.Memory.html#mem">mem</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="match_stacks_globalenvs">match_stacks_globalenvs</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">stk</span> <span class="id">stk</span>' <span class="id">bound</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span> -&gt; <span class="id"><a href="compcert.common.Globalenvs.html#Genv.match_stbls">Genv.match_stbls</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.se">se</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.tse">tse</a></span><br/>
<span class="kwd">with</span> <span class="id"><a name="match_stacks_inside_globalenvs">match_stacks_inside_globalenvs</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">stk</span> <span class="id">stk</span>' <span class="id">f</span> <span class="id">ctx</span> <span class="id">sp</span> <span class="id">rs</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> <span class="id">rs</span>' -&gt; <span class="id"><a href="compcert.common.Globalenvs.html#Genv.match_stbls">Genv.match_stbls</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.se">se</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.tse">tse</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3195')">Proof.</div>
<div class="proofscript" id="proof3195">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="compcert.common.LanguageInterface.html#cc_inj_match_stbls">cc_inj_match_stbls</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="match_stacks_bound">match_stacks_bound</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">stk</span> <span class="id">stk</span>' <span class="id">bound</span> <span class="id">bound1</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#bound1">bound1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#bound1">bound1</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3196')">Proof.</div>
<div class="proofscript" id="proof3196">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_nil">match_stacks_nil</a></span>; <span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Ple_trans">Ple_trans</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_cons">match_stacks_cons</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.lt_le_trans">Pos.lt_le_trans</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_untailcall">match_stacks_untailcall</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.lt_le_trans">Pos.lt_le_trans</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="INLINING.MATCH_STACKS.F1">F1</a></span>: <span class="id"><a href="compcert.common.Values.html#meminj">meminj</a></span>.<br/>
<span class="kwd">Variables</span> <span class="id"><a name="INLINING.MATCH_STACKS.m1">m1</a></span> <span class="id">m1</span>': <span class="id"><a href="compcert.common.Memory.html#mem">mem</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="INLINING.MATCH_STACKS.INCR">INCR</a></span>: <span class="id"><a href="compcert.common.Values.html#inject_incr">inject_incr</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.F1">F1</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="mit_incr_invariant">mit_incr_invariant</a></span> <span class="id">bound</span>:<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">b1</span> <span class="id">b2</span> <span class="id">delta</span>, <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.F1">F1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.Inliningproof.html#b2">b2</a></span>, <span class="id"><a href="compcert.backend.Inliningproof.html#delta">delta</a></span>) -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b2">b2</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span> -&gt; <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.Inliningproof.html#b2">b2</a></span>, <span class="id"><a href="compcert.backend.Inliningproof.html#delta">delta</a></span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> (<span class="id"><a href="compcert.common.Globalenvs.html#Genv.genv_next">Genv.genv_next</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.tse">tse</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.LanguageInterface.html#mit_incr">mit_incr</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.w">w</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.F">F</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.LanguageInterface.html#mit_incr">mit_incr</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.w">w</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.F1">F1</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3197')">Proof.</div>
<div class="proofscript" id="proof3197">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">INJ</span> <span class="id">BELOW</span> [<span class="id">MGINCR</span> <span class="id">MGSEP</span>]. <span class="tactic">destruct</span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.GE">GE</a></span>. <span class="tactic">split</span>; <span class="id">cbn</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Values.html#inject_incr_trans">inject_incr_trans</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">b1</span> <span class="id">b2</span> <span class="id">delta</span> <span class="id">Hb1</span> <span class="id">Hb1</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.F">F</a></span> <span class="id">b1</span>) <span class="kwd">as</span> [[<span class="id">xb1</span>' <span class="id">xdelta</span>]|] <span class="id">eqn</span>:<span class="id">Hb1</span>''.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.INCR">INCR</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hb1</span>'') <span class="kwd">in</span> <span class="id">Hb1</span>'. <span class="id">inv</span> <span class="id">Hb1</span>'. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#plt">plt</a></span> <span class="id">b1</span> (<span class="id"><a href="compcert.common.Globalenvs.html#Genv.genv_next">Genv.genv_next</a></span> <span class="id">se1</span>)) <span class="kwd">as</span> [?|?]; <span class="tactic">try</span> <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.mge_dom">Genv.mge_dom</a></span> <span class="kwd">in</span> <span class="id">p</span> <span class="kwd">as</span> [? ?]; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="compcert.common.LanguageInterface.html#cc_inj_match_stbls">cc_inj_match_stbls</a></span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#plt">plt</a></span> <span class="id">b2</span> <span class="id">bound</span>) <span class="kwd">as</span> [<span class="id">Hb2</span>|<span class="id">Hb2</span>]; <span class="tactic">try</span> <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">INJ</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hb1</span>' <span class="id">Hb2</span>). <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="match_stacks_invariant">match_stacks_invariant</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">stk</span> <span class="id">stk</span>' <span class="id">bound</span>, <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">INJ</span>: <span class="kwd">forall</span> <span class="id">b1</span> <span class="id">b2</span> <span class="id">delta</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.F1">F1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.Inliningproof.html#b2">b2</a></span>, <span class="id"><a href="compcert.backend.Inliningproof.html#delta">delta</a></span>) -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b2">b2</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span> -&gt; <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.Inliningproof.html#b2">b2</a></span>, <span class="id"><a href="compcert.backend.Inliningproof.html#delta">delta</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">NB</span>: <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.m">m</a></span>) (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.m1">m1</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TNB</span>: <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">m</span>') (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">m1</span>'))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">PERM1</span>: <span class="kwd">forall</span> <span class="id">b1</span> <span class="id">b2</span> <span class="id">delta</span> <span class="id">ofs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.F1">F1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.Inliningproof.html#b2">b2</a></span>, <span class="id"><a href="compcert.backend.Inliningproof.html#delta">delta</a></span>) -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b2">b2</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.m1">m1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b1">b1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Max">Max</a></span> <span class="id"><a href="compcert.common.Memtype.html#Nonempty">Nonempty</a></span> -&gt; <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.m">m</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b1">b1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Max">Max</a></span> <span class="id"><a href="compcert.common.Memtype.html#Nonempty">Nonempty</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">PERM2</span>: <span class="kwd">forall</span> <span class="id">b</span> <span class="id">ofs</span>, <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Cur">Cur</a></span> <span class="id"><a href="compcert.common.Memtype.html#Freeable">Freeable</a></span> -&gt; <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m1</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Cur">Cur</a></span> <span class="id"><a href="compcert.common.Memtype.html#Freeable">Freeable</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">PERM3</span>: <span class="kwd">forall</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>, <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m1</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#k">k</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#p">p</a></span> -&gt; <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#k">k</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#p">p</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.F1">F1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.m1">m1</a></span> <span class="id">m1</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span><br/>
<br/>
<span class="kwd">with</span> <span class="id"><a name="match_stacks_inside_invariant">match_stacks_inside_invariant</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">stk</span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id">ctx</span> <span class="id">sp</span>' <span class="id">rs1</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">sp</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#rs1">rs1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">rs2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">RS</span>: <span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dreg">dreg</a></span>) -&gt; <span class="id"><a href="compcert.backend.Inliningproof.html#rs2">rs2</a></span>#<span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> = <span class="id"><a href="compcert.backend.Inliningproof.html#rs1">rs1</a></span>#<span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">NB</span>: <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.m">m</a></span>) (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.m1">m1</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TNB</span>: <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">m</span>') (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">m1</span>'))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">INJ</span>: <span class="kwd">forall</span> <span class="id">b1</span> <span class="id">b2</span> <span class="id">delta</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.F1">F1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.Inliningproof.html#b2">b2</a></span>, <span class="id"><a href="compcert.backend.Inliningproof.html#delta">delta</a></span>) -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b2">b2</a></span> <span class="id">sp</span>' -&gt; <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.Inliningproof.html#b2">b2</a></span>, <span class="id"><a href="compcert.backend.Inliningproof.html#delta">delta</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">PERM1</span>: <span class="kwd">forall</span> <span class="id">b1</span> <span class="id">b2</span> <span class="id">delta</span> <span class="id">ofs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.F1">F1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.Inliningproof.html#b2">b2</a></span>, <span class="id"><a href="compcert.backend.Inliningproof.html#delta">delta</a></span>) -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b2">b2</a></span> <span class="id">sp</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.m1">m1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b1">b1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Max">Max</a></span> <span class="id"><a href="compcert.common.Memtype.html#Nonempty">Nonempty</a></span> -&gt; <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.m">m</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b1">b1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Max">Max</a></span> <span class="id"><a href="compcert.common.Memtype.html#Nonempty">Nonempty</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">PERM2</span>: <span class="kwd">forall</span> <span class="id">b</span> <span class="id">ofs</span>, <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id">sp</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Cur">Cur</a></span> <span class="id"><a href="compcert.common.Memtype.html#Freeable">Freeable</a></span> -&gt; <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m1</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Cur">Cur</a></span> <span class="id"><a href="compcert.common.Memtype.html#Freeable">Freeable</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">PERM3</span>: <span class="kwd">forall</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>, <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id">sp</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m1</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#k">k</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#p">p</a></span> -&gt; <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#k">k</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#p">p</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.F1">F1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.m1">m1</a></span> <span class="id">m1</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">sp</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#rs2">rs2</a></span>.<br/>
<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3198')">Proof.</div>
<div class="proofscript" id="proof3198">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;nil&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_nil">match_stacks_nil</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#mit_incr_invariant">mit_incr_invariant</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">xomega</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;cons&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_cons">match_stacks_cons</a></span> <span class="kwd">with</span> (<span class="id">fenv</span> := <span class="id">fenv</span>) (<span class="id">ctx</span> := <span class="id">ctx</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">match_stacks_inside_invariant</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id">INJ</span>; <span class="tactic">eauto</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id">PERM1</span>; <span class="tactic">eauto</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id">PERM2</span>; <span class="tactic">eauto</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id">PERM3</span>; <span class="tactic">eauto</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs_incr">agree_regs_incr</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#range_private_invariant">range_private_invariant</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;untailcall&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_untailcall">match_stacks_untailcall</a></span> <span class="kwd">with</span> (<span class="id">ctx</span> := <span class="id">ctx</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">match_stacks_inside_invariant</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id">INJ</span>; <span class="tactic">eauto</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id">PERM1</span>; <span class="tactic">eauto</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id">PERM2</span>; <span class="tactic">eauto</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id">PERM3</span>; <span class="tactic">eauto</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#range_private_invariant">range_private_invariant</a></span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;base&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_base">match_stacks_inside_base</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">match_stacks_invariant</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id">INJ</span>; <span class="tactic">eauto</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id">PERM1</span>; <span class="tactic">eauto</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id">PERM2</span>; <span class="tactic">eauto</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id">PERM3</span>; <span class="tactic">eauto</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;inlined&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_inlined">match_stacks_inside_inlined</a></span> <span class="kwd">with</span> (<span class="id">fenv</span> := <span class="id">fenv</span>) (<span class="id">ctx</span>' := <span class="id">ctx</span>'); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHmatch_stacks_inside</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">RS</span>. <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">BELOW</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs_incr">agree_regs_incr</a></span> <span class="kwd">with</span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.F">F</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs_invariant">agree_regs_invariant</a></span> <span class="kwd">with</span> <span class="id">rs</span>'; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">RS</span>. <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">BELOW</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#range_private_invariant">range_private_invariant</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id">INJ</span>; <span class="tactic">eauto</span>. <span class="id">xomega</span>. <span class="tactic">eapply</span> <span class="id">PERM1</span>; <span class="tactic">eauto</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id">PERM2</span>; <span class="tactic">eauto</span>. <span class="id">xomega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="match_stacks_empty">match_stacks_empty</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">stk</span> <span class="id">stk</span>' <span class="id">bound</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span> -&gt; <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> -&gt; <span class="id">stk</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
<span class="kwd">with</span> <span class="id"><a name="match_stacks_inside_empty">match_stacks_inside_empty</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">stk</span> <span class="id">stk</span>' <span class="id">f</span> <span class="id">ctx</span> <span class="id">sp</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span> -&gt; <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> -&gt; <span class="id">stk</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> /\ <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#retinfo">retinfo</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3199')">Proof.</div>
<div class="proofscript" id="proof3199">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">match_stacks_inside_empty</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>]. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id">match_stacks_empty</span>; <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">discriminate</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="match_stacks_nextblock">match_stacks_nextblock</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">stk</span> <span class="id">stk</span>' <span class="id">bound</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> (<span class="id"><a href="compcert.common.Globalenvs.html#Genv.genv_next">Genv.genv_next</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.se">se</a></span>) (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.m">m</a></span>) /\<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> (<span class="id"><a href="compcert.common.Globalenvs.html#Genv.genv_next">Genv.genv_next</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.tse">tse</a></span>) (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">m</span>')<br/>
<span class="kwd">with</span> <span class="id"><a name="match_stacks_inside_nextblock">match_stacks_inside_nextblock</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">stk</span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id">ctx</span> <span class="id">sp</span>' <span class="id">rs1</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">sp</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#rs1">rs1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> (<span class="id"><a href="compcert.common.Globalenvs.html#Genv.genv_next">Genv.genv_next</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.se">se</a></span>) (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS.m">m</a></span>) /\<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> (<span class="id"><a href="compcert.common.Globalenvs.html#Genv.genv_next">Genv.genv_next</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.tse">tse</a></span>) (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">m</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3200')">Proof.</div>
<div class="proofscript" id="proof3200">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.MATCH_STACKS">MATCH_STACKS</a></span>.<br/>
<br/>
<div class="doc">Preservation by assignment to a register </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="match_stacks_inside_set_reg">match_stacks_inside_set_reg</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">stk</span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id">ctx</span> <span class="id">sp</span>' <span class="id">rs</span>' <span class="id">r</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">sp</span>' <span class="id">rs</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">sp</span>' (<span class="id">rs</span>'#(<span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span>) &lt;- <span class="id"><a href="compcert.backend.Inliningproof.html#v">v</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3201')">Proof.</div>
<div class="proofscript" id="proof3201">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_invariant">match_stacks_inside_invariant</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Registers.html#Regmap.gso">Regmap.gso</a></span>. <span class="id">zify</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Inliningspec.html#shiftpos_eq">shiftpos_eq</a></span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="id">xomega</span>. <span class="id">xomega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="match_stacks_inside_set_res">match_stacks_inside_set_res</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">stk</span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id">ctx</span> <span class="id">sp</span>' <span class="id">rs</span>' <span class="id">res</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">sp</span>' <span class="id">rs</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">sp</span>' (<span class="id"><a href="compcert.backend.Registers.html#regmap_setres">regmap_setres</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#sbuiltinres">sbuiltinres</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#res">res</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#v">v</a></span> <span class="id">rs</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3202')">Proof.</div>
<div class="proofscript" id="proof3202">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">res</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_set_reg">match_stacks_inside_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Preservation by a memory store </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="match_stacks_inside_store">match_stacks_inside_store</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">stk</span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id">ctx</span> <span class="id">sp</span>' <span class="id">rs</span>' <span class="id">chunk</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">v</span> <span class="id">m1</span> <span class="id">chunk</span>' <span class="id">b</span>' <span class="id">ofs</span>' <span class="id">v</span>' <span class="id">m1</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">sp</span>' <span class="id">rs</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.store">Mem.store</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#chunk">chunk</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#v">v</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m1">m1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.store">Mem.store</a></span> <span class="id">chunk</span>' <span class="id">m</span>' <span class="id">b</span>' <span class="id">ofs</span>' <span class="id">v</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m1</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m1">m1</a></span> <span class="id">m1</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">sp</span>' <span class="id">rs</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3203')">Proof.</div>
<div class="proofscript" id="proof3203">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_invariant">match_stacks_inside_invariant</a></span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock_store">Mem.nextblock_store</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>). <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock_store">Mem.nextblock_store</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H1</span>). <span class="id">xomega</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Preservation by an allocation </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="match_stacks_inside_alloc_left">match_stacks_inside_alloc_left</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">stk</span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id">ctx</span> <span class="id">sp</span>' <span class="id">rs</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">sp</span>' <span class="id">rs</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sz</span> <span class="id">m1</span> <span class="id">b</span> <span class="id">F1</span> <span class="id">delta</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.alloc">Mem.alloc</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> 0 <span class="id"><a href="compcert.backend.Inliningproof.html#sz">sz</a></span> = (<span class="id"><a href="compcert.backend.Inliningproof.html#m1">m1</a></span>, <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#inject_incr">inject_incr</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F1">F1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#F1">F1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id">sp</span>', <span class="id"><a href="compcert.backend.Inliningproof.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">b1</span>, <span class="id"><a href="compcert.backend.Inliningproof.html#b1">b1</a></span> &lt;&gt; <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> -&gt; <span class="id"><a href="compcert.backend.Inliningproof.html#F1">F1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b1">b1</a></span> = <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b1">b1</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#delta">delta</a></span> &gt;= <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F1">F1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m1">m1</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">sp</span>' <span class="id">rs</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3204')">Proof.</div>
<div class="proofscript" id="proof3204">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;base&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_base">match_stacks_inside_base</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_invariant">match_stacks_invariant</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Values.html#eq_block">eq_block</a></span> <span class="id">b1</span> <span class="id">b</span>).<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">b1</span>. <span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H4</span>; <span class="id">inv</span> <span class="id">H4</span>. <span class="id">eelim</span> <span class="id"><a href="compcert.lib.Coqlib.html#Plt_strict">Plt_strict</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H4</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock_alloc">Mem.nextblock_alloc</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>). <span class="id">xomega</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_alloc_inv">Mem.perm_alloc_inv</a></span>; <span class="tactic">eauto</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Values.html#eq_block">eq_block</a></span> <span class="id">b1</span> <span class="id">b</span>); <span class="tactic">intros</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">b1</span>. <span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H4</span>. <span class="id">inv</span> <span class="id">H4</span>. <span class="id">eelim</span> <span class="id"><a href="compcert.lib.Coqlib.html#Plt_strict">Plt_strict</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;inlined&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_inlined">match_stacks_inside_inlined</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHmatch_stacks_inside</span>; <span class="tactic">eauto</span>. <span class="tactic">destruct</span> <span class="id">SBELOW</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs_incr">agree_regs_incr</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#range_private_invariant">range_private_invariant</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_alloc_inv">Mem.perm_alloc_inv</a></span>; <span class="tactic">eauto</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Values.html#eq_block">eq_block</a></span> <span class="id">b0</span> <span class="id">b</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">b0</span>. <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H5</span>; <span class="id">inv</span> <span class="id">H5</span>. <span class="tactic">elimtype</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H5</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Preservation by freeing </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="match_stacks_free_left">match_stacks_free_left</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">stk</span> <span class="id">stk</span>' <span class="id">sp</span> <span class="id">b</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">m1</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.free">Mem.free</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#lo">lo</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#hi">hi</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m1">m1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m1">m1</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3205')">Proof.</div>
<div class="proofscript" id="proof3205">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_invariant">match_stacks_invariant</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock_free">Mem.nextblock_free</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>). <span class="id">xomega</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_free_3">Mem.perm_free_3</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="match_stacks_free_right">match_stacks_free_right</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">stk</span> <span class="id">stk</span>' <span class="id">sp</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">m1</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.free">Mem.free</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#lo">lo</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#hi">hi</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m1</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m1</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3206')">Proof.</div>
<div class="proofscript" id="proof3206">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_invariant">match_stacks_invariant</a></span>; <span class="tactic">eauto</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock_free">Mem.nextblock_free</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>). <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_free_1">Mem.perm_free_1</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_free_3">Mem.perm_free_3</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="min_alignment_sound">min_alignment_sound</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sz</span> <span class="id">n</span>, (<span class="id"><a href="compcert.backend.Inlining.html#min_alignment">min_alignment</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sz">sz</a></span> | <span class="id"><a href="compcert.backend.Inliningproof.html#n">n</a></span>) -&gt; <span class="id"><a href="compcert.common.Memory.html#Mem.inj_offset_aligned">Mem.inj_offset_aligned</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#n">n</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sz">sz</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3207')">Proof.</div>
<div class="proofscript" id="proof3207">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Inlining.html#min_alignment">min_alignment</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (2 &lt;= <span class="id">sz</span> -&gt; (2 | <span class="id">n</span>)). <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zle">zle</a></span> <span class="id">sz</span> 1). <span class="id">omegaContradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zle">zle</a></span> <span class="id">sz</span> 2). <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zle">zle</a></span> <span class="id">sz</span> 4). <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Zdivides_trans">Zdivides_trans</a></span> <span class="kwd">with</span> 4; <span class="tactic">auto</span>. <span class="id">exists</span> 2; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Zdivides_trans">Zdivides_trans</a></span> <span class="kwd">with</span> 8; <span class="tactic">auto</span>. <span class="id">exists</span> 4; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (4 &lt;= <span class="id">sz</span> -&gt; (4 | <span class="id">n</span>)). <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zle">zle</a></span> <span class="id">sz</span> 1). <span class="id">omegaContradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zle">zle</a></span> <span class="id">sz</span> 2). <span class="id">omegaContradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zle">zle</a></span> <span class="id">sz</span> 4). <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Zdivides_trans">Zdivides_trans</a></span> <span class="kwd">with</span> 8; <span class="tactic">auto</span>. <span class="id">exists</span> 2; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (8 &lt;= <span class="id">sz</span> -&gt; (8 | <span class="id">n</span>)). <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zle">zle</a></span> <span class="id">sz</span> 1). <span class="id">omegaContradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zle">zle</a></span> <span class="id">sz</span> 2). <span class="id">omegaContradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zle">zle</a></span> <span class="id">sz</span> 4). <span class="id">omegaContradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">chunk</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_1_l">Z.divide_1_l</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_1_l">Z.divide_1_l</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H2</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H2</span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Preservation by external calls </div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="INLINING.EXTCALL">EXTCALL</a></span>.<br/>
<br/>
<span class="kwd">Variables</span> <span class="id"><a name="INLINING.EXTCALL.F1">F1</a></span> <span class="id"><a name="INLINING.EXTCALL.F2">F2</a></span>: <span class="id"><a href="compcert.common.Values.html#meminj">meminj</a></span>.<br/>
<span class="kwd">Variables</span> <span class="id"><a name="INLINING.EXTCALL.m1">m1</a></span> <span class="id"><a name="INLINING.EXTCALL.m2">m2</a></span> <span class="id">m1</span>' <span class="id">m2</span>': <span class="id"><a href="compcert.common.Memory.html#mem">mem</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="INLINING.EXTCALL.MAXPERM">MAXPERM</a></span>: <span class="kwd">forall</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">p</span>, <span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.EXTCALL.m1">m1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> -&gt; <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.EXTCALL.m2">m2</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Max">Max</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#p">p</a></span> -&gt; <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.EXTCALL.m1">m1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Max">Max</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#p">p</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id">MAXPERM</span>': <span class="kwd">forall</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">p</span>, <span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="id">m1</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> -&gt; <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m2</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Max">Max</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#p">p</a></span> -&gt; <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m1</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Max">Max</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#p">p</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="INLINING.EXTCALL.UNCHANGED">UNCHANGED</a></span>: <span class="id"><a href="compcert.common.Memory.html#Mem.unchanged_on">Mem.unchanged_on</a></span> (<span class="id"><a href="compcert.common.Events.html#loc_out_of_reach">loc_out_of_reach</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.EXTCALL.F1">F1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.EXTCALL.m1">m1</a></span>) <span class="id">m1</span>' <span class="id">m2</span>'.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="INLINING.EXTCALL.INJ">INJ</a></span>: <span class="id"><a href="compcert.common.Memory.html#Mem.inject">Mem.inject</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.EXTCALL.F1">F1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.EXTCALL.m1">m1</a></span> <span class="id">m1</span>'.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="INLINING.EXTCALL.INCR">INCR</a></span>: <span class="id"><a href="compcert.common.Values.html#inject_incr">inject_incr</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.EXTCALL.F1">F1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.EXTCALL.F2">F2</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="INLINING.EXTCALL.SEP">SEP</a></span>: <span class="id"><a href="compcert.common.Events.html#inject_separated">inject_separated</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.EXTCALL.F1">F1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.EXTCALL.F2">F2</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.EXTCALL.m1">m1</a></span> <span class="id">m1</span>'.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="match_stacks_extcall">match_stacks_extcall</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">stk</span> <span class="id">stk</span>' <span class="id">bound</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.EXTCALL.F1">F1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.EXTCALL.m1">m1</a></span> <span class="id">m1</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.EXTCALL.m1">m1</a></span>) (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.EXTCALL.m2">m2</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span> (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">m1</span>') -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.EXTCALL.F2">F2</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.EXTCALL.m2">m2</a></span> <span class="id">m2</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span><br/>
<span class="kwd">with</span> <span class="id"><a name="match_stacks_inside_extcall">match_stacks_inside_extcall</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">stk</span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id">ctx</span> <span class="id">sp</span>' <span class="id">rs</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.EXTCALL.F1">F1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.EXTCALL.m1">m1</a></span> <span class="id">m1</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">sp</span>' <span class="id">rs</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.EXTCALL.m1">m1</a></span>) (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.EXTCALL.m2">m2</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id">sp</span>' (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">m1</span>') -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.EXTCALL.F2">F2</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.EXTCALL.m2">m2</a></span> <span class="id">m2</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">sp</span>' <span class="id">rs</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3208')">Proof.</div>
<div class="proofscript" id="proof3208">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_nil">match_stacks_nil</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#mit_incr_invariant">mit_incr_invariant</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.EXTCALL.F1">F1</a></span> <span class="id">b1</span>) <span class="kwd">as</span> [[<span class="id">xb2</span> <span class="id">xdelta</span>]|] <span class="id">eqn</span>:<span class="id">HF1</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.EXTCALL.INCR">INCR</a></span> <span class="kwd">in</span> <span class="id">HF1</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.EXTCALL.SEP">SEP</a></span>; <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">xomega</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.unchanged_on_nextblock">Mem.unchanged_on_nextblock</a></span> <span class="kwd">in</span> <span class="id">UNCHANGED</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_cons">match_stacks_cons</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">match_stacks_inside_extcall</span>; <span class="tactic">eauto</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs_incr">agree_regs_incr</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#range_private_extcall">range_private_extcall</a></span>; <span class="tactic">eauto</span>. <span class="tactic">red</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">SSZ2</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id">MAXPERM</span>'; <span class="tactic">auto</span>. <span class="tactic">red</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_untailcall">match_stacks_untailcall</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">match_stacks_inside_extcall</span>; <span class="tactic">eauto</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#range_private_extcall">range_private_extcall</a></span>; <span class="tactic">eauto</span>. <span class="tactic">red</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">SSZ2</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id">MAXPERM</span>'; <span class="tactic">auto</span>. <span class="tactic">red</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_base">match_stacks_inside_base</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">match_stacks_extcall</span>; <span class="tactic">eauto</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_inlined">match_stacks_inside_inlined</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs_incr">agree_regs_incr</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#range_private_extcall">range_private_extcall</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.EXTCALL">EXTCALL</a></span>.<br/>
<br/>
<div class="doc">Change of context corresponding to an inlined tailcall </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="align_unchanged">align_unchanged</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">amount</span>, <span class="id"><a href="compcert.backend.Inliningproof.html#amount">amount</a></span> &gt; 0 -&gt; (<span class="id"><a href="compcert.backend.Inliningproof.html#amount">amount</a></span> | <span class="id"><a href="compcert.backend.Inliningproof.html#n">n</a></span>) -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#align">align</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#n">n</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#amount">amount</a></span> = <span class="id"><a href="compcert.backend.Inliningproof.html#n">n</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3209')">Proof.</div>
<div class="proofscript" id="proof3209">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H0</span> <span class="kwd">as</span> [<span class="id">p</span> <span class="id">EQ</span>]. <span class="tactic">subst</span> <span class="id">n</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Coqlib.html#align">align</a></span>. <span class="id">decEq</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Zdiv_unique">Zdiv_unique</a></span> <span class="kwd">with</span> (<span class="id">b</span> := <span class="id">amount</span> - 1). <span class="tactic">omega</span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="match_stacks_inside_inlined_tailcall">match_stacks_inside_inlined_tailcall</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fenv</span> <span class="id">F</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">stk</span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id">ctx</span> <span class="id">sp</span>' <span class="id">rs</span>' <span class="id">ctx</span>' <span class="id">f</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">sp</span>' <span class="id">rs</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#context_below">context_below</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">ctx</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#context_stack_tailcall">context_stack_tailcall</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span> <span class="id">ctx</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id">ctx</span>'.(<span class="id"><a href="compcert.backend.Inlining.html#retinfo">retinfo</a></span>) = <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#retinfo">retinfo</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#range_private">range_private</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id">sp</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span>) <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#tr_funbody">tr_funbody</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#fenv">fenv</a></span> <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>) <span class="id">ctx</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span> <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_code">fn_code</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id">ctx</span>' <span class="id">sp</span>' <span class="id">rs</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3210')">Proof.</div>
<div class="proofscript" id="proof3210">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;base&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_base">match_stacks_inside_base</a></span>; <span class="tactic">eauto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span>. <span class="tactic">rewrite</span> <span class="id">DSTK</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#align_unchanged">align_unchanged</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#min_alignment_pos">min_alignment_pos</a></span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_0_r">Z.divide_0_r</a></span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;inlined&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span> <span class="id">ctx</span> &lt;= <span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span> <span class="id">ctx</span>'). <span class="tactic">rewrite</span> <span class="id">H1</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#align_le">align_le</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#min_alignment_pos">min_alignment_pos</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_inlined">match_stacks_inside_inlined</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id">ofs</span> (<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span> <span class="id">ctx</span>)). <span class="tactic">apply</span> <span class="id">PAD</span>; <span class="tactic">omega</span>. <span class="tactic">apply</span> <span class="id">H3</span>. <span class="id">inv</span> <span class="id">H4</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Inliningspec.html#context_below">context_below</a></span> <span class="kwd">in</span> *. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Inliningspec.html#context_stack_call">context_stack_call</a></span> <span class="kwd">in</span> *. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<h2> Relating states </h2>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="match_states">match_states</a></span>: <span class="id"><a href="compcert.backend.RTL.html#state">RTL.state</a></span> -&gt; <span class="id"><a href="compcert.backend.RTL.html#state">RTL.state</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="match_regular_states">match_regular_states</a></span>: <span class="kwd">forall</span> <span class="id">stk</span> <span class="id">f</span> <span class="id">sp</span> <span class="id">pc</span> <span class="id">rs</span> <span class="id">m</span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id">sp</span>' <span class="id">rs</span>' <span class="id">m</span>' <span class="id">F</span> <span class="id">fenv</span> <span class="id">ctx</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MS</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">sp</span>' <span class="id">rs</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">COMPAT</span>: <span class="id"><a href="compcert.backend.Inliningspec.html#fenv_compat">fenv_compat</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.prog">prog</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#fenv">fenv</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FB</span>: <span class="id"><a href="compcert.backend.Inliningspec.html#tr_funbody">tr_funbody</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#fenv">fenv</a></span> <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span> <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_code">fn_code</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">AG</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span> <span class="id">rs</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SP</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id">sp</span>', <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MINJ</span>: <span class="id"><a href="compcert.common.Memory.html#Mem.inject">Mem.inject</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">VB</span>: <span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="id">m</span>' <span class="id">sp</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">PRIV</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#range_private">range_private</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id">sp</span>' (<span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span>) + <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mstk">mstk</a></span>)) <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SSZ1</span>: 0 &lt;= <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>) &lt; <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SSZ2</span>: <span class="kwd">forall</span> <span class="id">ofs</span>, <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m</span>' <span class="id">sp</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Max">Max</a></span> <span class="id"><a href="compcert.common.Memtype.html#Nonempty">Nonempty</a></span> -&gt; 0 &lt;= <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> &lt;= <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_states">match_states</a></span> (<span class="id"><a href="compcert.backend.RTL.html#State">State</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#pc">pc</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.RTL.html#State">State</a></span> <span class="id">stk</span>' <span class="id">f</span>' (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (<span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#pc">pc</a></span>) <span class="id">rs</span>' <span class="id">m</span>')<br/>
&nbsp;&nbsp;| <span class="id"><a name="match_call_states">match_call_states</a></span>: <span class="kwd">forall</span> <span class="id">stk</span> <span class="id">vf</span> <span class="id">args</span> <span class="id">m</span> <span class="id">stk</span>' <span class="id">vf</span>' <span class="id">args</span>' <span class="id">m</span>' <span class="id">cunit</span> <span class="id">F</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MS</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">m</span>'))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LINK</span>: <span class="id"><a href="compcert.common.Linking.html#linkorder">linkorder</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#cunit">cunit</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.prog">prog</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FINJ</span>: <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#vf">vf</a></span> <span class="id">vf</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">VINJ</span>: <span class="id"><a href="compcert.common.Values.html#Val.inject_list">Val.inject_list</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#args">args</a></span> <span class="id">args</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MINJ</span>: <span class="id"><a href="compcert.common.Memory.html#Mem.inject">Mem.inject</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>'),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_states">match_states</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Callstate">Callstate</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#vf">vf</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#args">args</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.RTL.html#Callstate">Callstate</a></span> <span class="id">stk</span>' <span class="id">vf</span>' <span class="id">args</span>' <span class="id">m</span>')<br/>
&nbsp;&nbsp;| <span class="id"><a name="match_call_regular_states">match_call_regular_states</a></span>: <span class="kwd">forall</span> <span class="id">stk</span> <span class="id">f</span> <span class="id">vf</span> <span class="id">vargs</span> <span class="id">m</span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id">sp</span>' <span class="id">rs</span>' <span class="id">m</span>' <span class="id">F</span> <span class="id">fenv</span> <span class="id">ctx</span> <span class="id">ctx</span>' <span class="id">pc</span>' <span class="id">pc1</span>' <span class="id">rargs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MS</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">sp</span>' <span class="id">rs</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">COMPAT</span>: <span class="id"><a href="compcert.backend.Inliningspec.html#fenv_compat">fenv_compat</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.prog">prog</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#fenv">fenv</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FB</span>: <span class="id"><a href="compcert.backend.Inliningspec.html#tr_funbody">tr_funbody</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#fenv">fenv</a></span> <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span> <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_code">fn_code</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">BELOW</span>: <span class="id"><a href="compcert.backend.Inliningspec.html#context_below">context_below</a></span> <span class="id">ctx</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">NOP</span>: <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_code">fn_code</a></span>)!<span class="id">pc</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.RTL.html#Inop">Inop</a></span> <span class="id">pc1</span>'))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MOVES</span>: <span class="id"><a href="compcert.backend.Inliningspec.html#tr_moves">tr_moves</a></span> <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_code">fn_code</a></span>) <span class="id">pc1</span>' (<span class="id"><a href="compcert.backend.Inlining.html#sregs">sregs</a></span> <span class="id">ctx</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#rargs">rargs</a></span>) (<span class="id"><a href="compcert.backend.Inlining.html#sregs">sregs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span>.(<span class="id"><a href="compcert.backend.RTL.html#fn_params">fn_params</a></span>)) (<span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span>.(<span class="id"><a href="compcert.backend.RTL.html#fn_entrypoint">fn_entrypoint</a></span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">VFIND</span>: <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct">Genv.find_funct</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.ge">ge</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#vf">vf</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.common.AST.html#Internal">Internal</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">VINJ</span>: <span class="id"><a href="compcert.lib.Coqlib.html#list_forall2">list_forall2</a></span> (<span class="id"><a href="compcert.backend.Inliningproof.html#val_reg_charact">val_reg_charact</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id">ctx</span>' <span class="id">rs</span>') <span class="id"><a href="compcert.backend.Inliningproof.html#vargs">vargs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rargs">rargs</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MINJ</span>: <span class="id"><a href="compcert.common.Memory.html#Mem.inject">Mem.inject</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">VB</span>: <span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="id">m</span>' <span class="id">sp</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">PRIV</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#range_private">range_private</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id">sp</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span>) <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SSZ1</span>: 0 &lt;= <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>) &lt; <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SSZ2</span>: <span class="kwd">forall</span> <span class="id">ofs</span>, <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m</span>' <span class="id">sp</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Max">Max</a></span> <span class="id"><a href="compcert.common.Memtype.html#Nonempty">Nonempty</a></span> -&gt; 0 &lt;= <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> &lt;= <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_states">match_states</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Callstate">Callstate</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#vf">vf</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#vargs">vargs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.RTL.html#State">State</a></span> <span class="id">stk</span>' <span class="id">f</span>' (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id">pc</span>' <span class="id">rs</span>' <span class="id">m</span>')<br/>
&nbsp;&nbsp;| <span class="id"><a name="match_return_states">match_return_states</a></span>: <span class="kwd">forall</span> <span class="id">stk</span> <span class="id">v</span> <span class="id">m</span> <span class="id">stk</span>' <span class="id">v</span>' <span class="id">m</span>' <span class="id">F</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MS</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">m</span>'))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">VINJ</span>: <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#v">v</a></span> <span class="id">v</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MINJ</span>: <span class="id"><a href="compcert.common.Memory.html#Mem.inject">Mem.inject</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>'),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_states">match_states</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Returnstate">Returnstate</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#v">v</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.RTL.html#Returnstate">Returnstate</a></span> <span class="id">stk</span>' <span class="id">v</span>' <span class="id">m</span>')<br/>
&nbsp;&nbsp;| <span class="id"><a name="match_return_regular_states">match_return_regular_states</a></span>: <span class="kwd">forall</span> <span class="id">stk</span> <span class="id">v</span> <span class="id">m</span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id">sp</span>' <span class="id">rs</span>' <span class="id">m</span>' <span class="id">F</span> <span class="id">ctx</span> <span class="id">pc</span>' <span class="id">or</span> <span class="id">rinfo</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MS</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">sp</span>' <span class="id">rs</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">RET</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#retinfo">retinfo</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rinfo">rinfo</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">AT</span>: <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_code">fn_code</a></span>)!<span class="id">pc</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.Inlining.html#inline_return">inline_return</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#or">or</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rinfo">rinfo</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">VINJ</span>: <span class="kwd">match</span> <span class="id"><a href="compcert.backend.Inliningproof.html#or">or</a></span> <span class="kwd">with</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="compcert.backend.Inliningproof.html#v">v</a></span> = <span class="id"><a href="compcert.common.Values.html#Vundef">Vundef</a></span> | <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span> =&gt; <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#v">v</a></span> <span class="id">rs</span>'#(<span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">r</span>) <span class="kwd">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MINJ</span>: <span class="id"><a href="compcert.common.Memory.html#Mem.inject">Mem.inject</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">VB</span>: <span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="id">m</span>' <span class="id">sp</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">PRIV</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#range_private">range_private</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id">sp</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span>) <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SSZ1</span>: 0 &lt;= <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>) &lt; <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SSZ2</span>: <span class="kwd">forall</span> <span class="id">ofs</span>, <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m</span>' <span class="id">sp</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Max">Max</a></span> <span class="id"><a href="compcert.common.Memtype.html#Nonempty">Nonempty</a></span> -&gt; 0 &lt;= <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> &lt;= <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_states">match_states</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Returnstate">Returnstate</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#v">v</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.RTL.html#State">State</a></span> <span class="id">stk</span>' <span class="id">f</span>' (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id">pc</span>' <span class="id">rs</span>' <span class="id">m</span>').<br/>
<br/>
<h2> Forward simulation </h2>
<br/>
<span class="kwd">Definition</span> <span class="kwd">measure</span> (<span class="id">S</span>: <span class="id"><a href="compcert.backend.RTL.html#state">RTL.state</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.backend.Inliningproof.html#S">S</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.RTL.html#State">State</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; 1%<span class="id">nat</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.RTL.html#Callstate">Callstate</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; 0%<span class="id">nat</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.RTL.html#Returnstate">Returnstate</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; 0%<span class="id">nat</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="tr_funbody_inv">tr_funbody_inv</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fenv</span> <span class="id">sz</span> <span class="id">cts</span> <span class="id">f</span> <span class="id">c</span> <span class="id">pc</span> <span class="id">i</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#tr_funbody">tr_funbody</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#fenv">fenv</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sz">sz</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#cts">cts</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#c">c</a></span> -&gt; <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span>.(<span class="id"><a href="compcert.backend.RTL.html#fn_code">fn_code</a></span>)!<span class="id"><a href="compcert.backend.Inliningproof.html#pc">pc</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#i">i</a></span> -&gt; <span class="id"><a href="compcert.backend.Inliningspec.html#tr_instr">tr_instr</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#fenv">fenv</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sz">sz</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#cts">cts</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#pc">pc</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#i">i</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#c">c</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3211')">Proof.</div>
<div class="proofscript" id="proof3211">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="step_simulation">step_simulation</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">S1</span> <span class="id">t</span> <span class="id">S2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTL.html#step">step</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.ge">ge</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#S1">S1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#t">t</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#S2">S2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">S1</span>' (<span class="id">MS</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#match_states">match_states</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#S1">S1</a></span> <span class="id">S1</span>'),<br/>
&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">S2</span>', <span class="id"><a href="compcert.common.Smallstep.html#plus">plus</a></span> <span class="id"><a href="compcert.backend.RTL.html#step">step</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.tge">tge</a></span> <span class="id">S1</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#t">t</a></span> <span class="id">S2</span>' /\ <span class="id"><a href="compcert.backend.Inliningproof.html#match_states">match_states</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#S2">S2</a></span> <span class="id">S2</span>')<br/>
&nbsp;&nbsp;\/ (<span class="kwd">measure</span> <span class="id"><a href="compcert.backend.Inliningproof.html#S2">S2</a></span> &lt; <span class="kwd">measure</span> <span class="id"><a href="compcert.backend.Inliningproof.html#S1">S1</a></span> /\ <span class="id"><a href="compcert.backend.Inliningproof.html#t">t</a></span> = <span class="id"><a href="compcert.common.Events.html#E0">E0</a></span> /\ <span class="id"><a href="compcert.backend.Inliningproof.html#match_states">match_states</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#S2">S2</a></span> <span class="id">S1</span>')%<span class="id">nat</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3212')">Proof.</div>
<div class="proofscript" id="proof3212">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span>; <span class="id">inv</span> <span class="id">MS</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;nop&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#tr_funbody_inv">tr_funbody_inv</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">TR</span>; <span class="id">inv</span> <span class="id">TR</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.RTL.html#exec_Inop">exec_Inop</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;op&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#tr_funbody_inv">tr_funbody_inv</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">TR</span>; <span class="id">inv</span> <span class="id">TR</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.x86.Op.html#eval_operation_inject">eval_operation_inject</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_globalenvs">match_stacks_inside_globalenvs</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexact</span> <span class="id">SP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (2 := <span class="id">rs</span>##<span class="id">args</span>). <span class="id">instantiate</span> (1 := <span class="id">rs</span>'##(<span class="id"><a href="compcert.backend.Inlining.html#sregs">sregs</a></span> <span class="id">ctx</span> <span class="id">args</span>)). <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_val_regs">agree_val_regs</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexact</span> <span class="id">MINJ</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">fold</span> (<span class="id"><a href="compcert.backend.Inlining.html#sop">sop</a></span> <span class="id">ctx</span> <span class="id">op</span>). <span class="tactic">intros</span> [<span class="id">v</span>' [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.RTL.html#exec_Iop">exec_Iop</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_set_reg">match_stacks_inside_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_set_reg">agree_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;load&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#tr_funbody_inv">tr_funbody_inv</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">TR</span>; <span class="id">inv</span> <span class="id">TR</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.x86.Op.html#eval_addressing_inject">eval_addressing_inject</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_globalenvs">match_stacks_inside_globalenvs</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexact</span> <span class="id">SP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (2 := <span class="id">rs</span>##<span class="id">args</span>). <span class="id">instantiate</span> (1 := <span class="id">rs</span>'##(<span class="id"><a href="compcert.backend.Inlining.html#sregs">sregs</a></span> <span class="id">ctx</span> <span class="id">args</span>)). <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_val_regs">agree_val_regs</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">fold</span> (<span class="id"><a href="compcert.backend.Inlining.html#saddr">saddr</a></span> <span class="id">ctx</span> <span class="id">addr</span>). <span class="tactic">intros</span> [<span class="id">a</span>' [<span class="id">P</span> <span class="id">Q</span>]].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.loadv_inject">Mem.loadv_inject</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">v</span>' [<span class="id">U</span> <span class="id">V</span>]].<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.RTL.html#exec_Iload">exec_Iload</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_set_reg">match_stacks_inside_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_set_reg">agree_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;store&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#tr_funbody_inv">tr_funbody_inv</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">TR</span>; <span class="id">inv</span> <span class="id">TR</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.x86.Op.html#eval_addressing_inject">eval_addressing_inject</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_globalenvs">match_stacks_inside_globalenvs</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexact</span> <span class="id">SP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (2 := <span class="id">rs</span>##<span class="id">args</span>). <span class="id">instantiate</span> (1 := <span class="id">rs</span>'##(<span class="id"><a href="compcert.backend.Inlining.html#sregs">sregs</a></span> <span class="id">ctx</span> <span class="id">args</span>)). <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_val_regs">agree_val_regs</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">fold</span> <span class="id"><a href="compcert.backend.Inlining.html#saddr">saddr</a></span>. <span class="tactic">intros</span> [<span class="id">a</span>' [<span class="id">P</span> <span class="id">Q</span>]].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.storev_mapped_inject">Mem.storev_mapped_inject</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_val_reg">agree_val_reg</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">m1</span>' [<span class="id">U</span> <span class="id">V</span>]].<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.RTL.html#exec_Istore">exec_Istore</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span>'; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">U</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_store">match_stacks_inside_store</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.store_valid_block_1">Mem.store_valid_block_1</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#range_private_invariant">range_private_invariant</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_store_2">Mem.perm_store_2</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_store_1">Mem.perm_store_1</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id">SSZ2</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_store_2">Mem.perm_store_2</a></span>; <span class="tactic">eauto</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;call&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_globalenvs">match_stacks_inside_globalenvs</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">SEINJ</span>.<br/>
&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id"><a href="compcert.backend.Inliningproof.html#functions_translated">functions_translated</a></span> <span class="kwd">with</span> (<span class="id">v</span> := <span class="id">vf</span>) <span class="kwd">as</span> (<span class="id">cu</span> &amp; <span class="id">fd</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#ros_address_agree">ros_address_agree</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#tr_funbody_inv">tr_funbody_inv</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">TR</span>; <span class="id">inv</span> <span class="id">TR</span>.<br/>
+ <span class="comment">(*&nbsp;not&nbsp;inlined&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.RTL.html#exec_Icall">exec_Icall</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#sig_function_translated">sig_function_translated</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_cons">match_stacks_cons</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#ros_address_agree">ros_address_agree</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_val_regs">agree_val_regs</a></span>; <span class="tactic">eauto</span>.<br/>
+ <span class="comment">(*&nbsp;inlined&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">EQ</span>: <span class="id">fd</span> = <span class="id"><a href="compcert.common.AST.html#Internal">Internal</a></span> <span class="id">f0</span>) <span class="tactic">by</span> (<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#ros_address_inlined">ros_address_inlined</a></span> <span class="kwd">with</span> (<span class="id">rs</span>:=<span class="id">rs</span>); <span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">fd</span>.<br/>
&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">split</span>. <span class="tactic">simpl</span>; <span class="tactic">omega</span>. <span class="tactic">split</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_inlined">match_stacks_inside_inlined</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">PRIV</span>. <span class="id">inv</span> <span class="id">H13</span>. <span class="tactic">destruct</span> <span class="id">H16</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_val_regs_gen">agree_val_regs_gen</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id">PRIV</span>. <span class="tactic">destruct</span> <span class="id">H16</span>. <span class="tactic">omega</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;tailcall&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_globalenvs">match_stacks_inside_globalenvs</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">SEINJ</span>.<br/>
&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id"><a href="compcert.backend.Inliningproof.html#functions_translated">functions_translated</a></span> <span class="kwd">with</span> (<span class="id">v</span> := <span class="id">vf</span>) <span class="kwd">as</span> (<span class="id">cu</span> &amp; <span class="id">fd</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#ros_address_agree">ros_address_agree</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">PRIV</span>': <span class="id"><a href="compcert.backend.Inliningproof.html#range_private">range_private</a></span> <span class="id">F</span> <span class="id">m</span>' <span class="id">m</span>'0 <span class="id">sp</span>' (<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span> <span class="id">ctx</span>) <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>)).<br/>
&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#range_private_free_left">range_private_free_left</a></span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">FB</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H4</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#tr_funbody_inv">tr_funbody_inv</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">TR</span>; <span class="id">inv</span> <span class="id">TR</span>.<br/>
+ <span class="comment">(*&nbsp;within&nbsp;the&nbsp;original&nbsp;function&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MS0</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">X</span>: { <span class="id">m1</span>' | <span class="id"><a href="compcert.common.Memory.html#Mem.free">Mem.free</a></span> <span class="id">m</span>'0 <span class="id">sp</span>' 0 (<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span> <span class="id">f</span>') = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m1</span>'}).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.range_perm_free">Mem.range_perm_free</a></span>. <span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id">ofs</span> <span class="id">f</span>.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> <span class="id">ofs</span> <span class="kwd">with</span> (<span class="id">ofs</span> + <span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span> <span class="id">ctx</span>) <span class="tactic">by</span> <span class="tactic">omega</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_inject">Mem.perm_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.free_range_perm">Mem.free_range_perm</a></span>; <span class="tactic">eauto</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">FB</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#range_private_perms">range_private_perms</a></span>; <span class="tactic">eauto</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">X</span> <span class="kwd">as</span> [<span class="id">m1</span>' <span class="id">FREE</span>].<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.RTL.html#exec_Itailcall">exec_Itailcall</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#sig_function_translated">sig_function_translated</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_bound">match_stacks_bound</a></span> <span class="kwd">with</span> (<span class="id">bound</span> := <span class="id">sp</span>').<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_invariant">match_stacks_invariant</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock_free">Mem.nextblock_free</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H2</span>). <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock_free">Mem.nextblock_free</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">FREE</span>). <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_free_3">Mem.perm_free_3</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_free_1">Mem.perm_free_1</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_free_3">Mem.perm_free_3</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="compcert.common.Memory.html#Mem.nextblock_free">Mem.nextblock_free</a></span>; <span class="tactic">eauto</span>. <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">VB</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#ros_address_agree">ros_address_agree</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_val_regs">agree_val_regs</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.free_right_inject">Mem.free_right_inject</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.free_left_inject">Mem.free_left_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;show&nbsp;that&nbsp;no&nbsp;valid&nbsp;location&nbsp;points&nbsp;into&nbsp;the&nbsp;stack&nbsp;block&nbsp;being&nbsp;freed&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id">DSTK</span> <span class="kwd">in</span> <span class="id">PRIV</span>'. <span class="id">exploit</span> (<span class="id">PRIV</span>' (<span class="id">ofs</span> + <span class="id">delta</span>)). <span class="tactic">omega</span>. <span class="tactic">intros</span> [<span class="id">P</span> <span class="id">Q</span>].<br/>
&nbsp;&nbsp;<span class="id">eelim</span> <span class="id">Q</span>; <span class="tactic">eauto</span>. <span class="tactic">replace</span> (<span class="id">ofs</span> + <span class="id">delta</span> - <span class="id">delta</span>) <span class="kwd">with</span> <span class="id">ofs</span> <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_max">Mem.perm_max</a></span> <span class="kwd">with</span> <span class="id">k</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_implies">Mem.perm_implies</a></span> <span class="kwd">with</span> <span class="id">p</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
+ <span class="comment">(*&nbsp;turned&nbsp;into&nbsp;a&nbsp;call&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.RTL.html#exec_Icall">exec_Icall</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#sig_function_translated">sig_function_translated</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_untailcall">match_stacks_untailcall</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_invariant">match_stacks_inside_invariant</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock_free">Mem.nextblock_free</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H2</span>). <span class="id">xomega</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_free_3">Mem.perm_free_3</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#ros_address_agree">ros_address_agree</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_val_regs">agree_val_regs</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.free_left_inject">Mem.free_left_inject</a></span>; <span class="tactic">eauto</span>.<br/>
+ <span class="comment">(*&nbsp;inlined&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">EQ</span>: <span class="id">fd</span> = <span class="id"><a href="compcert.common.AST.html#Internal">Internal</a></span> <span class="id">f0</span>) <span class="tactic">by</span> (<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#ros_address_inlined">ros_address_inlined</a></span> <span class="kwd">with</span> (<span class="id">rs</span>:=<span class="id">rs</span>); <span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">fd</span>.<br/>
&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">split</span>. <span class="tactic">simpl</span>; <span class="tactic">omega</span>. <span class="tactic">split</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_inlined_tailcall">match_stacks_inside_inlined_tailcall</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_invariant">match_stacks_inside_invariant</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock_free">Mem.nextblock_free</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H2</span>). <span class="id">xomega</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_free_3">Mem.perm_free_3</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_val_regs_gen">agree_val_regs_gen</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.free_left_inject">Mem.free_left_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id">PRIV</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span> <span class="id">ctx</span> &lt;= <span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span> <span class="id">ctx</span>'). <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">H14</span>; <span class="tactic">rewrite</span> <span class="id">H14</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#align_le">align_le</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#min_alignment_pos">min_alignment_pos</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;builtin&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#tr_funbody_inv">tr_funbody_inv</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">TR</span>; <span class="id">inv</span> <span class="id">TR</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_globalenvs">match_stacks_inside_globalenvs</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">SEINJ</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#tr_builtin_args">tr_builtin_args</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">vargs</span>' &amp; <span class="id">P</span> &amp; <span class="id">Q</span>).<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Events.html#external_call_mem_inject">external_call_mem_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">F1</span> [<span class="id">v1</span> [<span class="id">m1</span>' [<span class="id">A</span> [<span class="id">B</span> [<span class="id">C</span> [<span class="id">D</span> [<span class="id">E</span> [<span class="id">J</span> <span class="id">K</span>]]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.RTL.html#exec_Ibuiltin">exec_Ibuiltin</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_set_res">match_stacks_inside_set_res</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_extcall">match_stacks_inside_extcall</a></span> <span class="kwd">with</span> (<span class="id">F1</span> := <span class="id">F</span>) (<span class="id">F2</span> := <span class="id">F1</span>) (<span class="id">m1</span> := <span class="id">m</span>) (<span class="id">m1</span>' := <span class="id">m</span>'0); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Events.html#external_call_max_perm">external_call_max_perm</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Events.html#external_call_max_perm">external_call_max_perm</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Events.html#external_call_nextblock">external_call_nextblock</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">res</span>; <span class="tactic">simpl</span>; [<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_set_reg">agree_set_reg</a></span>;<span class="tactic">auto</span>|<span class="id">idtac</span>|<span class="id">idtac</span>]; <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs_incr">agree_regs_incr</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Events.html#external_call_valid_block">external_call_valid_block</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#range_private_extcall">range_private_extcall</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Events.html#external_call_max_perm">external_call_max_perm</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">SSZ2</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Events.html#external_call_max_perm">external_call_max_perm</a></span>; <span class="tactic">eauto</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;cond&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#tr_funbody_inv">tr_funbody_inv</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">TR</span>; <span class="id">inv</span> <span class="id">TR</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="compcert.x86.Op.html#eval_condition">eval_condition</a></span> <span class="id">cond</span> <span class="id">rs</span>'##(<span class="id"><a href="compcert.backend.Inlining.html#sregs">sregs</a></span> <span class="id">ctx</span> <span class="id">args</span>) <span class="id">m</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.Op.html#eval_condition_inject">eval_condition_inject</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_val_regs">agree_val_regs</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.RTL.html#exec_Icond">exec_Icond</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">b</span>; <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;jumptable&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#tr_funbody_inv">tr_funbody_inv</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">TR</span>; <span class="id">inv</span> <span class="id">TR</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id">F</span> <span class="id">rs</span>#<span class="id">arg</span> <span class="id">rs</span>'#(<span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span> <span class="id">ctx</span> <span class="id">arg</span>)). <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_val_reg">agree_val_reg</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="id">inv</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.RTL.html#exec_Ijumptable">exec_Ijumptable</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#list_nth_z_map">list_nth_z_map</a></span>. <span class="tactic">rewrite</span> <span class="id">H1</span>. <span class="tactic">simpl</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;return&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#tr_funbody_inv">tr_funbody_inv</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">TR</span>; <span class="id">inv</span> <span class="id">TR</span>.<br/>
+ <span class="comment">(*&nbsp;not&nbsp;inlined&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MS0</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">X</span>: { <span class="id">m1</span>' | <span class="id"><a href="compcert.common.Memory.html#Mem.free">Mem.free</a></span> <span class="id">m</span>'0 <span class="id">sp</span>' 0 (<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span> <span class="id">f</span>') = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m1</span>'}).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.range_perm_free">Mem.range_perm_free</a></span>. <span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id">ofs</span> <span class="id">f</span>.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> <span class="id">ofs</span> <span class="kwd">with</span> (<span class="id">ofs</span> + <span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span> <span class="id">ctx</span>) <span class="tactic">by</span> <span class="tactic">omega</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_inject">Mem.perm_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.free_range_perm">Mem.free_range_perm</a></span>; <span class="tactic">eauto</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">FB</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#range_private_perms">range_private_perms</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.lib.Coqlib.html#Zmax_spec">Zmax_spec</a></span> (<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span> <span class="id">f</span>) 0). <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> 0 (<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span> <span class="id">f</span>)); <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">X</span> <span class="kwd">as</span> [<span class="id">m1</span>' <span class="id">FREE</span>].<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.RTL.html#exec_Ireturn">exec_Ireturn</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_bound">match_stacks_bound</a></span> <span class="kwd">with</span> (<span class="id">bound</span> := <span class="id">sp</span>').<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_invariant">match_stacks_invariant</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock_free">Mem.nextblock_free</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>). <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock_free">Mem.nextblock_free</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">FREE</span>). <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_free_3">Mem.perm_free_3</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_free_1">Mem.perm_free_1</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_free_3">Mem.perm_free_3</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="compcert.common.Memory.html#Mem.nextblock_free">Mem.nextblock_free</a></span>; <span class="tactic">eauto</span>. <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">VB</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">or</span>; <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_val_reg">agree_val_reg</a></span>; <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.free_right_inject">Mem.free_right_inject</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.free_left_inject">Mem.free_left_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;show&nbsp;that&nbsp;no&nbsp;valid&nbsp;location&nbsp;points&nbsp;into&nbsp;the&nbsp;stack&nbsp;block&nbsp;being&nbsp;freed&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">inversion</span> <span class="id">FB</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">PRIV</span>': <span class="id"><a href="compcert.backend.Inliningproof.html#range_private">range_private</a></span> <span class="id">F</span> <span class="id">m</span>' <span class="id">m</span>'0 <span class="id">sp</span>' (<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span> <span class="id">ctx</span>) <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H8</span> <span class="kwd">in</span> <span class="id">PRIV</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#range_private_free_left">range_private_free_left</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">DSTK</span> <span class="kwd">in</span> <span class="id">PRIV</span>'. <span class="id">exploit</span> (<span class="id">PRIV</span>' (<span class="id">ofs</span> + <span class="id">delta</span>)). <span class="tactic">omega</span>. <span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>].<br/>
&nbsp;&nbsp;<span class="id">eelim</span> <span class="id">B</span>; <span class="tactic">eauto</span>. <span class="tactic">replace</span> (<span class="id">ofs</span> + <span class="id">delta</span> - <span class="id">delta</span>) <span class="kwd">with</span> <span class="id">ofs</span> <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_max">Mem.perm_max</a></span> <span class="kwd">with</span> <span class="id">k</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_implies">Mem.perm_implies</a></span> <span class="kwd">with</span> <span class="id">p</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
<br/>
+ <span class="comment">(*&nbsp;inlined&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">right</span>. <span class="tactic">split</span>. <span class="tactic">simpl</span>. <span class="tactic">omega</span>. <span class="tactic">split</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_invariant">match_stacks_inside_invariant</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock_free">Mem.nextblock_free</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>). <span class="id">xomega</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_free_3">Mem.perm_free_3</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">or</span>; <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_val_reg">agree_val_reg</a></span>; <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.free_left_inject">Mem.free_left_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">FB</span>. <span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">PRIV</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#range_private_free_left">range_private_free_left</a></span>; <span class="tactic">eauto</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;internal&nbsp;function,&nbsp;not&nbsp;inlined&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id"><a href="compcert.backend.Inliningproof.html#functions_translated">functions_translated</a></span> <span class="kwd">as</span> (<span class="id">cu</span> &amp; <span class="id">fd</span>' &amp; <span class="id">Hfd</span>' &amp; <span class="id">FD</span> &amp; <span class="id">Hcu</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_globalenvs">match_stacks_globalenvs</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">A</span>: <span class="id">exists</span> <span class="id">f</span>', <span class="id"><a href="compcert.backend.Inliningspec.html#tr_function">tr_function</a></span> <span class="id">cu</span> <span class="id">f</span> <span class="id">f</span>' /\ <span class="id">fd</span>' = <span class="id"><a href="compcert.common.AST.html#Internal">Internal</a></span> <span class="id">f</span>').<br/>
&nbsp;&nbsp;{ <span class="id">Errors.monadInv</span> <span class="id">FD</span>. <span class="id">exists</span> <span class="id">x</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#transf_function_spec">transf_function_spec</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">A</span> <span class="kwd">as</span> [<span class="id">f</span>' [<span class="id">TR1</span> <span class="id">EQ</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">TR</span>: <span class="id"><a href="compcert.backend.Inliningspec.html#tr_function">tr_function</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.prog">prog</a></span> <span class="id">f</span> <span class="id">f</span>').<br/>
&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#tr_function_linkorder">tr_function_linkorder</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">TR</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.alloc_parallel_inject">Mem.alloc_parallel_inject</a></span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_refl">Z.le_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span> <span class="id">f</span>'). <span class="id">inv</span> <span class="id">H1</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">F</span>' [<span class="id">m1</span>' [<span class="id">sp</span>' [<span class="id">A</span> [<span class="id">B</span> [<span class="id">C</span> [<span class="id">D</span> <span class="id">E</span>]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.RTL.html#exec_function_internal">exec_function_internal</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H6</span>. <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id">F</span>'). <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_base">match_stacks_inside_base</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">SP</span>: <span class="id">sp</span>' = <span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">m</span>'0) <span class="tactic">by</span> (<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.alloc_result">Mem.alloc_result</a></span>; <span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">SP</span> <span class="kwd">in</span> <span class="id">MS0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_invariant">match_stacks_invariant</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Values.html#eq_block">eq_block</a></span> <span class="id">b1</span> <span class="id">stk</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">b1</span>. <span class="tactic">rewrite</span> <span class="id">D</span> <span class="kwd">in</span> <span class="id">H8</span>; <span class="id">inv</span> <span class="id">H8</span>. <span class="id">eelim</span> <span class="id"><a href="compcert.lib.Coqlib.html#Plt_strict">Plt_strict</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">E</span> <span class="kwd">in</span> <span class="id">H8</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock_alloc">Mem.nextblock_alloc</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>). <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock_alloc">Mem.nextblock_alloc</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">A</span>). <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_alloc_inv">Mem.perm_alloc_inv</a></span>. <span class="id">eexact</span> <span class="id">H</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Values.html#eq_block">eq_block</a></span> <span class="id">b1</span> <span class="id">stk</span>); <span class="tactic">intros</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">b1</span>. <span class="tactic">rewrite</span> <span class="id">D</span> <span class="kwd">in</span> <span class="id">H8</span>; <span class="id">inv</span> <span class="id">H8</span>. <span class="id">eelim</span> <span class="id"><a href="compcert.lib.Coqlib.html#Plt_strict">Plt_strict</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_alloc_1">Mem.perm_alloc_1</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_alloc_inv">Mem.perm_alloc_inv</a></span>. <span class="id">eexact</span> <span class="id">A</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#dec_eq_false">dec_eq_false</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H5</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs_init_regs">agree_regs_init_regs</a></span>. <span class="tactic">eauto</span>. <span class="tactic">auto</span>. <span class="id">inv</span> <span class="id">H1</span>; <span class="tactic">auto</span>. <span class="tactic">congruence</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.valid_new_block">Mem.valid_new_block</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_alloc_2">Mem.perm_alloc_2</a></span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">H1</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_alloc_inv">Mem.perm_alloc_inv</a></span>. <span class="id">eexact</span> <span class="id">H</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Values.html#eq_block">eq_block</a></span> <span class="id">b</span> <span class="id">stk</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="tactic">rewrite</span> <span class="id">D</span> <span class="kwd">in</span> <span class="id">H9</span>; <span class="id">inv</span> <span class="id">H9</span>. <span class="id">inv</span> <span class="id">H1</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">E</span> <span class="kwd">in</span> <span class="id">H9</span>; <span class="tactic">auto</span>. <span class="id">eelim</span> <span class="id"><a href="compcert.common.Memory.html#Mem.fresh_block_alloc">Mem.fresh_block_alloc</a></span>. <span class="id">eexact</span> <span class="id">A</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.mi_mappedblocks">Mem.mi_mappedblocks</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_alloc_inv">Mem.perm_alloc_inv</a></span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#dec_eq_true">dec_eq_true</a></span>. <span class="tactic">omega</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;internal&nbsp;function,&nbsp;inlined&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">VFIND</span> <span class="kwd">in</span> <span class="id">FIND</span>. <span class="id">inv</span> <span class="id">FIND</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">FB</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.alloc_left_mapped_inject">Mem.alloc_left_mapped_inject</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;sp'&nbsp;is&nbsp;valid&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id">sp</span>'). <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;offset&nbsp;is&nbsp;representable&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span> <span class="id">ctx</span>). <span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_max_r">Z.le_max_r</a></span> (<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span> <span class="id">f</span>) 0). <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;size&nbsp;of&nbsp;target&nbsp;block&nbsp;is&nbsp;representable&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">right</span>. <span class="id">exploit</span> <span class="id">SSZ2</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>. <span class="id">inv</span> <span class="id">FB</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;we&nbsp;have&nbsp;full&nbsp;permissions&nbsp;on&nbsp;sp'&nbsp;at&nbsp;and&nbsp;above&nbsp;dstk&nbsp;ctx&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_cur">Mem.perm_cur</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_implies">Mem.perm_implies</a></span> <span class="kwd">with</span> <span class="id"><a href="compcert.common.Memtype.html#Freeable">Freeable</a></span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#range_private_perms">range_private_perms</a></span>; <span class="tactic">eauto</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;offset&nbsp;is&nbsp;aligned&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span> <span class="id">f</span> - 0) <span class="kwd">with</span> (<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span> <span class="id">f</span>) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">FB</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#min_alignment_sound">min_alignment_sound</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;nobody&nbsp;maps&nbsp;to&nbsp;(sp,&nbsp;dstk&nbsp;ctx...)&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> (<span class="id">PRIV</span> (<span class="id">ofs</span> + <span class="id">delta</span>')); <span class="tactic">eauto</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>]. <span class="id">eelim</span> <span class="id">B</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">ofs</span> + <span class="id">delta</span>' - <span class="id">delta</span>') <span class="kwd">with</span> <span class="id">ofs</span> <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_max">Mem.perm_max</a></span> <span class="kwd">with</span> <span class="id">k</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_implies">Mem.perm_implies</a></span> <span class="kwd">with</span> <span class="id">p</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">F</span>' [<span class="id">A</span> [<span class="id">B</span> [<span class="id">C</span> <span class="id">D</span>]]]].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#tr_moves_init_regs">tr_moves_init_regs</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">rs</span>'' [<span class="id">P</span> [<span class="id">Q</span> <span class="id">R</span>]]].<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_left">plus_left</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.RTL.html#exec_Inop">exec_Inop</a></span>; <span class="tactic">eauto</span>. <span class="id">eexact</span> <span class="id">P</span>. <span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_alloc_left">match_stacks_inside_alloc_left</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_invariant">match_stacks_inside_invariant</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">xomega</span>. <span class="id">xomega</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs_incr">agree_regs_incr</a></span> <span class="kwd">with</span> <span class="id">F</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#range_private_alloc_left">range_private_alloc_left</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;external&nbsp;function&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_globalenvs">match_stacks_globalenvs</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">SEINJ</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Events.html#external_call_mem_inject">external_call_mem_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">F1</span> [<span class="id">v1</span> [<span class="id">m1</span>' [<span class="id">A</span> [<span class="id">B</span> [<span class="id">C</span> [<span class="id">D</span> [<span class="id">E</span> [<span class="id">J</span> <span class="id">K</span>]]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id"><a href="compcert.backend.Inliningproof.html#functions_translated">functions_translated</a></span> <span class="kwd">as</span> (<span class="id">cu</span> &amp; <span class="id">fd</span>' &amp; <span class="id">Hfd</span>' &amp; <span class="id">FD</span> &amp; <span class="id">Hcu</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">FD</span>. <span class="id">inv</span> <span class="id">FD</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.RTL.html#exec_function_external">exec_function_external</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_bound">match_stacks_bound</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">m</span>'0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_extcall">match_stacks_extcall</a></span> <span class="kwd">with</span> (<span class="id">F1</span> := <span class="id">F</span>) (<span class="id">F2</span> := <span class="id">F1</span>) (<span class="id">m1</span> := <span class="id">m</span>) (<span class="id">m1</span>' := <span class="id">m</span>'0); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Events.html#external_call_max_perm">external_call_max_perm</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Events.html#external_call_max_perm">external_call_max_perm</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Events.html#external_call_nextblock">external_call_nextblock</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Events.html#external_call_nextblock">external_call_nextblock</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;return&nbsp;fron&nbsp;noninlined&nbsp;function&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MS0</span>.<br/>
+ <span class="comment">(*&nbsp;normal&nbsp;case&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.RTL.html#exec_return">exec_return</a></span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_set_reg">match_stacks_inside_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_set_reg">agree_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
+ <span class="comment">(*&nbsp;untailcall&nbsp;case&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MS</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">RET</span> <span class="kwd">in</span> <span class="id">RET0</span>; <span class="id">inv</span> <span class="id">RET0</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.RTL.html#exec_return">exec_return</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_regular_states">match_regular_states</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_set_reg">match_stacks_inside_set_reg</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_set_reg">agree_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id">ofs</span> (<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span> <span class="id">ctx</span>)). <span class="tactic">apply</span> <span class="id">PAD</span>; <span class="tactic">omega</span>. <span class="tactic">apply</span> <span class="id">PRIV</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;return&nbsp;from&nbsp;inlined&nbsp;function&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MS0</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>. <span class="tactic">rewrite</span> <span class="id">RET0</span> <span class="kwd">in</span> <span class="id">RET</span>; <span class="id">inv</span> <span class="id">RET</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Inlining.html#inline_return">inline_return</a></span> <span class="kwd">in</span> <span class="id">AT</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">PRIV</span>': <span class="id"><a href="compcert.backend.Inliningproof.html#range_private">range_private</a></span> <span class="id">F</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">sp</span>' (<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span> <span class="id">ctx</span>' + <span class="id"><a href="compcert.backend.Inlining.html#mstk">mstk</a></span> <span class="id">ctx</span>') <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id">ofs</span> (<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span> <span class="id">ctx</span>)). <span class="tactic">apply</span> <span class="id">PAD</span>. <span class="tactic">omega</span>. <span class="tactic">apply</span> <span class="id">PRIV</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">or</span>.<br/>
+ <span class="comment">(*&nbsp;with&nbsp;a&nbsp;result&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.RTL.html#exec_Iop">exec_Iop</a></span>; <span class="tactic">eauto</span>. <span class="tactic">simpl</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_set_reg">match_stacks_inside_set_reg</a></span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_set_reg">agree_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
+ <span class="comment">(*&nbsp;without&nbsp;a&nbsp;result&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.RTL.html#exec_Inop">exec_Inop</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">subst</span> <span class="id">vres</span>. <span class="tactic">apply</span> <span class="id">agree_set_reg_undef</span>'; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="transf_initial_states">transf_initial_states</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">q1</span> <span class="id">q2</span>, <span class="id"><a href="compcert.common.LanguageInterface.html#cc_inj_senv">cc_inj_senv</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.w">w</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.se">se</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.tse">tse</a></span> -&gt; <span class="id"><a href="compcert.common.LanguageInterface.html#cc_inj_query">cc_inj_query</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.w">w</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#q1">q1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#q2">q2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">S</span>, <span class="id"><a href="compcert.backend.RTL.html#initial_state">initial_state</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.ge">ge</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#q1">q1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#S">S</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">R</span>, <span class="id"><a href="compcert.backend.RTL.html#initial_state">initial_state</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.tge">tge</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#q2">q2</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#R">R</a></span> /\ <span class="id"><a href="compcert.backend.Inliningproof.html#match_states">match_states</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#S">S</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#R">R</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3213')">Proof.</div>
<div class="proofscript" id="proof3213">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H1</span>. <span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="compcert.common.Globalenvs.html#Genv.match_stbls">Genv.match_stbls</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.w">w</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.se">se</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.tse">tse</a></span>) <span class="tactic">by</span> (<span class="id">inv</span> <span class="id">H</span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#functions_translated">functions_translated</a></span> <span class="kwd">in</span> <span class="id">H2</span> <span class="kwd">as</span> (<span class="id">cu</span> &amp; <span class="id">tf</span> &amp; <span class="id">FIND</span> &amp; <span class="id">TR</span> &amp; <span class="id">LINK</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">setoid_rewrite</span> &lt;- (<span class="id"><a href="compcert.backend.Inliningproof.html#sig_function_translated">sig_function_translated</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">TR</span>).<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">TR</span>. <span class="tactic">destruct</span> <span class="id"><a href="compcert.backend.Inlining.html#transf_function">transf_function</a></span> <span class="id">eqn</span>:<span class="id">Hf</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>. <span class="id">cbn</span> <span class="kwd">in</span> <span class="id">TR</span>. <span class="id">inv</span> <span class="id">TR</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="compcert.backend.RTL.html#Callstate">Callstate</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id">vf2</span> <span class="id">vargs2</span> <span class="id">m2</span>); <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_nil">match_stacks_nil</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.LanguageInterface.html#mit_incr_refl">mit_incr_refl</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.GE">GE</a></span>. <span class="id">cbn</span> <span class="kwd">in</span> *. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.GE">GE</a></span>. <span class="id">cbn</span> <span class="kwd">in</span> *. <span class="id">xomega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="transf_final_states">transf_final_states</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">S</span> <span class="id">R</span> <span class="id">r1</span>, <span class="id"><a href="compcert.backend.Inliningproof.html#match_states">match_states</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#S">S</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#R">R</a></span> -&gt; <span class="id"><a href="compcert.backend.RTL.html#final_state">final_state</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#S">S</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r1">r1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">r2</span>, <span class="id"><a href="compcert.backend.RTL.html#final_state">final_state</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#R">R</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r2">r2</a></span> /\ <span class="id"><a href="compcert.common.LanguageInterface.html#cc_inj_reply">cc_inj_reply</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.w">w</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r1">r1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r2">r2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3214')">Proof.</div>
<div class="proofscript" id="proof3214">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H0</span>. <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_empty">match_stacks_empty</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">EQ</span>; <span class="tactic">subst</span>. <span class="id">inv</span> <span class="id">MS</span>. <span class="id">inv</span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.GE">GE</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span>. <span class="tactic">split</span>; <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_empty">match_stacks_inside_empty</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>]. <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="transf_external_states">transf_external_states</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">S</span> <span class="id">R</span> <span class="id">q1</span>, <span class="id"><a href="compcert.backend.Inliningproof.html#match_states">match_states</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#S">S</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#R">R</a></span> -&gt; <span class="id"><a href="compcert.backend.RTL.html#at_external">at_external</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.ge">ge</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#S">S</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#q1">q1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">wx</span> <span class="id">q2</span>, <span class="id"><a href="compcert.backend.RTL.html#at_external">at_external</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.tge">tge</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#R">R</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#q2">q2</a></span> /\ <span class="id"><a href="compcert.common.LanguageInterface.html#cc_injp_query">cc_injp_query</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#wx">wx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#q1">q1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#q2">q2</a></span> /\ <span class="id"><a href="compcert.common.LanguageInterface.html#cc_injp_stbls">cc_injp_stbls</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#wx">wx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.se">se</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.tse">tse</a></span> /\<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r1</span> <span class="id">r2</span> <span class="id">S</span>', <span class="id"><a href="compcert.common.LanguageInterface.html#cc_injp_reply">cc_injp_reply</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#wx">wx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r1">r1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r2">r2</a></span> -&gt; <span class="id"><a href="compcert.backend.RTL.html#after_external">after_external</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#S">S</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r1">r1</a></span> <span class="id">S</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">R</span>', <span class="id"><a href="compcert.backend.RTL.html#after_external">after_external</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#R">R</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r2">r2</a></span> <span class="id">R</span>' /\ <span class="id"><a href="compcert.backend.Inliningproof.html#match_states">match_states</a></span> <span class="id">S</span>' <span class="id">R</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3215')">Proof.</div>
<div class="proofscript" id="proof3215">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">S</span> <span class="id">R</span> <span class="id">q1</span> <span class="id">HSR</span> <span class="id">Hq1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Hq1</span>; <span class="id">inv</span> <span class="id">HSR</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_globalenvs">match_stacks_globalenvs</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">SEINJ</span>.<br/>
&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id"><a href="compcert.backend.Inliningproof.html#functions_translated">functions_translated</a></span> <span class="kwd">as</span> (<span class="id">cu</span> &amp; <span class="id">fd</span>' &amp; <span class="id">Hfd</span>' &amp; <span class="id">FD</span> &amp; <span class="id">Hcu</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">FD</span>. <span class="id">inv</span> <span class="id">FD</span>.<br/>
&nbsp;&nbsp;<span class="id">eexists</span> <span class="id">_</span>, <span class="id">_</span>. <span class="tactic">intuition</span> <span class="id">idtac</span>.<br/>
&nbsp;&nbsp;- <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">FINJ</span>; <span class="id">cbn</span> <span class="kwd">in</span> *; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_globalenvs">match_stacks_globalenvs</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_nextblock">match_stacks_nextblock</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_nextblock">match_stacks_nextblock</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">H1</span>. <span class="id">inv</span> <span class="id">H0</span>. <span class="id">eexists</span>; <span class="tactic">split</span>; <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_bound">match_stacks_bound</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">m</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_extcall">match_stacks_extcall</a></span> <span class="kwd">with</span> (<span class="id">F1</span> := <span class="id">F</span>) (<span class="id">F2</span> := <span class="id">f</span>') (<span class="id">m1</span> := <span class="id">m</span>) (<span class="id">m1</span>' := <span class="id">m</span>'); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.unchanged_on_nextblock">Mem.unchanged_on_nextblock</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.unchanged_on_nextblock">Mem.unchanged_on_nextblock</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING">INLINING</a></span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="transf_program_correct">transf_program_correct</a></span> <span class="id">prog</span> <span class="id">tprog</span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_prog">match_prog</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#prog">prog</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#tprog">tprog</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Smallstep.html#forward_simulation">forward_simulation</a></span> <span class="id"><a href="compcert.common.LanguageInterface.html#cc_injp">cc_injp</a></span> <span class="id"><a href="compcert.common.LanguageInterface.html#cc_inj">cc_inj</a></span> (<span class="id"><a href="compcert.backend.RTL.html#semantics">semantics</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#prog">prog</a></span>) (<span class="id"><a href="compcert.backend.RTL.html#semantics">semantics</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#tprog">tprog</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3216')">Proof.</div>
<div class="proofscript" id="proof3216">
&nbsp;&nbsp;<span class="id">fsim</span> <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#forward_simulation_star">forward_simulation_star</a></span>.<br/>
&nbsp;&nbsp;{ <span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">Hse</span>, <span class="id">H</span>. <span class="id">cbn</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> (<span class="id"><a href="compcert.common.Globalenvs.html#Genv.is_internal_match">Genv.is_internal_match</a></span> <span class="id">MATCH</span>); <span class="tactic">eauto</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Inlining.html#transf_fundef">transf_fundef</a></span>, <span class="id"><a href="compcert.common.AST.html#transf_partial_fundef">transf_partial_fundef</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> ? [|] [|]; <span class="id">cbn</span> -[<span class="id">transf_function</span>]; <span class="tactic">inversion</span> 1; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="compcert.backend.Inlining.html#transf_function">transf_function</a></span>; <span class="id">inv</span> <span class="id">H8</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#transf_initial_states">transf_initial_states</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#transf_final_states">transf_final_states</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#transf_external_states">transf_external_states</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#step_simulation">step_simulation</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
