
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module Round</title>
<meta name="description" content="Documentation of Coq module Round" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module Round</h1>
<div class="coq">
<br/>
<h1> Helper function for computing the rounded value of a real number. </h1>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.flocq.Core.Core.html">Core</a></span> <span class="id"><a href="compcert.flocq.Core.Digits.html">Digits</a></span> <span class="id"><a href="compcert.flocq.Core.Float_prop.html">Float_prop</a></span> <span class="id"><a href="compcert.flocq.Calc.Bracket.html">Bracket</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Fcalc_round">Fcalc_round</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Fcalc_round.beta">beta</a></span> : <span class="id"><a href="compcert.flocq.Core.Zaux.html#radix">radix</a></span>.<br/>
<span class="kwd">Notation</span> <span class="id"><a name="bpow">bpow</a></span> <span class="id">e</span> := (<span class="id"><a href="compcert.flocq.Core.Raux.html#bpow">bpow</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id">e</span>).<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Fcalc_round.Fcalc_round_fexp">Fcalc_round_fexp</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<span class="kwd">Context</span> { <span class="id">valid_exp</span> : <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> }.<br/>
<span class="kwd">Notation</span> <span class="id"><a name="format">format</a></span> := (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span>).<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="cexp_inbetween_float">cexp_inbetween_float</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;(0 &lt; <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span>)%<span class="id">R</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span> &lt;= <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> \/ <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span> &lt;= <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Core.Digits.html#Zdigits">Zdigits</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> + <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span>))%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Core.Digits.html#Zdigits">Zdigits</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> + <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6071')">Proof.</div>
<div class="proofscript" id="proof6071">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> <span class="id">Px</span> <span class="id">Bx</span> <span class="id">He</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_float_bounds">inbetween_float_bounds</a></span> <span class="kwd">in</span> <span class="id">Bx</span>.<br/>
<span class="tactic">assert</span> (0 &lt;= <span class="id">m</span>)%<span class="id">Z</span> <span class="kwd">as</span> <span class="id">Hm</span>.<br/>
{ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zlt_succ_le">Zlt_succ_le</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.flocq.Core.Float_prop.html#gt_0_F2R">gt_0_F2R</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rlt_trans">Rlt_trans</a></span> <span class="kwd">with</span> (1 := <span class="id">Px</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Bx</span>. }<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zle_lt_or_eq">Zle_lt_or_eq</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hm</span>) <span class="kwd">as</span> [<span class="id">Hm</span>'|&lt;-].<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">erewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Float_prop.html#mag_F2R_bounds_Zdigits">mag_F2R_bounds_Zdigits</a></span> <span class="kwd">with</span> (1 := <span class="id">Hm</span>').<br/>
<span class="tactic">clear</span> <span class="id">Hm</span>.<br/>
<span class="tactic">assert</span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#mag">mag</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id">x</span> &lt;= <span class="id">e</span>)%<span class="id">Z</span> <span class="kwd">as</span> <span class="id">Hx</span>.<br/>
{ <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#mag_le_bpow">mag_le_bpow</a></span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos_eq">Rabs_pos_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Float_prop.html#F2R_bpow">F2R_bpow</a></span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>. }<br/>
<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">He</span> |- *.<br/>
<span class="tactic">clear</span> <span class="id">Bx</span>.<br/>
<span class="tactic">destruct</span> <span class="id">He</span> <span class="kwd">as</span> [<span class="id">He</span>|<span class="id">He</span>].<br/>
- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_sym">eq_sym</a></span>, <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.valid_exp">valid_exp</a></span> <span class="kwd">with</span> (2 := <span class="id">He</span>).<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_trans">Z.le_trans</a></span> <span class="kwd">with</span> <span class="id">e</span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.valid_exp">valid_exp</a></span> <span class="kwd">with</span> (1 := <span class="id">He</span>).<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_trans">Z.le_trans</a></span> <span class="kwd">with</span> <span class="id">e</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="cexp_inbetween_float_loc_Exact">cexp_inbetween_float_loc_Exact</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;(0 &lt;= <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span>)%<span class="id">R</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span> &lt;= <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> \/ <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> = <span class="id"><a href="compcert.flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span> &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span> &lt;= <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Core.Digits.html#Zdigits">Zdigits</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> + <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span>) \/ <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> = <span class="id"><a href="compcert.flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span>)%<span class="id">Z</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6072')">Proof.</div>
<div class="proofscript" id="proof6072">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> <span class="id">Px</span> <span class="id">Bx</span>.<br/>
<span class="tactic">destruct</span> <span class="id">Px</span> <span class="kwd">as</span> [<span class="id">Px</span>|<span class="id">Px</span>].<br/>
- <span class="tactic">split</span> ; (<span class="tactic">intros</span> [<span class="id">H</span>|<span class="id">H</span>] ; [<span class="id">left</span>|<span class="id">now</span> <span class="id">right</span>]).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Calc.Round.html#cexp_inbetween_float">cexp_inbetween_float</a></span> <span class="kwd">with</span> (1 := <span class="id">Px</span>) (2 := <span class="id">Bx</span>).<br/>
&nbsp;&nbsp;<span class="tactic">exact</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">left</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#cexp_inbetween_float">cexp_inbetween_float</a></span> <span class="kwd">with</span> (1 := <span class="id">Px</span>) (2 := <span class="id">Bx</span>).<br/>
&nbsp;&nbsp;<span class="tactic">exact</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="id">right</span>.<br/>
- <span class="tactic">assert</span> (<span class="id">H</span> := <span class="id">Bx</span>).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Bx</span> <span class="kwd">as</span> [|<span class="id">c</span> <span class="id">Bx</span> <span class="id">_</span>].<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">split</span> ; <span class="id">right</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Px</span> <span class="kwd">in</span> <span class="id">Bx</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Bx</span> <span class="kwd">as</span> [<span class="id">Bx1</span> <span class="id">Bx2</span>].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Float_prop.html#lt_0_F2R">lt_0_F2R</a></span> <span class="kwd">in</span> <span class="id">Bx1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Float_prop.html#gt_0_F2R">gt_0_F2R</a></span> <span class="kwd">in</span> <span class="id">Bx2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Relates location and rounding. </div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="inbetween_float_round">inbetween_float_round</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">rnd</span> <span class="id">choice</span>,<br/>
&nbsp;&nbsp;( <span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>, <span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> -&gt; <span class="id"><a href="compcert.flocq.Calc.Round.html#rnd">rnd</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Calc.Round.html#choice">choice</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> ) -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">e</span> := <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#rnd">rnd</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#choice">choice</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6073')">Proof.</div>
<div class="proofscript" id="proof6073">
<span class="tactic">intros</span> <span class="id">rnd</span> <span class="id">choice</span> <span class="id">Hc</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span> <span class="id">e</span> <span class="id">Hl</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span>, <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span>. <span class="tactic">simpl</span>.<br/>
<span class="tactic">apply</span> (<span class="tactic">f_equal</span> (<span class="kwd">fun</span> <span class="id">m</span> =&gt; (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> * <span class="id"><a href="compcert.flocq.Calc.Round.html#bpow">bpow</a></span> <span class="id">e</span>)%<span class="id">R</span>)).<br/>
<span class="tactic">apply</span> <span class="id">Hc</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_mult_reg">inbetween_mult_reg</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#bpow">bpow</a></span> <span class="id">e</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>.<br/>
<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa_mult_bpow">scaled_mantissa_mult_bpow</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="cond_incr">cond_incr</a></span> (<span class="id">b</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>) <span class="id">m</span> := <span class="kwd">if</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#b">b</a></span> <span class="kwd">then</span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> + 1)%<span class="id">Z</span> <span class="kwd">else</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="inbetween_float_round_sign">inbetween_float_round_sign</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">rnd</span> <span class="id">choice</span>,<br/>
&nbsp;&nbsp;( <span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>, <span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Round.html#rnd">rnd</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Core.Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> 0) (<span class="id"><a href="compcert.flocq.Calc.Round.html#choice">choice</a></span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> 0) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) ) -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">e</span> := <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#rnd">rnd</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="compcert.flocq.Core.Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> 0) (<span class="id"><a href="compcert.flocq.Calc.Round.html#choice">choice</a></span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> 0) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>)) <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6074')">Proof.</div>
<div class="proofscript" id="proof6074">
<span class="tactic">intros</span> <span class="id">rnd</span> <span class="id">choice</span> <span class="id">Hc</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span> <span class="id">e</span> <span class="id">Hx</span>.<br/>
<span class="tactic">apply</span> (<span class="tactic">f_equal</span> (<span class="kwd">fun</span> <span class="id">m</span> =&gt; (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> * <span class="id"><a href="compcert.flocq.Calc.Round.html#bpow">bpow</a></span> <span class="id">e</span>)%<span class="id">R</span>)).<br/>
<span class="tactic">simpl</span>.<br/>
<span class="tactic">replace</span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id">x</span> 0) <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id">x</span>) 0).<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">apply</span> <span class="id">Hc</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_mult_reg">inbetween_mult_reg</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#bpow">bpow</a></span> <span class="id">e</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>.<br/>
<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#bpow">bpow</a></span> <span class="id">e</span>)) <span class="tactic">at</span> 3.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_mult">Rabs_mult</a></span>.<br/>
<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa_mult_bpow">scaled_mantissa_mult_bpow</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_ge">Rle_ge</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_ge_0">bpow_ge_0</a></span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool_spec">Rlt_bool_spec</a></span> <span class="id">x</span> 0) <span class="kwd">as</span> [<span class="id">Zx</span>|<span class="id">Zx</span>] ; <span class="tactic">simpl</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool_true">Rlt_bool_true</a></span>.<br/>
<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_l">Rmult_0_l</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#bpow">bpow</a></span> (-<span class="id">e</span>))).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_compat_r">Rmult_lt_compat_r</a></span> <span class="kwd">with</span> (2 := <span class="id">Zx</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_gt_0">bpow_gt_0</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool_false">Rlt_bool_false</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_pos">Rmult_le_pos</a></span> <span class="kwd">with</span> (1 := <span class="id">Zx</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_ge_0">bpow_ge_0</a></span>.<br/>
Qed.</div>
<br/>
<div class="doc">Relates location and rounding down. </div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="inbetween_int_DN">inbetween_int_DN</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6075')">Proof.</div>
<div class="proofscript" id="proof6075">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span> <span class="id">Hl</span>.<br/>
<span class="tactic">refine</span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor_imp">Zfloor_imp</a></span> <span class="id">m</span> <span class="id">_</span> <span class="id">_</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_bounds">inbetween_bounds</a></span> <span class="kwd">with</span> (2 := <span class="id">Hl</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#IZR_lt">IZR_lt</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zlt_succ">Zlt_succ</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="inbetween_float_DN">inbetween_float_DN</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">e</span> := <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6076')">Proof.</div>
<div class="proofscript" id="proof6076">
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_float_round">inbetween_float_round</a></span> <span class="kwd">with</span> (<span class="id">choice</span> := <span class="kwd">fun</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>).<br/>
<span class="tactic">exact</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_int_DN">inbetween_int_DN</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_sign_DN">round_sign_DN</a></span> <span class="id">s</span> <span class="id">l</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Round.html#s">s</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="inbetween_int_DN_sign">inbetween_int_DN_sign</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Core.Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> 0) (<span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_sign_DN">round_sign_DN</a></span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> 0) <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6077')">Proof.</div>
<div class="proofscript" id="proof6077">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span> <span class="id">Hl</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="kwd">in</span> <span class="id">Hl</span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rcase_abs">Rcase_abs</a></span> <span class="id">x</span>) <span class="kwd">as</span> [<span class="id">Zx</span>|<span class="id">Zx</span>] .<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool_true">Rlt_bool_true</a></span> <span class="kwd">with</span> (1 := <span class="id">Zx</span>).<br/>
<span class="tactic">inversion_clear</span> <span class="id">Hl</span> ; <span class="tactic">simpl</span>.<br/>
<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_involutive">Ropp_involutive</a></span> <span class="id">x</span>).<br/>
<span class="tactic">rewrite</span> <span class="id">H</span>, &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#opp_IZR">opp_IZR</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor_IZR">Zfloor_IZR</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor_imp">Zfloor_imp</a></span>.<br/>
<span class="tactic">split</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#opp_IZR">opp_IZR</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_lt_cancel">Ropp_lt_cancel</a></span>.<br/>
<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_involutive">Ropp_involutive</a></span>.<br/>
<span class="id">ring_simplify</span> (- (<span class="id">m</span> + 1) + 1)%<span class="id">Z</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#opp_IZR">opp_IZR</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_lt_cancel">Ropp_lt_cancel</a></span>.<br/>
<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_involutive">Ropp_involutive</a></span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool_false">Rlt_bool_false</a></span>.<br/>
<span class="tactic">inversion_clear</span> <span class="id">Hl</span> ; <span class="tactic">simpl</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor_IZR">Zfloor_IZR</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor_imp">Zfloor_imp</a></span>.<br/>
<span class="tactic">split</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>.<br/>
<span class="tactic">apply</span> <span class="id">H</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rge_le">Rge_le</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="inbetween_float_DN_sign">inbetween_float_DN_sign</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">e</span> := <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="compcert.flocq.Core.Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> 0) (<span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_sign_DN">round_sign_DN</a></span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> 0) <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>)) <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6078')">Proof.</div>
<div class="proofscript" id="proof6078">
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_float_round_sign">inbetween_float_round_sign</a></span> <span class="kwd">with</span> (<span class="id">choice</span> := <span class="kwd">fun</span> <span class="id">s</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_sign_DN">round_sign_DN</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#s">s</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>).<br/>
<span class="tactic">exact</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_int_DN_sign">inbetween_int_DN_sign</a></span>.<br/>
Qed.</div>
<br/>
<div class="doc">Relates location and rounding up. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_UP">round_UP</a></span> <span class="id">l</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="inbetween_int_UP">inbetween_int_UP</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Raux.html#Zceil">Zceil</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_UP">round_UP</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6079')">Proof.</div>
<div class="proofscript" id="proof6079">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span> <span class="id">Hl</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Hl</span>': <span class="id">l</span> = <span class="id"><a href="compcert.flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span> \/ (<span class="id">l</span> &lt;&gt; <span class="id"><a href="compcert.flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span> /\ <span class="id"><a href="compcert.flocq.Calc.Round.html#round_UP">round_UP</a></span> <span class="id">l</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>)).<br/>
<span class="tactic">case</span> <span class="id">l</span> ; <span class="tactic">try</span> (<span class="id">now</span> <span class="id">left</span>) ; <span class="id">now</span> <span class="id">right</span> ; <span class="tactic">split</span>.<br/>
<span class="tactic">destruct</span> <span class="id">Hl</span>' <span class="kwd">as</span> [<span class="id">Hl</span>'|(<span class="id">Hl1</span>, <span class="id">Hl2</span>)].<br/>
<span class="comment">(*&nbsp;Exact&nbsp;*)</span><br/>
<span class="tactic">rewrite</span> <span class="id">Hl</span>'.<br/>
<span class="tactic">destruct</span> <span class="id">Hl</span> ; <span class="tactic">try</span> <span class="id">easy</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
<span class="tactic">exact</span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Zceil_IZR">Zceil_IZR</a></span> <span class="id">_</span>).<br/>
<span class="comment">(*&nbsp;not&nbsp;Exact&nbsp;*)</span><br/>
<span class="tactic">rewrite</span> <span class="id">Hl2</span>.<br/>
<span class="tactic">simpl</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zceil_imp">Zceil_imp</a></span>.<br/>
<span class="id">ring_simplify</span> (<span class="id">m</span> + 1 - 1)%<span class="id">Z</span>.<br/>
<span class="tactic">refine</span> (<span class="kwd">let</span> <span class="id">H</span> := <span class="id">_</span> <span class="kwd">in</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#conj">conj</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#H">H</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj2">proj2</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#H">H</a></span>))).<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_bounds_not_Eq">inbetween_bounds_not_Eq</a></span> <span class="kwd">with</span> (2 := <span class="id">Hl1</span>) (1 := <span class="id">Hl</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="inbetween_float_UP">inbetween_float_UP</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">e</span> := <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zceil">Zceil</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_UP">round_UP</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6080')">Proof.</div>
<div class="proofscript" id="proof6080">
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_float_round">inbetween_float_round</a></span> <span class="kwd">with</span> (<span class="id">choice</span> := <span class="kwd">fun</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_UP">round_UP</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>).<br/>
<span class="tactic">exact</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_int_UP">inbetween_int_UP</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_sign_UP">round_sign_UP</a></span> <span class="id">s</span> <span class="id">l</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#s">s</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="inbetween_int_UP_sign">inbetween_int_UP_sign</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Raux.html#Zceil">Zceil</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Core.Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> 0) (<span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_sign_UP">round_sign_UP</a></span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> 0) <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6081')">Proof.</div>
<div class="proofscript" id="proof6081">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span> <span class="id">Hl</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="kwd">in</span> <span class="id">Hl</span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rcase_abs">Rcase_abs</a></span> <span class="id">x</span>) <span class="kwd">as</span> [<span class="id">Zx</span>|<span class="id">Zx</span>] .<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool_true">Rlt_bool_true</a></span> <span class="kwd">with</span> (1 := <span class="id">Zx</span>).<br/>
<span class="tactic">simpl</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zceil">Zceil</a></span>.<br/>
<span class="tactic">apply</span> <span class="tactic">f_equal</span>.<br/>
<span class="tactic">inversion_clear</span> <span class="id">Hl</span> ; <span class="tactic">simpl</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor_IZR">Zfloor_IZR</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor_imp">Zfloor_imp</a></span>.<br/>
<span class="tactic">split</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>.<br/>
<span class="tactic">apply</span> <span class="id">H</span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool_false">Rlt_bool_false</a></span>.<br/>
<span class="tactic">simpl</span>.<br/>
<span class="tactic">inversion_clear</span> <span class="id">Hl</span> ; <span class="tactic">simpl</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zceil_IZR">Zceil_IZR</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zceil_imp">Zceil_imp</a></span>.<br/>
<span class="tactic">split</span>.<br/>
<span class="id">change</span> (<span class="id">m</span> + 1 - 1)%<span class="id">Z</span> <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pred">Z.pred</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.succ">Z.succ</a></span> <span class="id">m</span>)).<br/>
<span class="id">now</span> <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zpred_succ">Zpred_succ</a></span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rge_le">Rge_le</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="inbetween_float_UP_sign">inbetween_float_UP_sign</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">e</span> := <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zceil">Zceil</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="compcert.flocq.Core.Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> 0) (<span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_sign_UP">round_sign_UP</a></span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> 0) <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>)) <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6082')">Proof.</div>
<div class="proofscript" id="proof6082">
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_float_round_sign">inbetween_float_round_sign</a></span> <span class="kwd">with</span> (<span class="id">choice</span> := <span class="kwd">fun</span> <span class="id">s</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_sign_UP">round_sign_UP</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#s">s</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>).<br/>
<span class="tactic">exact</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_int_UP_sign">inbetween_int_UP_sign</a></span>.<br/>
Qed.</div>
<br/>
<div class="doc">Relates location and rounding toward zero. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_ZR">round_ZR</a></span> (<span class="id">s</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>) <span class="id">l</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Round.html#s">s</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="inbetween_int_ZR">inbetween_int_ZR</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Raux.html#Ztrunc">Ztrunc</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_ZR">round_ZR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_bool">Zlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> 0) <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6083')">Proof with</div>
<div class="proofscript" id="proof6083">
 <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">typeclass_instances</span>.<br/>
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span> <span class="id">Hl</span>.<br/>
<span class="tactic">inversion_clear</span> <span class="id">Hl</span> <span class="kwd">as</span> [<span class="id">Hx</span>|<span class="id">l</span>' <span class="id">Hx</span> <span class="id">Hl</span>'].<br/>
<span class="comment">(*&nbsp;Exact&nbsp;*)</span><br/>
<span class="tactic">rewrite</span> <span class="id">Hx</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Zrnd_IZR">Zrnd_IZR</a></span>...<br/>
<span class="comment">(*&nbsp;not&nbsp;Exact&nbsp;*)</span><br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Ztrunc">Ztrunc</a></span>.<br/>
<span class="tactic">assert</span> (<span class="id">Hm</span>: <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> <span class="id">x</span> = <span class="id">m</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor_imp">Zfloor_imp</a></span>.<br/>
<span class="tactic">exact</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#conj">conj</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> <span class="id">Hx</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj2">proj2</a></span> <span class="id">Hx</span>)).<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zceil_floor_neq">Zceil_floor_neq</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id">Hm</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span>.<br/>
<span class="tactic">simpl</span>.<br/>
<span class="tactic">case</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool_spec">Rlt_bool_spec</a></span> ; <span class="tactic">intros</span> <span class="id">Hx</span>' ;<br/>
&nbsp;&nbsp;<span class="tactic">case</span> <span class="id"><a href="compcert.flocq.Core.Zaux.html#Zlt_bool_spec">Zlt_bool_spec</a></span> ; <span class="tactic">intros</span> <span class="id">Hm</span>' ; <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#refl_equal">refl_equal</a></span>.<br/>
<span class="tactic">elim</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_not_le">Rlt_not_le</a></span> <span class="kwd">with</span> (1 := <span class="id">Hx</span>').<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (2 := <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> <span class="id">Hx</span>).<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#IZR_le">IZR_le</a></span>.<br/>
<span class="tactic">elim</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_not_lt">Rle_not_lt</a></span> <span class="kwd">with</span> (1 := <span class="id">Hx</span>').<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (1 := <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj2">proj2</a></span> <span class="id">Hx</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#IZR_le">IZR_le</a></span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zlt_le_succ">Zlt_le_succ</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id">Hm</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_not_eq">Rlt_not_eq</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="inbetween_float_ZR">inbetween_float_ZR</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">e</span> := <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Ztrunc">Ztrunc</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_ZR">round_ZR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_bool">Zlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> 0) <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6084')">Proof.</div>
<div class="proofscript" id="proof6084">
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_float_round">inbetween_float_round</a></span> <span class="kwd">with</span> (<span class="id">choice</span> := <span class="kwd">fun</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_ZR">round_ZR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_bool">Zlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> 0) <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>).<br/>
<span class="tactic">exact</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_int_ZR">inbetween_int_ZR</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="inbetween_int_ZR_sign">inbetween_int_ZR_sign</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Raux.html#Ztrunc">Ztrunc</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Core.Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> 0) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6085')">Proof.</div>
<div class="proofscript" id="proof6085">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span> <span class="id">Hl</span>.<br/>
<span class="tactic">simpl</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Ztrunc">Ztrunc</a></span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_dec">Rlt_le_dec</a></span> <span class="id">x</span> 0) <span class="kwd">as</span> [<span class="id">Zx</span>|<span class="id">Zx</span>].<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool_true">Rlt_bool_true</a></span> <span class="kwd">with</span> (1 := <span class="id">Zx</span>).<br/>
<span class="tactic">simpl</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zceil">Zceil</a></span>.<br/>
<span class="tactic">apply</span> <span class="tactic">f_equal</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor_imp">Zfloor_imp</a></span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_left">Rabs_left</a></span> <span class="kwd">with</span> (1 := <span class="id">Zx</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_bounds">inbetween_bounds</a></span> <span class="kwd">with</span> (2 := <span class="id">Hl</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#IZR_lt">IZR_lt</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zlt_succ">Zlt_succ</a></span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool_false">Rlt_bool_false</a></span> <span class="kwd">with</span> (1 := <span class="id">Zx</span>).<br/>
<span class="tactic">simpl</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor_imp">Zfloor_imp</a></span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos_eq">Rabs_pos_eq</a></span> <span class="kwd">with</span> (1 := <span class="id">Zx</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_bounds">inbetween_bounds</a></span> <span class="kwd">with</span> (2 := <span class="id">Hl</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#IZR_lt">IZR_lt</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zlt_succ">Zlt_succ</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="inbetween_float_ZR_sign">inbetween_float_ZR_sign</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">e</span> := <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Ztrunc">Ztrunc</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="compcert.flocq.Core.Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> 0) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6086')">Proof.</div>
<div class="proofscript" id="proof6086">
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_float_round_sign">inbetween_float_round_sign</a></span> <span class="kwd">with</span> (<span class="id">choice</span> := <span class="kwd">fun</span> <span class="id">s</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>).<br/>
<span class="tactic">exact</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_int_ZR_sign">inbetween_int_ZR_sign</a></span>.<br/>
Qed.</div>
<br/>
<div class="doc">Relates location and rounding to nearest. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_N">round_N</a></span> (<span class="id">p</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>) <span class="id">l</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.flocq.Calc.Bracket.html#loc_Inexact">loc_Inexact</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Lt">Lt</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.flocq.Calc.Bracket.html#loc_Inexact">loc_Inexact</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Eq">Eq</a></span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Round.html#p">p</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.flocq.Calc.Bracket.html#loc_Inexact">loc_Inexact</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Gt">Gt</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="inbetween_int_N">inbetween_int_N</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">choice</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Znearest">Znearest</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#choice">choice</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_N">round_N</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#choice">choice</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6087')">Proof with</div>
<div class="proofscript" id="proof6087">
 <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">typeclass_instances</span>.<br/>
<span class="tactic">intros</span> <span class="id">choice</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span> <span class="id">Hl</span>.<br/>
<span class="tactic">inversion_clear</span> <span class="id">Hl</span> <span class="kwd">as</span> [<span class="id">Hx</span>|<span class="id">l</span>' <span class="id">Hx</span> <span class="id">Hl</span>'].<br/>
<span class="comment">(*&nbsp;Exact&nbsp;*)</span><br/>
<span class="tactic">rewrite</span> <span class="id">Hx</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Zrnd_IZR">Zrnd_IZR</a></span>...<br/>
<span class="comment">(*&nbsp;not&nbsp;Exact&nbsp;*)</span><br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Znearest">Znearest</a></span>.<br/>
<span class="tactic">assert</span> (<span class="id">Hm</span>: <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> <span class="id">x</span> = <span class="id">m</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor_imp">Zfloor_imp</a></span>.<br/>
<span class="tactic">exact</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#conj">conj</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> <span class="id">Hx</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj2">proj2</a></span> <span class="id">Hx</span>)).<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zceil_floor_neq">Zceil_floor_neq</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id">Hm</span>.<br/>
<span class="tactic">replace</span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Rcompare">Rcompare</a></span> (<span class="id">x</span> - <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id">m</span>) (/2)) <span class="kwd">with</span> <span class="id">l</span>'.<br/>
<span class="id">now</span> <span class="tactic">case</span> <span class="id">l</span>'.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">Hl</span>'.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#plus_IZR">plus_IZR</a></span>.<br/>
<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="compcert.flocq.Core.Raux.html#Rcompare_plus_r">Rcompare_plus_r</a></span> (- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id">m</span>) <span class="id">x</span>).<br/>
<span class="tactic">apply</span> <span class="tactic">f_equal</span>.<br/>
<span class="id">field</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">Hm</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_not_eq">Rlt_not_eq</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="inbetween_int_N_sign">inbetween_int_N_sign</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">choice</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Znearest">Znearest</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#choice">choice</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Core.Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> 0) (<span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_N">round_N</a></span> (<span class="kwd">if</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> 0 <span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#choice">choice</a></span> (-(<span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> + 1))%<span class="id">Z</span>) <span class="kwd">else</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#choice">choice</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6088')">Proof with</div>
<div class="proofscript" id="proof6088">
 <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">typeclass_instances</span>.<br/>
<span class="tactic">intros</span> <span class="id">choice</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span> <span class="id">Hl</span>.<br/>
<span class="tactic">simpl</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="kwd">in</span> <span class="id">Hl</span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rcase_abs">Rcase_abs</a></span> <span class="id">x</span>) <span class="kwd">as</span> [<span class="id">Zx</span>|<span class="id">Zx</span>].<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool_true">Rlt_bool_true</a></span> <span class="kwd">with</span> (1 := <span class="id">Zx</span>).<br/>
<span class="tactic">simpl</span>.<br/>
<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_involutive">Ropp_involutive</a></span> <span class="id">x</span>).<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Znearest_opp">Znearest_opp</a></span>.<br/>
<span class="tactic">apply</span> <span class="tactic">f_equal</span>.<br/>
<span class="tactic">inversion_clear</span> <span class="id">Hl</span> <span class="kwd">as</span> [<span class="id">Hx</span>|<span class="id">l</span>' <span class="id">Hx</span> <span class="id">Hl</span>'].<br/>
<span class="tactic">rewrite</span> <span class="id">Hx</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Zrnd_IZR">Zrnd_IZR</a></span>...<br/>
<span class="tactic">assert</span> (<span class="id">Hm</span>: <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> (-<span class="id">x</span>) = <span class="id">m</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor_imp">Zfloor_imp</a></span>.<br/>
<span class="tactic">exact</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#conj">conj</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> <span class="id">Hx</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj2">proj2</a></span> <span class="id">Hx</span>)).<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Znearest">Znearest</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zceil_floor_neq">Zceil_floor_neq</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id">Hm</span>.<br/>
<span class="tactic">replace</span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Rcompare">Rcompare</a></span> (- <span class="id">x</span> - <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id">m</span>) (/2)) <span class="kwd">with</span> <span class="id">l</span>'.<br/>
<span class="id">now</span> <span class="tactic">case</span> <span class="id">l</span>'.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">Hl</span>'.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#plus_IZR">plus_IZR</a></span>.<br/>
<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="compcert.flocq.Core.Raux.html#Rcompare_plus_r">Rcompare_plus_r</a></span> (- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id">m</span>) (-<span class="id">x</span>)).<br/>
<span class="tactic">apply</span> <span class="tactic">f_equal</span>.<br/>
<span class="id">field</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">Hm</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_not_eq">Rlt_not_eq</a></span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rge_le">Rge_le</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">Zx</span>).<br/>
<span class="tactic">clear</span> <span class="id">Zx</span>. <span class="tactic">intros</span> <span class="id">Zx</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool_false">Rlt_bool_false</a></span> <span class="kwd">with</span> (1 := <span class="id">Zx</span>).<br/>
<span class="tactic">simpl</span>.<br/>
<span class="tactic">inversion_clear</span> <span class="id">Hl</span> <span class="kwd">as</span> [<span class="id">Hx</span>|<span class="id">l</span>' <span class="id">Hx</span> <span class="id">Hl</span>'].<br/>
<span class="tactic">rewrite</span> <span class="id">Hx</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Zrnd_IZR">Zrnd_IZR</a></span>...<br/>
<span class="tactic">assert</span> (<span class="id">Hm</span>: <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> <span class="id">x</span> = <span class="id">m</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor_imp">Zfloor_imp</a></span>.<br/>
<span class="tactic">exact</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#conj">conj</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> <span class="id">Hx</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj2">proj2</a></span> <span class="id">Hx</span>)).<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Znearest">Znearest</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zceil_floor_neq">Zceil_floor_neq</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id">Hm</span>.<br/>
<span class="tactic">replace</span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Rcompare">Rcompare</a></span> (<span class="id">x</span> - <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id">m</span>) (/2)) <span class="kwd">with</span> <span class="id">l</span>'.<br/>
<span class="id">now</span> <span class="tactic">case</span> <span class="id">l</span>'.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">Hl</span>'.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#plus_IZR">plus_IZR</a></span>.<br/>
<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="compcert.flocq.Core.Raux.html#Rcompare_plus_r">Rcompare_plus_r</a></span> (- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id">m</span>) <span class="id">x</span>).<br/>
<span class="tactic">apply</span> <span class="tactic">f_equal</span>.<br/>
<span class="id">field</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">Hm</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_not_eq">Rlt_not_eq</a></span>.<br/>
Qed.</div>
<br/>
<div class="doc">Relates location and rounding to nearest even. </div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="inbetween_int_NE">inbetween_int_NE</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Round_NE.html#ZnearestE">ZnearestE</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_N">round_N</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.even">Z.even</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>)) <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6089')">Proof.</div>
<div class="proofscript" id="proof6089">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span> <span class="id">Hl</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_int_N">inbetween_int_N</a></span> <span class="kwd">with</span> (<span class="id">choice</span> := <span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.even">Z.even</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span>)).<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="inbetween_float_NE">inbetween_float_NE</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">e</span> := <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Core.Round_NE.html#ZnearestE">ZnearestE</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_N">round_N</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.even">Z.even</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>)) <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6090')">Proof.</div>
<div class="proofscript" id="proof6090">
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_float_round">inbetween_float_round</a></span> <span class="kwd">with</span> (<span class="id">choice</span> := <span class="kwd">fun</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_N">round_N</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.even">Z.even</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>)) <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>).<br/>
<span class="tactic">exact</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_int_NE">inbetween_int_NE</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="inbetween_int_NE_sign">inbetween_int_NE_sign</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Round_NE.html#ZnearestE">ZnearestE</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Core.Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> 0) (<span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_N">round_N</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.even">Z.even</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>)) <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6091')">Proof.</div>
<div class="proofscript" id="proof6091">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span> <span class="id">Hl</span>.<br/>
<span class="id">erewrite</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_int_N_sign">inbetween_int_N_sign</a></span> <span class="kwd">with</span> (<span class="id">choice</span> := <span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.even">Z.even</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span>)).<br/>
2: <span class="id">eexact</span> <span class="id">Hl</span>.<br/>
<span class="tactic">apply</span> <span class="tactic">f_equal</span>.<br/>
<span class="tactic">case</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.even_opp">Z.even_opp</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.even_add">Z.even_add</a></span>.<br/>
<span class="id">now</span> <span class="tactic">case</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.even">Z.even</a></span> <span class="id">m</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#refl_equal">refl_equal</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="inbetween_float_NE_sign">inbetween_float_NE_sign</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">e</span> := <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Core.Round_NE.html#ZnearestE">ZnearestE</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="compcert.flocq.Core.Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> 0) (<span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_N">round_N</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.even">Z.even</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>)) <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>)) <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6092')">Proof.</div>
<div class="proofscript" id="proof6092">
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_float_round_sign">inbetween_float_round_sign</a></span> <span class="kwd">with</span> (<span class="id">choice</span> := <span class="kwd">fun</span> <span class="id">s</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_N">round_N</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.even">Z.even</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>)) <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>).<br/>
<span class="tactic">exact</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_int_NE_sign">inbetween_int_NE_sign</a></span>.<br/>
Qed.</div>
<br/>
<div class="doc">Relates location and rounding to nearest away. </div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="inbetween_int_NA">inbetween_int_NA</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#ZnearestA">ZnearestA</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_N">round_N</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zle_bool">Zle_bool</a></span> 0 <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6093')">Proof.</div>
<div class="proofscript" id="proof6093">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span> <span class="id">Hl</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_int_N">inbetween_int_N</a></span> <span class="kwd">with</span> (<span class="id">choice</span> := <span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zle_bool">Zle_bool</a></span> 0 <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="inbetween_float_NA">inbetween_float_NA</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">e</span> := <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#ZnearestA">ZnearestA</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_N">round_N</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zle_bool">Zle_bool</a></span> 0 <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6094')">Proof.</div>
<div class="proofscript" id="proof6094">
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_float_round">inbetween_float_round</a></span> <span class="kwd">with</span> (<span class="id">choice</span> := <span class="kwd">fun</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_N">round_N</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zle_bool">Zle_bool</a></span> 0 <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>).<br/>
<span class="tactic">exact</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_int_NA">inbetween_int_NA</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="inbetween_int_NA_sign">inbetween_int_NA_sign</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#ZnearestA">ZnearestA</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Core.Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> 0) (<span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_N">round_N</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6095')">Proof.</div>
<div class="proofscript" id="proof6095">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span> <span class="id">Hl</span>.<br/>
<span class="id">erewrite</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_int_N_sign">inbetween_int_N_sign</a></span> <span class="kwd">with</span> (<span class="id">choice</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zle_bool">Zle_bool</a></span> 0).<br/>
2: <span class="id">eexact</span> <span class="id">Hl</span>.<br/>
<span class="tactic">apply</span> <span class="tactic">f_equal</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Hm</span>: (0 &lt;= <span class="id">m</span>)%<span class="id">Z</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zlt_succ_le">Zlt_succ_le</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#lt_IZR">lt_IZR</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id">x</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos">Rabs_pos</a></span>.<br/>
<span class="tactic">refine</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj2">proj2</a></span> (<span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_bounds">inbetween_bounds</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hl</span>)).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#IZR_lt">IZR_lt</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zlt_succ">Zlt_succ</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Zaux.html#Zle_bool_true">Zle_bool_true</a></span> <span class="kwd">with</span> (1 := <span class="id">Hm</span>).<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Zaux.html#Zle_bool_false">Zle_bool_false</a></span>.<br/>
<span class="id">now</span> <span class="tactic">case</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span>.<br/>
<span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="truncate_aux">truncate_aux</a></span> <span class="id">t</span> <span class="id">k</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">m</span>, <span class="id">e</span>, <span class="id">l</span>) := <span class="id"><a href="compcert.flocq.Calc.Round.html#t">t</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">p</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpow_def.html#Zpower">Zpower</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#k">k</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.div">Z.div</a></span> <span class="id">m</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#p">p</a></span>, (<span class="id">e</span> + <span class="id"><a href="compcert.flocq.Calc.Round.html#k">k</a></span>)%<span class="id">Z</span>, <span class="id"><a href="compcert.flocq.Calc.Bracket.html#new_location">new_location</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#p">p</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zdiv.html#Zmod">Zmod</a></span> <span class="id">m</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#p">p</a></span>) <span class="id">l</span>).<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="truncate_aux_comp">truncate_aux_comp</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span> <span class="id">k1</span> <span class="id">k2</span>,<br/>
&nbsp;&nbsp;(0 &lt; <span class="id"><a href="compcert.flocq.Calc.Round.html#k1">k1</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;(0 &lt; <span class="id"><a href="compcert.flocq.Calc.Round.html#k2">k2</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Round.html#truncate_aux">truncate_aux</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#t">t</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#k1">k1</a></span> + <span class="id"><a href="compcert.flocq.Calc.Round.html#k2">k2</a></span>) = <span class="id"><a href="compcert.flocq.Calc.Round.html#truncate_aux">truncate_aux</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#truncate_aux">truncate_aux</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#t">t</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#k1">k1</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#k2">k2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6096')">Proof.</div>
<div class="proofscript" id="proof6096">
<span class="tactic">intros</span> ((<span class="id">m</span>,<span class="id">e</span>),<span class="id">l</span>) <span class="id">k1</span> <span class="id">k2</span> <span class="id">Hk1</span> <span class="id">Hk2</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#truncate_aux">truncate_aux</a></span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_float_ex">inbetween_float_ex</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span>) <span class="kwd">as</span> (<span class="id">x</span>,<span class="id">Hx</span>).<br/>
<span class="tactic">assert</span> (<span class="id">B1</span> := <span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_float_new_location">inbetween_float_new_location</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hk1</span> <span class="id">Hx</span>).<br/>
<span class="tactic">assert</span> (<span class="id">Hk3</span>: (0 &lt; <span class="id">k1</span> + <span class="id">k2</span>)%<span class="id">Z</span>).<br/>
<span class="id">change</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z0">Z0</a></span> <span class="kwd">with</span> (0 + 0)%<span class="id">Z</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zplus_lt_compat">Zplus_lt_compat</a></span>.<br/>
<span class="tactic">assert</span> (<span class="id">B3</span> := <span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_float_new_location">inbetween_float_new_location</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hk3</span> <span class="id">Hx</span>).<br/>
<span class="tactic">assert</span> (<span class="id">B2</span> := <span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_float_new_location">inbetween_float_new_location</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hk2</span> <span class="id">B1</span>).<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zplus_assoc">Zplus_assoc</a></span> <span class="kwd">in</span> <span class="id">B3</span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_float_unique">inbetween_float_unique</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">B2</span> <span class="id">B3</span>).<br/>
<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H</span>, <span class="id">H0</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zplus_assoc">Zplus_assoc</a></span>.<br/>
Qed.</div>
<br/>
<div class="doc">Given a triple (mantissa, exponent, position), this function
    computes a triple with a canonic exponent, assuming the
    original triple had enough precision. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="truncate">truncate</a></span> <span class="id">t</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">m</span>, <span class="id">e</span>, <span class="id">l</span>) := <span class="id"><a href="compcert.flocq.Calc.Round.html#t">t</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">k</span> := (<span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Core.Digits.html#Zdigits">Zdigits</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id">m</span> + <span class="id">e</span>) - <span class="id">e</span>)%<span class="id">Z</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_bool">Zlt_bool</a></span> 0 <span class="id"><a href="compcert.flocq.Calc.Round.html#k">k</a></span> <span class="kwd">then</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#truncate_aux">truncate_aux</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#t">t</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#k">k</a></span><br/>
&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#t">t</a></span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="truncate_0">truncate_0</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">e</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">m</span>', <span class="id">e</span>', <span class="id">l</span>') := <span class="id"><a href="compcert.flocq.Calc.Round.html#truncate">truncate</a></span> (0, <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span>, <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>)%<span class="id">Z</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id">m</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z0">Z0</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6097')">Proof.</div>
<div class="proofscript" id="proof6097">
<span class="tactic">intros</span> <span class="id">e</span> <span class="id">l</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#truncate">truncate</a></span>.<br/>
<span class="tactic">case</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_bool">Zlt_bool</a></span>.<br/>
<span class="tactic">simpl</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zdiv.html#Zdiv_0_l">Zdiv_0_l</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#refl_equal">refl_equal</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="generic_format_truncate">generic_format_truncate</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;(0 &lt;= <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">m</span>', <span class="id">e</span>', <span class="id">l</span>') := <span class="id"><a href="compcert.flocq.Calc.Round.html#truncate">truncate</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>, <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span>, <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Round.html#format">format</a></span> (<span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id">m</span>' <span class="id">e</span>')).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6098')">Proof.</div>
<div class="proofscript" id="proof6098">
<span class="tactic">intros</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> <span class="id">Hm</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#truncate">truncate</a></span>.<br/>
<span class="tactic">set</span> (<span class="id">k</span> := (<span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Core.Digits.html#Zdigits">Zdigits</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id">m</span> + <span class="id">e</span>) - <span class="id">e</span>)%<span class="id">Z</span>).<br/>
<span class="tactic">case</span> <span class="id"><a href="compcert.flocq.Core.Zaux.html#Zlt_bool_spec">Zlt_bool_spec</a></span> ; <span class="tactic">intros</span> <span class="id">Hk</span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#truncate_aux">truncate_aux</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format_F2R">generic_format_F2R</a></span>.<br/>
<span class="tactic">intros</span> <span class="id">Hd</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Float_prop.html#mag_F2R_Zdigits">mag_F2R_Zdigits</a></span> <span class="kwd">with</span> (1 := <span class="id">Hd</span>).<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Digits.html#Zdigits_div_Zpower">Zdigits_div_Zpower</a></span> <span class="kwd">with</span> (1 := <span class="id">Hm</span>).<br/>
<span class="tactic">replace</span> (<span class="id"><a href="compcert.flocq.Core.Digits.html#Zdigits">Zdigits</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id">m</span> - <span class="id">k</span> + (<span class="id">e</span> + <span class="id">k</span>))%<span class="id">Z</span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Core.Digits.html#Zdigits">Zdigits</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id">m</span> + <span class="id">e</span>)%<span class="id">Z</span> <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
<span class="tactic">unfold</span> <span class="id">k</span>.<br/>
<span class="id">ring_simplify</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_refl">Z.le_refl</a></span>.<br/>
<span class="tactic">split</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zlt_le_weak">Zlt_le_weak</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Znot_gt_le">Znot_gt_le</a></span>.<br/>
<span class="id">contradict</span> <span class="id">Hd</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zdiv.html#Zdiv_small">Zdiv_small</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#conj">conj</a></span> <span class="kwd">with</span> (1 := <span class="id">Hm</span>).<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.abs_eq">Z.abs_eq</a></span> <span class="kwd">with</span> (1 := <span class="id">Hm</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Digits.html#Zpower_gt_Zdigits">Zpower_gt_Zdigits</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zlt_le_weak">Zlt_le_weak</a></span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.gt_lt">Z.gt_lt</a></span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zle_lt_or_eq">Zle_lt_or_eq</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hm</span>) <span class="kwd">as</span> [<span class="id">Hm</span>'|<span class="id">Hm</span>'].<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format_F2R">generic_format_F2R</a></span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Float_prop.html#mag_F2R_Zdigits">mag_F2R_Zdigits</a></span>.<br/>
2: <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Zaux.html#Zgt_not_eq">Zgt_not_eq</a></span>.<br/>
<span class="tactic">unfold</span> <span class="id">k</span> <span class="kwd">in</span> <span class="id">Hk</span>. <span class="tactic">clear</span> -<span class="id">Hk</span>.<br/>
<span class="tactic">omega</span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">Hm</span>', <span class="id"><a href="compcert.flocq.Core.Float_prop.html#F2R_0">F2R_0</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format_0">generic_format_0</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="truncate_correct_format">truncate_correct_format</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">e</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z0">Z0</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">x</span> := <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span> &lt;= <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Core.Digits.html#Zdigits">Zdigits</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> + <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span>))%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">m</span>', <span class="id">e</span>', <span class="id">l</span>') := <span class="id"><a href="compcert.flocq.Calc.Round.html#truncate">truncate</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>, <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span>, <span class="id"><a href="compcert.flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id">m</span>' <span class="id">e</span>') /\ <span class="id">e</span>' = <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6099')">Proof.</div>
<div class="proofscript" id="proof6099">
<span class="tactic">intros</span> <span class="id">m</span> <span class="id">e</span> <span class="id">Hm</span> <span class="id">x</span> <span class="id">Fx</span> <span class="id">He</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Hc</span>: <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id">x</span> = <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Core.Digits.html#Zdigits">Zdigits</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id">m</span> + <span class="id">e</span>)).<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>, <span class="id">x</span>.<br/>
<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Float_prop.html#mag_F2R_Zdigits">mag_F2R_Zdigits</a></span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#truncate">truncate</a></span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">Hc</span>.<br/>
<span class="tactic">set</span> (<span class="id">k</span> := (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id">x</span> - <span class="id">e</span>)%<span class="id">Z</span>).<br/>
<span class="tactic">case</span> <span class="id"><a href="compcert.flocq.Core.Zaux.html#Zlt_bool_spec">Zlt_bool_spec</a></span> ; <span class="tactic">intros</span> <span class="id">Hk</span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#truncate_aux">truncate_aux</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id">Fx</span> <span class="tactic">at</span> 1.<br/>
<span class="tactic">assert</span> (<span class="id">H</span>: (<span class="id">e</span> + <span class="id">k</span>)%<span class="id">Z</span> = <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id">x</span>).<br/>
<span class="tactic">unfold</span> <span class="id">k</span>. <span class="tactic">ring</span>.<br/>
<span class="tactic">refine</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#conj">conj</a></span> <span class="id">_</span> <span class="id">H</span>).<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">H</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Float_prop.html#F2R_eq">F2R_eq</a></span>.<br/>
<span class="tactic">replace</span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id">x</span>) <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor">Zfloor</a></span> (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id">x</span>))).<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Ztrunc_IZR">Ztrunc_IZR</a></span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">H</span>.<br/>
<span class="tactic">unfold</span> <span class="id">x</span>, <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span>. <span class="tactic">simpl</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>, &lt;- <span class="id"><a href="compcert.flocq.Core.Raux.html#bpow_plus">bpow_plus</a></span>.<br/>
<span class="id">ring_simplify</span> (<span class="id">e</span> + - (<span class="id">e</span> + <span class="id">k</span>))%<span class="id">Z</span>.<br/>
<span class="tactic">clear</span> -<span class="id">Hm</span> <span class="id">Hk</span>.<br/>
<span class="tactic">destruct</span> <span class="id">k</span> <span class="kwd">as</span> [|<span class="id">k</span>|<span class="id">k</span>] ; <span class="tactic">try</span> <span class="id">easy</span>.<br/>
<span class="tactic">simpl</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor_div">Zfloor_div</a></span>.<br/>
<span class="tactic">intros</span> <span class="id">H</span>.<br/>
<span class="tactic">generalize</span> (<span class="id"><a href="compcert.flocq.Core.Zaux.html#Zpower_pos_gt_0">Zpower_pos_gt_0</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id">k</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zle_bool_imp_le">Zle_bool_imp_le</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="compcert.flocq.Core.Zaux.html#radix_prop">radix_prop</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span>)).<br/>
<span class="tactic">omega</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#scaled_mantissa_generic">scaled_mantissa_generic</a></span> <span class="kwd">with</span> (1 := <span class="id">Fx</span>).<br/>
<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Zfloor_IZR">Zfloor_IZR</a></span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">split</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#refl_equal">refl_equal</a></span>.<br/>
<span class="tactic">unfold</span> <span class="id">k</span> <span class="kwd">in</span> <span class="id">Hk</span>.<br/>
<span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id">truncate_correct_partial</span>' :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;(0 &lt; <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span>)%<span class="id">R</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span> &lt;= <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">m</span>', <span class="id">e</span>', <span class="id">l</span>') := <span class="id"><a href="compcert.flocq.Calc.Round.html#truncate">truncate</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>, <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span>, <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id">m</span>' <span class="id">e</span>' <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> <span class="id">l</span>' /\ <span class="id">e</span>' = <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6100')">Proof.</div>
<div class="proofscript" id="proof6100">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> <span class="id">Hx</span> <span class="id">H1</span> <span class="id">H2</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#truncate">truncate</a></span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Calc.Round.html#cexp_inbetween_float">cexp_inbetween_float</a></span> <span class="kwd">with</span> (1 := <span class="id">Hx</span>) (2 := <span class="id">H1</span>) <span class="tactic">by</span> <span class="id">now</span> <span class="id">left</span>.<br/>
<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_cases">Zlt_cases</a></span> 0 (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id">x</span> - <span class="id">e</span>)).<br/>
<span class="tactic">destruct</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_bool">Zlt_bool</a></span> ; <span class="tactic">intros</span> <span class="id">Hk</span>.<br/>
- <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_float_new_location">inbetween_float_new_location</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">ring</span>.<br/>
- <span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#conj">conj</a></span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="truncate_correct_partial">truncate_correct_partial</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;(0 &lt; <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span>)%<span class="id">R</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span> &lt;= <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Core.Digits.html#Zdigits">Zdigits</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> + <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span>))%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">m</span>', <span class="id">e</span>', <span class="id">l</span>') := <span class="id"><a href="compcert.flocq.Calc.Round.html#truncate">truncate</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>, <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span>, <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id">m</span>' <span class="id">e</span>' <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> <span class="id">l</span>' /\ <span class="id">e</span>' = <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6101')">Proof.</div>
<div class="proofscript" id="proof6101">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> <span class="id">Hx</span> <span class="id">H1</span> <span class="id">H2</span>.<br/>
<span class="tactic">apply</span> <span class="id">truncate_correct_partial</span>' <span class="kwd">with</span> (1 := <span class="id">Hx</span>) (2 := <span class="id">H1</span>).<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#cexp_inbetween_float">cexp_inbetween_float</a></span> <span class="kwd">with</span> (1 := <span class="id">Hx</span>) (2 := <span class="id">H1</span>).<br/>
<span class="tactic">exact</span> <span class="id">H2</span>.<br/>
<span class="id">now</span> <span class="id">right</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id">truncate_correct</span>' :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;(0 &lt;= <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span>)%<span class="id">R</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span> &lt;= <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span>)%<span class="id">Z</span> \/ <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> = <span class="id"><a href="compcert.flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">m</span>', <span class="id">e</span>', <span class="id">l</span>') := <span class="id"><a href="compcert.flocq.Calc.Round.html#truncate">truncate</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>, <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span>, <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id">m</span>' <span class="id">e</span>' <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> <span class="id">l</span>' /\<br/>
&nbsp;&nbsp;(<span class="id">e</span>' = <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> \/ (<span class="id">l</span>' = <span class="id"><a href="compcert.flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span> /\ <span class="id"><a href="compcert.flocq.Calc.Round.html#format">format</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6102')">Proof.</div>
<div class="proofscript" id="proof6102">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> [<span class="id">Hx</span>|<span class="id">Hx</span>] <span class="id">H1</span> <span class="id">H2</span>.<br/>
- <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zle_or_lt">Zle_or_lt</a></span> <span class="id">e</span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Core.Digits.html#Zdigits">Zdigits</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id">m</span> + <span class="id">e</span>))) <span class="kwd">as</span> [<span class="id">H3</span>|<span class="id">H3</span>].<br/>
&nbsp;&nbsp;+ <span class="tactic">generalize</span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#truncate_correct_partial">truncate_correct_partial</a></span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> <span class="id">Hx</span> <span class="id">H1</span> <span class="id">H3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#truncate">truncate</a></span> (<span class="id">m</span>, <span class="id">e</span>, <span class="id">l</span>)) <span class="kwd">as</span> [[<span class="id">m</span>' <span class="id">e</span>'] <span class="id">l</span>'].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">H4</span> <span class="id">H5</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#conj">conj</a></span> <span class="id">H4</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">left</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">H2</span> <span class="kwd">as</span> [<span class="id">H2</span>|<span class="id">H2</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">truncate_correct_partial</span>' <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> <span class="id">Hx</span> <span class="id">H1</span> <span class="id">H2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#truncate">truncate</a></span> (<span class="id">m</span>, <span class="id">e</span>, <span class="id">l</span>)) <span class="kwd">as</span> [[<span class="id">m</span>' <span class="id">e</span>'] <span class="id">l</span>'].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">H4</span> <span class="id">H5</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#conj">conj</a></span> <span class="id">H4</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">left</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H1</span> |- *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_cases">Zlt_cases</a></span> 0 (<span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Core.Digits.html#Zdigits">Zdigits</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id">m</span> + <span class="id">e</span>) - <span class="id">e</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_bool">Zlt_bool</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False_ind">False_ind</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#conj">conj</a></span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion_clear</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format_F2R">generic_format_F2R</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">Zm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Float_prop.html#mag_F2R_Zdigits">mag_F2R_Zdigits</a></span> <span class="kwd">with</span> (1 := <span class="id">Zm</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zlt_le_weak">Zlt_le_weak</a></span>.<br/>
- <span class="tactic">assert</span> (<span class="id">Hm</span>: <span class="id">m</span> = 0%<span class="id">Z</span>).<br/>
&nbsp;&nbsp;<span class="tactic">cut</span> (<span class="id">m</span> &lt;= 0 &lt; <span class="id">m</span> + 1)%<span class="id">Z</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id">m</span> <span class="id">e</span>) &lt;= <span class="id">x</span> &lt; <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> (<span class="id">m</span> + 1) <span class="id">e</span>))%<span class="id">R</span> <span class="kwd">as</span> <span class="id">Hx</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_float_bounds">inbetween_float_bounds</a></span> <span class="kwd">with</span> (1 := <span class="id">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">Hx</span> <span class="kwd">in</span> <span class="id">Hx</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Float_prop.html#le_0_F2R">le_0_F2R</a></span> <span class="kwd">with</span> (1 := <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> <span class="id">Hx</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Float_prop.html#gt_0_F2R">gt_0_F2R</a></span> <span class="kwd">with</span> (1 := <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj2">proj2</a></span> <span class="id">Hx</span>').<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Hm</span>, &lt;- <span class="id">Hx</span> <span class="kwd">in</span> <span class="id">H1</span> |- *.<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> -<span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H1</span> <span class="kwd">as</span> [<span class="id">_</span> | <span class="id">l</span>' [<span class="id">H</span> <span class="id">_</span>] <span class="id">_</span>].<br/>
&nbsp;&nbsp;+ <span class="tactic">assert</span> (<span class="id">exists</span> <span class="id">e</span>', <span class="id"><a href="compcert.flocq.Calc.Round.html#truncate">truncate</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z0">Z0</a></span>, <span class="id">e</span>, <span class="id"><a href="compcert.flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span>) = (<span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z0">Z0</a></span>, <span class="id">e</span>', <span class="id"><a href="compcert.flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#truncate">truncate</a></span>, <span class="id"><a href="compcert.flocq.Calc.Round.html#truncate_aux">truncate_aux</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">case</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_bool">Zlt_bool</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zdiv.html#Zdiv_0_l">Zdiv_0_l</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zdiv.html#Zmod_0_l">Zmod_0_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Calc.Bracket.html#new_location">new_location</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="tactic">case</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.even">Z.even</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">now</span> <span class="id">eexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">e</span>' <span class="id">H</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_sym">eq_sym</a></span>, <span class="id"><a href="compcert.flocq.Core.Float_prop.html#F2R_0">F2R_0</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format_0">generic_format_0</a></span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Float_prop.html#F2R_0">F2R_0</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_irrefl">Rlt_irrefl</a></span> <span class="kwd">with</span> (1 := <span class="id">H</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="truncate_correct">truncate_correct</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;(0 &lt;= <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span>)%<span class="id">R</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span> &lt;= <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Core.Digits.html#Zdigits">Zdigits</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> + <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span>))%<span class="id">Z</span> \/ <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> = <span class="id"><a href="compcert.flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">m</span>', <span class="id">e</span>', <span class="id">l</span>') := <span class="id"><a href="compcert.flocq.Calc.Round.html#truncate">truncate</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>, <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span>, <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id">m</span>' <span class="id">e</span>' <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> <span class="id">l</span>' /\<br/>
&nbsp;&nbsp;(<span class="id">e</span>' = <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> \/ (<span class="id">l</span>' = <span class="id"><a href="compcert.flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span> /\ <span class="id"><a href="compcert.flocq.Calc.Round.html#format">format</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6103')">Proof.</div>
<div class="proofscript" id="proof6103">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> <span class="id">Hx</span> <span class="id">H1</span> <span class="id">H2</span>.<br/>
<span class="tactic">apply</span> <span class="id">truncate_correct</span>' <span class="kwd">with</span> (1 := <span class="id">Hx</span>) (2 := <span class="id">H1</span>).<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#cexp_inbetween_float_loc_Exact">cexp_inbetween_float_loc_Exact</a></span> <span class="kwd">with</span> (2 := <span class="id">H1</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Fcalc_round.Fcalc_round_fexp.round_dir">round_dir</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Fcalc_round.Fcalc_round_fexp.round_dir.rnd">rnd</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<span class="kwd">Context</span> { <span class="id">valid_rnd</span> : <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_rnd">Valid_rnd</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir.rnd">rnd</a></span> }.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Fcalc_round.Fcalc_round_fexp.round_dir.choice">choice</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="compcert.flocq.Calc.Bracket.html#location">location</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="Fcalc_round.Fcalc_round_fexp.round_dir.inbetween_int_valid">inbetween_int_valid</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir.rnd">rnd</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir.choice">choice</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="round_any_correct">round_any_correct</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span> = <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> \/ (<span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> = <span class="id"><a href="compcert.flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span> /\ <span class="id"><a href="compcert.flocq.Calc.Round.html#format">format</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir.rnd">rnd</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir.choice">choice</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6104')">Proof with</div>
<div class="proofscript" id="proof6104">
 <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">typeclass_instances</span>.<br/>
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> <span class="id">Hin</span> [<span class="id">He</span>|(<span class="id">Hl</span>,<span class="id">Hf</span>)].<br/>
<span class="tactic">rewrite</span> <span class="id">He</span> <span class="kwd">in</span> <span class="id">Hin</span> |- *.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_float_round">inbetween_float_round</a></span> <span class="kwd">with</span> (2 := <span class="id">Hin</span>).<br/>
<span class="tactic">exact</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir.inbetween_int_valid">inbetween_int_valid</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id">Hl</span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
<span class="tactic">inversion_clear</span> <span class="id">Hin</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">Hl</span>.<br/>
<span class="tactic">replace</span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir.choice">choice</a></span> <span class="id">m</span> <span class="id"><a href="compcert.flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span>) <span class="kwd">with</span> <span class="id">m</span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">H</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_generic">round_generic</a></span>...<br/>
<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Zrnd_IZR">Zrnd_IZR</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir.rnd">rnd</a></span> <span class="id">m</span>) <span class="tactic">at</span> 1.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir.inbetween_int_valid">inbetween_int_valid</a></span>.<br/>
<span class="id">now</span> <span class="id">constructor</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Truncating a triple is sufficient to round a real number. </div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="round_trunc_any_correct">round_trunc_any_correct</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;(0 &lt;= <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span>)%<span class="id">R</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span> &lt;= <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Core.Digits.html#Zdigits">Zdigits</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> + <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span>))%<span class="id">Z</span> \/ <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> = <span class="id"><a href="compcert.flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir.rnd">rnd</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> = <span class="kwd">let</span> '(<span class="id">m</span>', <span class="id">e</span>', <span class="id">l</span>') := <span class="id"><a href="compcert.flocq.Calc.Round.html#truncate">truncate</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>, <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span>, <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="kwd">in</span> <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir.choice">choice</a></span> <span class="id">m</span>' <span class="id">l</span>') <span class="id">e</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6105')">Proof.</div>
<div class="proofscript" id="proof6105">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> <span class="id">Hx</span> <span class="id">Hl</span> <span class="id">He</span>.<br/>
<span class="tactic">generalize</span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#truncate_correct">truncate_correct</a></span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> <span class="id">Hx</span> <span class="id">Hl</span> <span class="id">He</span>).<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#truncate">truncate</a></span> (<span class="id">m</span>, <span class="id">e</span>, <span class="id">l</span>)) <span class="kwd">as</span> ((<span class="id">m</span>', <span class="id">e</span>'), <span class="id">l</span>').<br/>
<span class="tactic">intros</span> (<span class="id">H1</span>, <span class="id">H2</span>).<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#round_any_correct">round_any_correct</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id">round_trunc_any_correct</span>' :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;(0 &lt;= <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span>)%<span class="id">R</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span> &lt;= <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span>)%<span class="id">Z</span> \/ <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> = <span class="id"><a href="compcert.flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir.rnd">rnd</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> = <span class="kwd">let</span> '(<span class="id">m</span>', <span class="id">e</span>', <span class="id">l</span>') := <span class="id"><a href="compcert.flocq.Calc.Round.html#truncate">truncate</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>, <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span>, <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="kwd">in</span> <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir.choice">choice</a></span> <span class="id">m</span>' <span class="id">l</span>') <span class="id">e</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6106')">Proof.</div>
<div class="proofscript" id="proof6106">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> <span class="id">Hx</span> <span class="id">Hl</span> <span class="id">He</span>.<br/>
<span class="tactic">generalize</span> (<span class="id">truncate_correct</span>' <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> <span class="id">Hx</span> <span class="id">Hl</span> <span class="id">He</span>).<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#truncate">truncate</a></span> (<span class="id">m</span>, <span class="id">e</span>, <span class="id">l</span>)) <span class="kwd">as</span> [[<span class="id">m</span>' <span class="id">e</span>'] <span class="id">l</span>'].<br/>
<span class="tactic">intros</span> [<span class="id">H1</span> <span class="id">H2</span>].<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#round_any_correct">round_any_correct</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir">round_dir</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Fcalc_round.Fcalc_round_fexp.round_dir_sign">round_dir_sign</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Fcalc_round.Fcalc_round_fexp.round_dir_sign.rnd">rnd</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<span class="kwd">Context</span> { <span class="id">valid_rnd</span> : <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Valid_rnd">Valid_rnd</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.rnd">rnd</a></span> }.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Fcalc_round.Fcalc_round_fexp.round_dir_sign.choice">choice</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="compcert.flocq.Calc.Bracket.html#location">location</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="Fcalc_round.Fcalc_round_fexp.round_dir_sign.inbetween_int_valid">inbetween_int_valid</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.rnd">rnd</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Core.Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> 0) (<span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.choice">choice</a></span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> 0) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>).<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="round_sign_any_correct">round_sign_any_correct</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span> = <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> \/ (<span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> = <span class="id"><a href="compcert.flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span> /\ <span class="id"><a href="compcert.flocq.Calc.Round.html#format">format</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.rnd">rnd</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="compcert.flocq.Core.Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> 0) (<span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.choice">choice</a></span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> 0) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>)) <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6107')">Proof with</div>
<div class="proofscript" id="proof6107">
 <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">typeclass_instances</span>.<br/>
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> <span class="id">Hin</span> [<span class="id">He</span>|(<span class="id">Hl</span>,<span class="id">Hf</span>)].<br/>
<span class="tactic">rewrite</span> <span class="id">He</span> <span class="kwd">in</span> <span class="id">Hin</span> |- *.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_float_round_sign">inbetween_float_round_sign</a></span> <span class="kwd">with</span> (2 := <span class="id">Hin</span>).<br/>
<span class="tactic">exact</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.inbetween_int_valid">inbetween_int_valid</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id">Hl</span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
<span class="tactic">inversion_clear</span> <span class="id">Hin</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">Hl</span>.<br/>
<span class="tactic">replace</span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.choice">choice</a></span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id">x</span> 0) <span class="id">m</span> <span class="id"><a href="compcert.flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span>) <span class="kwd">with</span> <span class="id">m</span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rcase_abs">Rcase_abs</a></span> <span class="id">x</span>) <span class="kwd">as</span> [<span class="id">Zx</span>|<span class="id">Zx</span>].<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool_true">Rlt_bool_true</a></span> <span class="kwd">with</span> (1 := <span class="id">Zx</span>).<br/>
<span class="tactic">simpl</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Float_prop.html#F2R_Zopp">F2R_Zopp</a></span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">H</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_involutive">Ropp_involutive</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_generic">round_generic</a></span>...<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool_false">Rlt_bool_false</a></span>.<br/>
<span class="tactic">simpl</span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">H</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round_generic">round_generic</a></span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rge_le">Rge_le</a></span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool_spec">Rlt_bool_spec</a></span> <span class="id">x</span> 0) <span class="kwd">as</span> [<span class="id">Zx</span>|<span class="id">Zx</span>].<br/>
<span class="comment">(*&nbsp;.&nbsp;*)</span><br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.opp_inj">Z.opp_inj</a></span>.<br/>
<span class="id">change</span> (- <span class="id">m</span> = <span class="id"><a href="compcert.flocq.Core.Zaux.html#cond_Zopp">cond_Zopp</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.choice">choice</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="id">m</span> <span class="id"><a href="compcert.flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span>))%<span class="id">Z</span>.<br/>
<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Zrnd_IZR">Zrnd_IZR</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.rnd">rnd</a></span> (-<span class="id">m</span>)) <span class="tactic">at</span> 1.<br/>
<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> (-<span class="id">m</span>) &lt; 0)%<span class="id">R</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#opp_IZR">opp_IZR</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_lt_gt_0_contravar">Ropp_lt_gt_0_contravar</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#IZR_lt">IZR_lt</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Float_prop.html#gt_0_F2R">gt_0_F2R</a></span> <span class="kwd">with</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id">e</span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">H</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos_lt">Rabs_pos_lt</a></span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_not_eq">Rlt_not_eq</a></span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool_true">Rlt_bool_true</a></span> <span class="kwd">with</span> (1 := <span class="id">H0</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.inbetween_int_valid">inbetween_int_valid</a></span>.<br/>
<span class="id">constructor</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_left">Rabs_left</a></span> <span class="kwd">with</span> (1 := <span class="id">H0</span>).<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#opp_IZR">opp_IZR</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_involutive">Ropp_involutive</a></span>.<br/>
<span class="comment">(*&nbsp;.&nbsp;*)</span><br/>
<span class="id">change</span> (<span class="id">m</span> = <span class="id"><a href="compcert.flocq.Core.Zaux.html#cond_Zopp">cond_Zopp</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.choice">choice</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> <span class="id">m</span> <span class="id"><a href="compcert.flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span>))%<span class="id">Z</span>.<br/>
<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#Zrnd_IZR">Zrnd_IZR</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.rnd">rnd</a></span> <span class="id">m</span>) <span class="tactic">at</span> 1.<br/>
<span class="tactic">assert</span> (0 &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#IZR">IZR</a></span> <span class="id">m</span>)%<span class="id">R</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#IZR_le">IZR_le</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Float_prop.html#ge_0_F2R">ge_0_F2R</a></span> <span class="kwd">with</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id">e</span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">H</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos">Rabs_pos</a></span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool_false">Rlt_bool_false</a></span> <span class="kwd">with</span> (1 := <span class="id">H0</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.inbetween_int_valid">inbetween_int_valid</a></span>.<br/>
<span class="id">constructor</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos_eq">Rabs_pos_eq</a></span>.<br/>
Qed.</div>
<br/>
<div class="doc">Truncating a triple is sufficient to round a real number. </div>
<br/>
<span class="kwd">Theorem</span> <span class="id">round_trunc_sign_any_correct</span>' :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span> &lt;= <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span>)%<span class="id">Z</span> \/ <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> = <span class="id"><a href="compcert.flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.rnd">rnd</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> = <span class="kwd">let</span> '(<span class="id">m</span>', <span class="id">e</span>', <span class="id">l</span>') := <span class="id"><a href="compcert.flocq.Calc.Round.html#truncate">truncate</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>, <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span>, <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="kwd">in</span> <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="compcert.flocq.Core.Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> 0) (<span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.choice">choice</a></span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> 0) <span class="id">m</span>' <span class="id">l</span>')) <span class="id">e</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6108')">Proof.</div>
<div class="proofscript" id="proof6108">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> <span class="id">Hl</span> <span class="id">He</span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp_abs">cexp_abs</a></span> <span class="kwd">in</span> <span class="id">He</span>.<br/>
<span class="tactic">generalize</span> (<span class="id">truncate_correct</span>' (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id">x</span>) <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos">Rabs_pos</a></span> <span class="id">_</span>) <span class="id">Hl</span> <span class="id">He</span>).<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#truncate">truncate</a></span> (<span class="id">m</span>, <span class="id">e</span>, <span class="id">l</span>)) <span class="kwd">as</span> [[<span class="id">m</span>' <span class="id">e</span>'] <span class="id">l</span>'].<br/>
<span class="tactic">intros</span> [<span class="id">H1</span> <span class="id">H2</span>].<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#round_sign_any_correct">round_sign_any_correct</a></span>.<br/>
<span class="tactic">exact</span> <span class="id">H1</span>.<br/>
<span class="tactic">destruct</span> <span class="id">H2</span> <span class="kwd">as</span> [<span class="id">H2</span>|[<span class="id">H2</span> <span class="id">H3</span>]].<br/>
<span class="id">left</span>.<br/>
<span class="id">now</span> <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp_abs">cexp_abs</a></span>.<br/>
<span class="id">right</span>.<br/>
<span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#conj">conj</a></span> <span class="id">H2</span>).<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format_abs_inv">generic_format_abs_inv</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="round_trunc_sign_any_correct">round_trunc_sign_any_correct</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span> &lt;= <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Core.Digits.html#Zdigits">Zdigits</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> + <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span>))%<span class="id">Z</span> \/ <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> = <span class="id"><a href="compcert.flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.rnd">rnd</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> = <span class="kwd">let</span> '(<span class="id">m</span>', <span class="id">e</span>', <span class="id">l</span>') := <span class="id"><a href="compcert.flocq.Calc.Round.html#truncate">truncate</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>, <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span>, <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="kwd">in</span> <span class="id"><a href="compcert.flocq.Core.Defs.html#F2R">F2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="compcert.flocq.Core.Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> 0) (<span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.choice">choice</a></span> (<span class="id"><a href="compcert.flocq.Core.Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> 0) <span class="id">m</span>' <span class="id">l</span>')) <span class="id">e</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6109')">Proof.</div>
<div class="proofscript" id="proof6109">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> <span class="id">Hl</span> <span class="id">He</span>.<br/>
<span class="tactic">apply</span> <span class="id">round_trunc_sign_any_correct</span>' <span class="kwd">with</span> (1 := <span class="id">Hl</span>).<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp_abs">cexp_abs</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#cexp_inbetween_float_loc_Exact">cexp_inbetween_float_loc_Exact</a></span> <span class="kwd">with</span> (2 := <span class="id">Hl</span>) (3 := <span class="id">He</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos">Rabs_pos</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign">round_dir_sign</a></span>.<br/>
<br/>
<h1> Instances of the theorems above, for the usual rounding modes. </h1>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_DN_correct">round_DN_correct</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Round.html#round_any_correct">round_any_correct</a></span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">m</span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_int_DN">inbetween_int_DN</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_trunc_DN_correct">round_trunc_DN_correct</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Round.html#round_trunc_any_correct">round_trunc_any_correct</a></span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">m</span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_int_DN">inbetween_int_DN</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">round_trunc_DN_correct</span>' :=<br/>
&nbsp;&nbsp;<span class="id">round_trunc_any_correct</span>' <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">m</span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_int_DN">inbetween_int_DN</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_sign_DN_correct">round_sign_DN_correct</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Round.html#round_sign_any_correct">round_sign_any_correct</a></span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">s</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_sign_DN">round_sign_DN</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#s">s</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_int_DN_sign">inbetween_int_DN_sign</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_trunc_sign_DN_correct">round_trunc_sign_DN_correct</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Round.html#round_trunc_sign_any_correct">round_trunc_sign_any_correct</a></span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">s</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_sign_DN">round_sign_DN</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#s">s</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_int_DN_sign">inbetween_int_DN_sign</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">round_trunc_sign_DN_correct</span>' :=<br/>
&nbsp;&nbsp;<span class="id">round_trunc_sign_any_correct</span>' <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">s</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_sign_DN">round_sign_DN</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#s">s</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_int_DN_sign">inbetween_int_DN_sign</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_UP_correct">round_UP_correct</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Round.html#round_any_correct">round_any_correct</a></span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_UP">round_UP</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_int_UP">inbetween_int_UP</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_trunc_UP_correct">round_trunc_UP_correct</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Round.html#round_trunc_any_correct">round_trunc_any_correct</a></span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_UP">round_UP</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_int_UP">inbetween_int_UP</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">round_trunc_UP_correct</span>' :=<br/>
&nbsp;&nbsp;<span class="id">round_trunc_any_correct</span>' <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_UP">round_UP</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_int_UP">inbetween_int_UP</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_sign_UP_correct">round_sign_UP_correct</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Round.html#round_sign_any_correct">round_sign_any_correct</a></span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">s</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_sign_UP">round_sign_UP</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#s">s</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_int_UP_sign">inbetween_int_UP_sign</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_trunc_sign_UP_correct">round_trunc_sign_UP_correct</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Round.html#round_trunc_sign_any_correct">round_trunc_sign_any_correct</a></span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">s</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_sign_UP">round_sign_UP</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#s">s</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_int_UP_sign">inbetween_int_UP_sign</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">round_trunc_sign_UP_correct</span>' :=<br/>
&nbsp;&nbsp;<span class="id">round_trunc_sign_any_correct</span>' <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">s</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_sign_UP">round_sign_UP</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#s">s</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_int_UP_sign">inbetween_int_UP_sign</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_ZR_correct">round_ZR_correct</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Round.html#round_any_correct">round_any_correct</a></span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_ZR">round_ZR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_bool">Zlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> 0) <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_int_ZR">inbetween_int_ZR</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_trunc_ZR_correct">round_trunc_ZR_correct</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Round.html#round_trunc_any_correct">round_trunc_any_correct</a></span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_ZR">round_ZR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_bool">Zlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> 0) <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_int_ZR">inbetween_int_ZR</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">round_trunc_ZR_correct</span>' :=<br/>
&nbsp;&nbsp;<span class="id">round_trunc_any_correct</span>' <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_ZR">round_ZR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_bool">Zlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> 0) <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_int_ZR">inbetween_int_ZR</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_sign_ZR_correct">round_sign_ZR_correct</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Round.html#round_sign_any_correct">round_sign_any_correct</a></span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">s</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_int_ZR_sign">inbetween_int_ZR_sign</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_trunc_sign_ZR_correct">round_trunc_sign_ZR_correct</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Round.html#round_trunc_sign_any_correct">round_trunc_sign_any_correct</a></span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">s</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_int_ZR_sign">inbetween_int_ZR_sign</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">round_trunc_sign_ZR_correct</span>' :=<br/>
&nbsp;&nbsp;<span class="id">round_trunc_sign_any_correct</span>' <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">s</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_int_ZR_sign">inbetween_int_ZR_sign</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_NE_correct">round_NE_correct</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Round.html#round_any_correct">round_any_correct</a></span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_N">round_N</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.even">Z.even</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>)) <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_int_NE">inbetween_int_NE</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_trunc_NE_correct">round_trunc_NE_correct</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Round.html#round_trunc_any_correct">round_trunc_any_correct</a></span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_N">round_N</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.even">Z.even</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>)) <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_int_NE">inbetween_int_NE</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">round_trunc_NE_correct</span>' :=<br/>
&nbsp;&nbsp;<span class="id">round_trunc_any_correct</span>' <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_N">round_N</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.even">Z.even</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>)) <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_int_NE">inbetween_int_NE</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_sign_NE_correct">round_sign_NE_correct</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Round.html#round_sign_any_correct">round_sign_any_correct</a></span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">s</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_N">round_N</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.even">Z.even</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>)) <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_int_NE_sign">inbetween_int_NE_sign</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_trunc_sign_NE_correct">round_trunc_sign_NE_correct</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Round.html#round_trunc_sign_any_correct">round_trunc_sign_any_correct</a></span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">s</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_N">round_N</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.even">Z.even</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>)) <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_int_NE_sign">inbetween_int_NE_sign</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">round_trunc_sign_NE_correct</span>' :=<br/>
&nbsp;&nbsp;<span class="id">round_trunc_sign_any_correct</span>' <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">s</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_N">round_N</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.even">Z.even</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>)) <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_int_NE_sign">inbetween_int_NE_sign</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_NA_correct">round_NA_correct</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Round.html#round_any_correct">round_any_correct</a></span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_N">round_N</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zle_bool">Zle_bool</a></span> 0 <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_int_NA">inbetween_int_NA</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_trunc_NA_correct">round_trunc_NA_correct</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Round.html#round_trunc_any_correct">round_trunc_any_correct</a></span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_N">round_N</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zle_bool">Zle_bool</a></span> 0 <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_int_NA">inbetween_int_NA</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">round_trunc_NA_correct</span>' :=<br/>
&nbsp;&nbsp;<span class="id">round_trunc_any_correct</span>' <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_N">round_N</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zle_bool">Zle_bool</a></span> 0 <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_int_NA">inbetween_int_NA</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_sign_NA_correct">round_sign_NA_correct</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Round.html#round_sign_any_correct">round_sign_any_correct</a></span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">s</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_N">round_N</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_int_NA_sign">inbetween_int_NA_sign</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_trunc_sign_NA_correct">round_trunc_sign_NA_correct</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Round.html#round_trunc_sign_any_correct">round_trunc_sign_any_correct</a></span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">s</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_N">round_N</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_int_NA_sign">inbetween_int_NA_sign</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">round_trunc_sign_NA_correct</span>' :=<br/>
&nbsp;&nbsp;<span class="id">round_trunc_sign_any_correct</span>' <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">s</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#round_N">round_N</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#inbetween_int_NA_sign">inbetween_int_NA_sign</a></span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.Fcalc_round_fexp">Fcalc_round_fexp</a></span>.<br/>
<br/>
<div class="doc">Specialization of truncate for FIX formats. </div>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Fcalc_round.emin">emin</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="truncate_FIX">truncate_FIX</a></span> <span class="id">t</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">m</span>, <span class="id">e</span>, <span class="id">l</span>) := <span class="id"><a href="compcert.flocq.Calc.Round.html#t">t</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">k</span> := (<span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.emin">emin</a></span> - <span class="id">e</span>)%<span class="id">Z</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_bool">Zlt_bool</a></span> 0 <span class="id"><a href="compcert.flocq.Calc.Round.html#k">k</a></span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">p</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpow_def.html#Zpower">Zpower</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#k">k</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.div">Z.div</a></span> <span class="id">m</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#p">p</a></span>, (<span class="id">e</span> + <span class="id"><a href="compcert.flocq.Calc.Round.html#k">k</a></span>)%<span class="id">Z</span>, <span class="id"><a href="compcert.flocq.Calc.Bracket.html#new_location">new_location</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#p">p</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zdiv.html#Zmod">Zmod</a></span> <span class="id">m</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#p">p</a></span>) <span class="id">l</span>)<br/>
&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#t">t</a></span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="truncate_FIX_correct">truncate_FIX_correct</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span> &lt;= <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.emin">emin</a></span>)%<span class="id">Z</span> \/ <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span> = <span class="id"><a href="compcert.flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">m</span>', <span class="id">e</span>', <span class="id">l</span>') := <span class="id"><a href="compcert.flocq.Calc.Round.html#truncate_FIX">truncate_FIX</a></span> (<span class="id"><a href="compcert.flocq.Calc.Round.html#m">m</a></span>, <span class="id"><a href="compcert.flocq.Calc.Round.html#e">e</a></span>, <span class="id"><a href="compcert.flocq.Calc.Round.html#l">l</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id">m</span>' <span class="id">e</span>' <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> <span class="id">l</span>' /\<br/>
&nbsp;&nbsp;(<span class="id">e</span>' = <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="compcert.flocq.Core.FIX.html#FIX_exp">FIX_exp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.emin">emin</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span> \/ (<span class="id">l</span>' = <span class="id"><a href="compcert.flocq.Calc.Bracket.html#loc_Exact">loc_Exact</a></span> /\ <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="compcert.flocq.Core.FIX.html#FIX_exp">FIX_exp</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.emin">emin</a></span>) <span class="id"><a href="compcert.flocq.Calc.Round.html#x">x</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof6110')">Proof.</div>
<div class="proofscript" id="proof6110">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> <span class="id">H1</span> <span class="id">H2</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#truncate_FIX">truncate_FIX</a></span>.<br/>
<span class="tactic">set</span> (<span class="id">k</span> := (<span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.emin">emin</a></span> - <span class="id">e</span>)%<span class="id">Z</span>).<br/>
<span class="tactic">set</span> (<span class="id">p</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpow_def.html#Zpower">Zpower</a></span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round.beta">beta</a></span> <span class="id">k</span>).<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>, <span class="id"><a href="compcert.flocq.Core.FIX.html#FIX_exp">FIX_exp</a></span>.<br/>
<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_cases">Zlt_cases</a></span> 0 <span class="id">k</span>).<br/>
<span class="tactic">case</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_bool">Zlt_bool</a></span> 0 <span class="id">k</span>) ; <span class="tactic">intros</span> <span class="id">Hk</span>.<br/>
<span class="comment">(*&nbsp;shift&nbsp;*)</span><br/>
<span class="tactic">split</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Bracket.html#inbetween_float_new_location">inbetween_float_new_location</a></span>.<br/>
<span class="tactic">clear</span> <span class="id">H2</span>.<br/>
<span class="id">left</span>.<br/>
<span class="tactic">unfold</span> <span class="id">k</span>.<br/>
<span class="tactic">ring</span>.<br/>
<span class="comment">(*&nbsp;no&nbsp;shift&nbsp;*)</span><br/>
<span class="tactic">split</span>.<br/>
<span class="tactic">exact</span> <span class="id">H1</span>.<br/>
<span class="tactic">unfold</span> <span class="id">k</span> <span class="kwd">in</span> <span class="id">Hk</span>.<br/>
<span class="tactic">destruct</span> <span class="id">H2</span> <span class="kwd">as</span> [<span class="id">H2</span>|<span class="id">H2</span>].<br/>
<span class="id">left</span>.<br/>
<span class="tactic">omega</span>.<br/>
<span class="id">right</span>.<br/>
<span class="tactic">split</span>.<br/>
<span class="tactic">exact</span> <span class="id">H2</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
<span class="tactic">inversion_clear</span> <span class="id">H1</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#generic_format_F2R">generic_format_F2R</a></span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Generic_fmt.html#cexp">cexp</a></span>.<br/>
<span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.flocq.Calc.Round.html#Fcalc_round">Fcalc_round</a></span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
